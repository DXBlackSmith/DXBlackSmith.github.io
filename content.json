{"meta":{"title":"Hexo","subtitle":"","description":"","author":"DxBlackSmith","url":"https://dxblacksmith.github.io","root":"/"},"pages":[{"title":"categories","date":"2026-01-13T10:42:48.000Z","updated":"2026-01-13T10:46:21.352Z","comments":false,"path":"categories/index.html","permalink":"https://dxblacksmith.github.io/categories/index.html","excerpt":"","text":""},{"title":"about","date":"2026-01-13T09:57:44.000Z","updated":"2026-01-13T09:58:17.610Z","comments":false,"path":"about/index.html","permalink":"https://dxblacksmith.github.io/about/index.html","excerpt":"","text":""}],"posts":[{"title":"Java åˆ†å±‚æ¶æ„","slug":"Java-åˆ†å±‚æ¶æ„","date":"2026-02-04T14:13:31.798Z","updated":"2026-02-04T14:13:32.194Z","comments":true,"path":"2026/02/04/Java-åˆ†å±‚æ¶æ„/","permalink":"https://dxblacksmith.github.io/2026/02/04/Java-%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/","excerpt":"","text":"Java åˆ†å±‚æ¶æ„ä¸€ã€Controller&#x2F; Service &#x2F; Dao è¿™æ˜¯ç°ä»£ä¼ä¸šçº§åº”ç”¨ï¼ˆå°¤å…¶æ˜¯ Java Web åº”ç”¨ï¼‰ä¸­å¸¸è§çš„ åˆ†å±‚æ¶æ„æ¨¡å¼ï¼Œç›®çš„æ˜¯è§£è€¦ã€æé«˜å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§ã€‚ æ•´ä½“çš„æ¶æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š 123456789[å®¢æˆ·ç«¯] â†“ (HTTP è¯·æ±‚)@Controllerï¼ˆæ§åˆ¶å™¨ï¼‰ â†“ è°ƒç”¨@Serviceï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰ â†“ è°ƒç”¨@Mapper / @Repositoryï¼ˆæ•°æ®è®¿é—®å±‚ï¼Œå³ DAOï¼‰ â†“[æ•°æ®åº“] 1. DAOï¼ˆData Access Objectï¼‰â€”â€” æ•°æ®è®¿é—®å±‚èŒè´£ï¼š å°è£…å¯¹æ•°æ®åº“çš„ CRUD æ“ä½œ åªè´Ÿè´£æ•°æ®å­˜å–ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘ã€‚ å®ç°å¯ä»¥æ˜¯åŸç”Ÿ JDBC -&gt; UserDao æ¥å£ + å®ç°ç±»æˆ–è€… MyBatis -&gt; @Mapper æ¥å£ 123456@Mapperpublic interface UserMapper &#123; User selectById(Long id); void insert(User user); List&lt;User&gt; findAll();&#125; âœ…DAO &#x3D; æ•°æ®çš„â€œæ¬è¿å·¥â€ï¼Œåªç®¡â€œæ‹¿â€å’Œâ€œå­˜â€ã€‚ 2. Serviceï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰èŒè´£ï¼š å®ç° æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æ³¨å†Œã€æ”¯ä»˜ã€è®¢å•å¤„ç†ï¼‰ã€‚ åè°ƒå¤šä¸ª DAO æ“ä½œï¼ˆä¾‹å¦‚ï¼šæ³¨å†Œç”¨æˆ· + å‘é€é‚®ä»¶ + è®°å½•æ—¥å¿—ï¼‰ã€‚ æ— çŠ¶æ€ï¼Œå¯è¢«å¤šä¸ª Controller å¤ç”¨ã€‚ 1234567891011121314151617@Service@Transactionalpublic class UserService &#123; @Autowired private UserMapper userMapper; public Long register(String name, String email) &#123; // 1. æ ¡éªŒé€»è¾‘ï¼ˆä¸šåŠ¡è§„åˆ™ï¼‰ if (userMapper.existsByEmail(email)) &#123; throw new BusinessException(&quot;é‚®ç®±å·²å­˜åœ¨&quot;); &#125; // 2. è°ƒç”¨ DAO ä¿å­˜æ•°æ® User user = new User(name, email); userMapper.insert(user); return user.getId(); &#125;&#125; âœ…Service &#x3D; ä¸šåŠ¡çš„â€œå¤§è„‘â€ï¼Œå†³å®šâ€œåšä»€ä¹ˆâ€å’Œâ€œæ€ä¹ˆåšâ€ã€‚ 3. Controllerï¼ˆæ§åˆ¶å±‚ï¼‰èŒè´£ï¼š æ¥æ”¶ HTTP è¯·æ±‚ è§£æè¯·æ±‚å‚æ•°ï¼ˆJSONã€è·¯å¾„å˜é‡ã€è¡¨å•ï¼‰ è°ƒç”¨ Service æ‰§è¡Œä¸šåŠ¡ å°è£…å“åº”ç»“æœï¼ˆè¿”å› JSONã€è·³è½¬é¡µé¢ï¼‰ æŠ€æœ¯å®ç°ä¸Šä¸€èˆ¬æ˜¯ Spring MVC çš„ @RestController æˆ– @Controller 123456789101112@RestController@RequestMapping(&quot;/api/users&quot;)public class UserController &#123; @Autowired private UserService userService; @PostMapping public ResponseEntity&lt;Long&gt; register(@RequestBody RegisterRequest req) &#123; Long userId = userService.register(req.getName(), req.getEmail()); return ResponseEntity.ok(userId); &#125;&#125; âœ… Controller &#x3D; ç³»ç»Ÿçš„â€œé—¨é¢â€ï¼Œè´Ÿè´£â€œæ¥å®¢â€å’Œâ€œä¼ è¯â€ã€‚ Ps. ä¼ ç»Ÿ MVC (å¦‚æ—©æœŸ Spring MVC) ï¼ŒModel ç›¸å½“ä¸è¿™é‡Œçš„ Service + Dao + Entity, View åˆ™æ˜¯è¢«ç‹¬ç«‹å‡ºå»ï¼Œå˜æˆäº†å‰ç«¯ï¼ˆå±•ç¤ºæ•°æ®ï¼‰ï¼ŒController ä¸ŠèŒè´£æœ‰ä¸€äº›å˜åŒ–ï¼ˆä¼ ç»Ÿæ˜¯åè°ƒ Model å’Œ Viewï¼Œè€Œç°åœ¨ Java web ä¸­æ˜¯è´Ÿè´£æ¥æ”¶ + è°ƒç”¨ Servicesï¼‰","categories":[{"name":"Java","slug":"Java","permalink":"https://dxblacksmith.github.io/categories/Java/"}],"tags":[]},{"title":"JDBC","slug":"JDBC","date":"2026-02-04T12:36:32.479Z","updated":"2026-02-04T13:49:51.042Z","comments":true,"path":"2026/02/04/JDBC/","permalink":"https://dxblacksmith.github.io/2026/02/04/JDBC/","excerpt":"","text":"JDBC JDBC æ˜¯ Java æä¾›çš„ä¸€å¥—ç”¨äºè¿æ¥å’Œæ“ä½œå…³ç³»å‹æ•°æ®åº“çš„æ ‡å‡† APIã€‚å…è®¸ Java ç¨‹åºé€šè¿‡ SQL è¯­å¥ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œè€Œæ— éœ€å…³å¿ƒåº•å±‚æ•°æ®åº“çš„å…·ä½“å®ç°ï¼ˆåªè¦æ•°æ®åº“æä¾›å¯¹åº”çš„ JDBC é©±åŠ¨ï¼‰ ä¸€ã€æ ¸å¿ƒæ¥å£1. Connectionï¼ˆè¿æ¥ï¼‰ä½œç”¨ï¼š è¡¨ç¤ºåº”ç”¨ç¨‹åºä¸æ•°æ®åº“ä¹‹é—´çš„ä¼šè¯è¿æ¥ã€‚ æ˜¯æ‰€æœ‰æ•°æ®åº“æ“ä½œçš„èµ·ç‚¹ï¼šé€šè¿‡ Connection å¯ä»¥åˆ›å»º Statementï¼ŒPreparedStatement ç­‰å¯¹è±¡ã€‚ è´Ÿè´£ç®¡ç†äº‹åŠ¡ï¼ˆæ¯”å¦‚æäº¤ Commitï¼Œå›æ»š rollback()ï¼‰ 12sql::mysql::MySQL_Driver* driver = sql::mysql::get_mysql_driver_instance();auto* con = driver-&gt;connect(url_, user_, pass_); 2. Statementï¼ˆè¯­å¥ï¼‰ä½œç”¨ï¼šç”¨äºæ‰§è¡Œé™æ€ SQL è¯­å¥ï¼ˆå³ä¸å¸¦å‚æ•°çš„ SQLï¼‰ï¼Œé€‚ç”¨äºæ‰§è¡Œ DDLï¼ˆå¦‚ CREATE TABLEï¼‰æˆ–ç®€å•æŸ¥è¯¢ 12std::unique_ptr&lt;sql::Statement&gt; stmt(con-&gt;_con-&gt;createStatement());stmt-&gt;executeQuery(&quot;SELECT 1&quot;); è¯¥æ¥å£å®¹æ˜“å‘ç”Ÿ SQL æ³¨å…¥ï¼Œæ¯æ¬¡æ‰§è¡Œéƒ½éœ€è¦é‡æ–°ç¼–è¯‘ SQLï¼ˆæ•ˆç‡è¾ƒä½ï¼‰ 3. PreparedStatementï¼ˆé¢„ç¼–è¯‘è¯­å¥ï¼‰ç»§æ‰¿è‡ª Statementï¼Œä½œç”¨ï¼š æ‰§è¡Œå¸¦å‚æ•°çš„é¢„ç¼–è¯‘ SQL è¯­å¥ã€‚ SQL è¯­å¥ä¸­ä½¿ç”¨ ? ä½œä¸ºå ä½ç¬¦ï¼Œå‚æ•°é€šè¿‡ setXxx() æ–¹æ³•è®¾ç½® 123456// å‡†å¤‡è°ƒç”¨å­˜å‚¨è¿‡ç¨‹unique_ptr &lt;sql::PreparedStatement&gt; stmt(con-&gt;prepareStatement(&quot;CALL reg_user(?,?,?,@result)&quot;));// è®¾ç½®è¾“å…¥å‚æ•°stmt-&gt;setString(1, name);stmt-&gt;setString(2, email);stmt-&gt;setString(3, pwd); è§£å†³äº† statement çš„é—®é¢˜ï¼Œé˜²æ­¢ SQL æ³¨å…¥ï¼ŒåŒæ—¶æ€§èƒ½æ›´é«˜ï¼šSQL è¯­å¥åœ¨æ•°æ®åº“ç«¯é¢„ç¼–è¯‘ï¼Œå¤šæ¬¡æ‰§è¡Œæ—¶åªéœ€æ›¿æ¢å‚æ•°ï¼Œæ— éœ€é‡å¤è§£æã€‚ 4. ResultSetï¼ˆç»“æœé›†ï¼‰ä½œç”¨ï¼š è¡¨ç¤ºæ‰§è¡ŒæŸ¥è¯¢ï¼ˆSELECTï¼‰åè¿”å›çš„æ•°æ®ç»“æœé›†åˆã€‚ ç±»ä¼¼ä¸€ä¸ªâ€œæ¸¸æ ‡â€ï¼Œåˆå§‹ä½ç½®åœ¨ç¬¬ä¸€è¡Œä¹‹å‰ï¼Œé€šè¿‡ next() å‘ä¸‹ç§»åŠ¨ 1234567unique_ptr&lt;sql::ResultSet&gt; res(stmtResult-&gt;executeQuery(&quot;SELECT @result AS result&quot;));if (res-&gt;next()) &#123; int result = res-&gt;getInt(&quot;result&quot;); cout &lt;&lt; &quot;Result: &quot; &lt;&lt; result &lt;&lt; endl; pool_-&gt;returnConnection(std::move(con)); return result;&#125; åªèƒ½å‘å‰éå†ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰ï¼ŒåŒæ—¶å¿…é¡»åœ¨ Connection å’Œ Statement å…³é—­å‰è¯»å–æ•°æ®ã€‚","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://dxblacksmith.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"}],"tags":[]},{"title":"JavaScript","slug":"Js","date":"2026-02-04T11:44:35.813Z","updated":"2026-02-04T14:34:41.290Z","comments":true,"path":"2026/02/04/Js/","permalink":"https://dxblacksmith.github.io/2026/02/04/Js/","excerpt":"","text":"JavaScript åŸºç¡€ä¸€ã€Nodejs, Js, npm çš„å…³ç³»JavaScript æ˜¯ä¸€ç§åŠ¨æ€ã€å¼±ç±»å‹ã€è§£é‡Šå‹çš„è„šæœ¬è¯­è¨€ï¼ˆåŸºäº C++ å°è£…ï¼‰ Node.js æ˜¯åŸºäº Chrome V8 å¼•æ“æ„å»ºçš„ JavaScript Runtimeï¼Œç›®çš„æ˜¯èƒ½ js åœ¨æœåŠ¡ç«¯ä¸Šè¿è¡Œ npmï¼ˆNode Package Manager) æ˜¯ Nodejs çš„å®˜æ–¹åŒ…ç®¡ç†å·¥å…·ï¼Œç›®çš„æ˜¯ç®¡ç†ç¬¬ä¸‰æ–¹ä»£ç ä¾èµ– ä¸‰è€…å…³ç³»æ˜¯ï¼š 12345JavaScriptï¼ˆè¯­è¨€ï¼‰ â†‘Node.jsï¼ˆè¿è¡Œç¯å¢ƒï¼šæä¾› fs/http/crypto ç­‰ API + V8 å¼•æ“ï¼‰ â†‘npmï¼ˆåŒ…ç®¡ç†å™¨ï¼šå®‰è£…/å‘å¸ƒ/ç®¡ç† JS åº“ï¼‰ äºŒã€éš”ç¦»ä¸åŒé¡¹ç›®ä¾èµ–ä¸åƒ python æœ‰ venv, Js æ˜¯é€šè¿‡æœ¬åœ° node_modules + é”å®šæ–‡ä»¶æ¥å®ç°é€»è¾‘ä¸Šçš„éš”ç¦» æ¯ä¸ªé¡¹ç›®æœ‰è‡ªå·±çš„ node_modules ç›®å½•æ¯”å¦‚æ‰§è¡Œ npm install ioredis çš„æ—¶å€™ï¼ŒåŒ…ä¼šè¢«å®‰è£…åˆ°å½“å‰é¡¹ç›®ç›®å½•ä¸‹çš„ ./node_modulesã€‚ ä¸åŒé¡¹ç›®çš„ node_modules äº’ä¸å½±å“ ä¾èµ–è§£æè§„åˆ™ï¼ˆå½“ä»£ç ä¸­å†™ const Redis = require(&#39;ioredis&#39;) çš„æ—¶å€™ï¼ŒNode.js ä¼šï¼š ä¼˜å…ˆåœ¨ å½“å‰é¡¹ç›® node_modules ä¸­æ‰¾ï¼› å¦‚æœæ²¡æœ‰ï¼Œé€çº§å‘ä¸ŠæŸ¥æ‰¾çˆ¶ç›®å½•çš„ node_modulesï¼Œç›´åˆ°æ ¹ç›®å½•ï¼› ä¸ä¼šè‡ªåŠ¨ä½¿ç”¨å…¨å±€å®‰è£…çš„åŒ…ï¼ˆé™¤éæ˜¾å¼æŒ‡å®šï¼‰ã€‚ é”å®šä¾èµ–ç‰ˆæœ¬npm install ä¸‹è½½ç”Ÿæˆçš„ package-lock.json è®°å½•ç²¾ç¡®ç‰ˆæœ¬å· + ä¾èµ–æ ‘ç»“æ„ã€‚ å›¢é˜Ÿæˆå‘˜æ‰§è¡Œ npm ci å¯é‡å»ºå®Œå…¨ä¸€è‡´çš„ node_modulesã€‚ ä¸‰ã€JavaScript çš„å†…å­˜ç®¡ç†å†…å­˜åˆ†é…æœºåˆ¶Js å¼•æ“åœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ¨æ–­å€¼çš„ç±»å‹ï¼Œå¹¶ä¸ºå…¶åˆ†é…åˆé€‚å†…å­˜ï¼š 1234let a = 42; // â†’ å­˜ä¸º 32 ä½æ•´æ•°ï¼ˆSmisï¼ŒV8 ä¼˜åŒ–ï¼‰a = 3.14; // â†’ æ”¹ä¸º 64 ä½åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆHeapNumberï¼‰a = &quot;hello&quot;; // â†’ åˆ†é…å­—ç¬¦ä¸²å¯¹è±¡ï¼ˆåœ¨å †ä¸Šï¼‰a = &#123; x: 1 &#125;; // â†’ åˆ†é…å¯¹è±¡ï¼ˆåœ¨å †ä¸Šï¼‰ å…¶ä¸­åŸºæœ¬ç±»å‹ï¼ˆnumber, string, boolean, symbolï¼‰å°æ•´æ•°æˆ–çŸ­å­—ç¬¦ä¸²å¯èƒ½ç›´æ¥å†…è”å­˜å‚¨ï¼ˆæ ˆæˆ–å¯¹è±¡å†…ï¼‰ï¼Œå¤§å€¼å­˜åœ¨å †ä¸Š å¼•ç”¨ç±»å‹ï¼ˆObject, Array, Function) æ€»æ˜¯åˆ†é…åœ¨å †ä¸Šï¼Œ åƒåœ¾å›æ”¶æœºåˆ¶Js çš„å†…å­˜ç®¡ç†æœºåˆ¶æ˜¯è‡ªåŠ¨åƒåœ¾å›æ”¶ï¼ˆGCï¼‰ï¼ŒC++ ç°åœ¨åˆ™æ˜¯åˆ©ç”¨ RAII æ€æƒ³æ¥ææ„å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥ç”¨æ™ºèƒ½æŒ‡é’ˆæ¥ç®¡ç†å¯¹è±¡ åç°ä»£è¯­è¨€é€šå¸¸é‡‡ç”¨ GC æœºåˆ¶å›æ”¶å˜é‡ï¼Œå½“åˆ›å»ºçš„å¯¹è±¡ä¸å†è¢«ä½¿ç”¨çš„æ—¶å€™å°±ä¼šå˜æˆ â€œåƒåœ¾â€ï¼Œè¢« GC è‡ªåŠ¨å›æ”¶ã€‚ è¯†åˆ«æ ¸å¿ƒä¹Ÿæ˜¯ï¼š å¼•ç”¨è®¡æ•°ï¼ˆå­˜åœ¨å¾ªç¯å¼•ç”¨é—®é¢˜ï¼‰ï¼šæ¯ä¸ªå¯¹è±¡æœ‰è®¡æ•°å™¨ï¼Œè¢«å¼•ç”¨ä¸€æ¬¡ï¼Œè®¡æ•°å°± + 1ï¼Œå¼•ç”¨æ¶ˆå¤±ï¼Œè®¡æ•°å°± -1ï¼Œä¸º 0 æ—¶å°±è¢«å›æ”¶ å¯è¾¾æ€§åˆ†æï¼šä» â€œæ ¹å¯¹è±¡â€(å…¨å±€å˜é‡ï¼Œæ ˆå˜é‡ï¼Œå½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡)å¼€å§‹éå†ï¼Œèƒ½éå†åˆ°çš„ &#x3D; æ´»ç€ï¼Œéå†ä¸åˆ° &#x3D; åƒåœ¾ å›æ”¶æ ¸å¿ƒåˆ™æ˜¯ï¼š åˆ†ä»£å›æ”¶ï¼ˆJava&#x2F;JS v8 æ ¸å¿ƒï¼‰ï¼šæŠŠå¯¹è±¡åˆ†ä¸º â€æ–°å¯¹è±¡â€œ&#x2F;â€è€å¯¹è±¡â€œï¼Œå…¶ä¸­æ–°ç”Ÿä»£å¯¹è±¡æ­»å¾—å¿«ï¼ŒGC é¢‘ç¹ï¼Œè€ç”Ÿä»£å¯¹è±¡æ´»å¾—ä¹…ï¼ŒGC å°‘ï¼ˆæ•ˆç‡é«˜ï¼‰ Mark-Sweepï¼šå…ˆæ ‡è®°æ‰€æœ‰å¯è¾¾å¯¹è±¡ï¼Œå†æ¸…é™¤æœªæ ‡è®°çš„åƒåœ¾ Mark-Compactï¼šæ ‡è®° â†’ æŠŠå­˜æ´»å¯¹è±¡å¾€ä¸€è¾¹æŒ¤ â†’ æ¸…é™¤å‰©ä¸‹çš„åƒåœ¾ï¼Œè¿™æ ·èƒ½å¤Ÿè§£å†³ç¢ç‰‡é—®é¢˜ GC çš„ç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼š GC å·¥ä½œæ—¶ï¼Œä¼šæœ‰åœé¡¿ï¼ˆSTWï¼‰ï¼Œå½±å“ç³»ç»Ÿæ€§èƒ½ GC æœ¬èº«ä¼šæœ‰å¼€é”€ï¼Œå  CPUï¼Œå†…å­˜","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"https://dxblacksmith.github.io/categories/JavaScript/"}],"tags":[]},{"title":"æ± åŒ–","slug":"æ± åŒ–","date":"2026-02-03T08:49:37.292Z","updated":"2026-02-03T08:49:37.575Z","comments":true,"path":"2026/02/03/æ± åŒ–/","permalink":"https://dxblacksmith.github.io/2026/02/03/%E6%B1%A0%E5%8C%96/","excerpt":"","text":"æ± åŒ– æ± åŒ–æ˜¯ä¸€ç§èµ„æºå¤ç”¨è®¡æ•°ï¼Œé€šè¿‡é¢„å…ˆåˆ›å»ºä¸€ç»„å¯å¤ç”¨çš„èµ„æºå¯¹è±¡ï¼Œé¿å…é¢‘ç¹ç”³è¯·&#x2F;é‡Šæ”¾å¸¦æ¥çš„å¼€é”€ï¼ˆå¦‚ TCP è¿æ¥å»ºç«‹ã€çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ã€å†…å­˜åˆ†é…ç­‰ï¼‰ï¼Œä»è€Œæå‡ç³»ç»Ÿæ€§èƒ½å’Œç¨³å®šæ€§ã€‚ ä¸€. åˆ†é…ç­–ç•¥ç‰¹ç‚¹ï¼šåˆ†é…ç­–ç•¥ + æ— çŠ¶æ€å…±äº« æ ¸å¿ƒè®¾è®¡ï¼š é¢„å…ˆåˆ›å»ºå¤šä¸ª io_context å¯¹è±¡ï¼ˆé»˜è®¤ 2 ä¸ªï¼‰ï¼Œæ¯ä¸ªè¿è¡Œåœ¨ç‹¬ç«‹çº¿ç¨‹ä¸­ã€‚ ä½¿ç”¨ è½®è¯¢ï¼ˆRound-Robinï¼‰ç­–ç•¥ åˆ†é… io_context ç»™æ–°è¿æ¥ã€‚ æ¯ä¸ª io_context ç»‘å®šä¸€ä¸ª work guardï¼Œé˜²æ­¢å› æ— ä»»åŠ¡è€Œé€€å‡ºã€‚ ä¸æ¶‰åŠå€Ÿè¿˜ï¼Œåˆ†é…å socket ç”Ÿå‘½å‘¨æœŸå†…ç‹¬å è¯¥ io_contextã€‚ Asio è¿æ¥æ± ï¼šIOContextPool.h 123456789101112131415161718// åˆ›å»º IOService æ± å­, acceptor æ¥æ”¶åˆ°è¿æ¥ä»¥åå–å‡ºä¸€ä¸ª IOService æ¥åˆ›å»º Http ç®¡ç†ï¼ˆå«é€šä¿¡å¥—æ¥å­—ï¼‰, è¯¥ ioc å°±è´Ÿè´£é€šä¿¡å¥—æ¥å­—ä¸Šçš„ IO è¯»å†™class CAsioIoServicePool : public Singleton&lt;CAsioIoServicePool&gt; &#123; friend class Singleton&lt;CAsioIoServicePool&gt;;public: using IOService = boost::asio::io_context; // åˆ›å»ºä¸€ä¸ª work guard æ¥é˜²æ­¢ io_context å› ä¸ºæ²¡æœ‰ä»»åŠ¡è€Œæå‰ç»“æŸ using Work = boost::asio::executor_work_guard&lt;boost::asio::io_context::executor_type&gt;; ~CAsioIoServicePool(); // round-robin ç­–ç•¥: åˆ†é…ç­–ç•¥ boost::asio::io_context&amp; GetIOService(); void Stop();private: CAsioIoServicePool(size_t size = 2); std::vector&lt;IOService&gt; m_IOServices; std::vector&lt;Work&gt; m_Works; std::vector&lt;std::thread&gt; m_Threads; std::size_t _nextIOService;&#125;; äºŒ. å€Ÿè¿˜ç­–ç•¥ç‰¹ç‚¹ï¼šå€Ÿè¿˜ç­–ç•¥ + æœ‰çŠ¶æ€ç‹¬å  æ ¸å¿ƒè®¾è®¡ï¼š é¢„å…ˆåˆ›å»ºå¤šä¸ª VerifyService::Stubï¼ˆæ¯ä¸ª stub å†…å«ä¸€ä¸ª gRPC channelï¼Œå³ TCP è¿æ¥ï¼‰ã€‚ çº¿ç¨‹é€šè¿‡ getConnection() å€Ÿå‡º ä¸€ä¸ª stubï¼Œä½¿ç”¨å®Œæ¯•å¿…é¡»è°ƒç”¨ pushConnection() å½’è¿˜ã€‚ ä½¿ç”¨ std::mutex + std::condition_variable ä¿æŠ¤è¿æ¥é˜Ÿåˆ—ï¼Œæ”¯æŒç­‰å¾…ç©ºé—²è¿æ¥ã€‚ åŒä¸€ stub åœ¨è¢«å€Ÿå‡ºæœŸé—´åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼ˆgRPC stub éçº¿ç¨‹å®‰å…¨ï¼‰ã€‚ grpc è¿æ¥æ± ï¼šRPConPoo.h 1234567891011121314151617181920// å€Ÿè¿˜ç­–ç•¥ï¼šæ± åŒ–å¤šä¸ªå­˜æ ¹ stub åˆ›å»ºå¤šä¸ªé€šä¿¡é€šé“ channel è°ç”¨å°±æ¥å–ä¸€ä¸ª, ç”¨å®Œä¹‹åè¦è¿˜ç»™æ± å­class RPConPool &#123;public: RPConPool(size_t poolSize, std::string host, std::string port); ~RPConPool(); std::unique_ptr&lt;VerifyService::Stub&gt; getConnection(); void pushConnection(std::unique_ptr&lt;VerifyService::Stub&gt; context); void Close();private: std::atomic&lt;bool&gt; m_stop_; std::queue&lt;std::unique_ptr&lt;VerifyService::Stub&gt;&gt; m_conn_; std::mutex m_mtx_; std::condition_variable m_cond_; size_t m_poolSize_; std::string m_host_; std::string m_port_;&#125;; redis è¿æ¥æ± ï¼š123456789101112131415161718class RedisConPool &#123;public: RedisConPool(size_t poolSize, const char* host, int port, const char* pwd); ~RedisConPool(); redisContext* getConnection(); void returnConnection(redisContext* context); void Close();private: // è¿æ¥å…ƒæ•°æ® const char* m_host_; int m_port_; size_t m_poolSize_; // è¿æ¥æ±  std::mutex m_mtx_; std::condition_variable m_cond_; std::queue&lt;redisContext*&gt; m_conns_; std::atomic&lt;bool&gt; m_stop_;&#125;;","categories":[{"name":"é¡¹ç›®ç»éªŒ","slug":"é¡¹ç›®ç»éªŒ","permalink":"https://dxblacksmith.github.io/categories/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"}],"tags":[]},{"title":"redis çš„ä½¿ç”¨","slug":"redis çš„ä½¿ç”¨","date":"2026-02-03T07:11:04.710Z","updated":"2026-02-03T07:11:04.960Z","comments":true,"path":"2026/02/03/redis çš„ä½¿ç”¨/","permalink":"https://dxblacksmith.github.io/2026/02/03/redis%20%E7%9A%84%E4%BD%BF%E7%94%A8/","excerpt":"","text":"Redisredisï¼ˆRemote Directionary Serverï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„ã€åŸºäºå†…å­˜çš„é”®å€¼å­˜å‚¨ç³»ç»Ÿï¼Œå¸¸è¢«ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ã€‚æ”¯æŒå¤šç§æ•°æ®ç»“æ„ï¼Œæ¯ç§ç»“æ„éƒ½æœ‰å¯¹åº”çš„å‘½ä»¤æ“ä½œã€‚ ä¸€ã€Redis çš„å¯¹è±¡ç±»å‹Redis çš„å€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯ä»¥ä¸‹äº”ç§åŸºæœ¬æ•°æ®ç±»å‹ä¹‹ä¸€ï¼Œå‰ä¸‰ç§æ¯”è¾ƒå¸¸ç”¨ï¼š 1. String ï¼ˆå­—ç¬¦ä¸²ï¼‰ æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ã€‚ å¯ä»¥å­˜å‚¨å­—ç¬¦ä¸²ã€æ•´æ•°æˆ–æµ®ç‚¹æ•°ï¼ˆæœ€å¤§ 512MBï¼‰ã€‚ å¸¸ç”¨äºç¼“å­˜ç®€å•æ•°æ®ï¼Œå¦‚ç”¨æˆ·ä¿¡æ¯ã€è®¡æ•°å™¨ç­‰ã€‚ å¸¸ç”¨æ“ä½œï¼š 123456789SET key value # è®¾ç½®é”®å€¼GET key # è·å–å€¼INCR key # è‡ªå¢ 1ï¼ˆå€¼å¿…é¡»ä¸ºæ•´æ•°ï¼‰DECR key # è‡ªå‡ 1INCRBY key increment # å¢åŠ æŒ‡å®šæ•´æ•°APPEND key value # è¿½åŠ å­—ç¬¦ä¸²STRLEN key # è·å–å­—ç¬¦ä¸²é•¿åº¦MSET key1 val1 key2 val2 ... # æ‰¹é‡è®¾ç½®MGET key1 key2 ... # æ‰¹é‡è·å– Ps. Redis çš„ key æ€»æ˜¯å­—ç¬¦ä¸²ç±»å‹ 2. Hashï¼ˆå“ˆå¸Œï¼‰ç±»ä¼¼äºŒçº§ç¼“å­˜ï¼Œã€WebSiteã€‘ã€blogSiteã€‘ &#x3D; example.com ç±»ä¼¼äºä¸€ä¸ªâ€œå­—å…¸â€æˆ–â€œå¯¹è±¡â€ï¼Œå­˜å‚¨å­—æ®µï¼ˆfieldï¼‰å’Œå€¼ï¼ˆvalueï¼‰çš„æ˜ å°„ã€‚ é€‚åˆå­˜å‚¨å¯¹è±¡ï¼ˆå¦‚ç”¨æˆ·èµ„æ–™ï¼šnameã€ageã€email ç­‰å­—æ®µï¼‰ã€‚ å¸¸ç”¨æ“ä½œï¼š 12345678910HSET key field value # è®¾ç½®å“ˆå¸Œå­—æ®µçš„å€¼HGET key field # è·å–å“ˆå¸Œå­—æ®µçš„å€¼HMSET key field1 val1 field2 val2 ... # æ‰¹é‡è®¾ç½®ï¼ˆRedis 4.0+ æ¨èç”¨ HSETï¼‰HMGET key field1 field2 ... # æ‰¹é‡è·å–HGETALL key # è·å–æ‰€æœ‰å­—æ®µå’Œå€¼ï¼ˆæ…ç”¨ï¼Œå¤§æ•°æ®é‡ä¼šé˜»å¡ï¼‰HDEL key field [field...] # åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µHEXISTS key field # åˆ¤æ–­å­—æ®µæ˜¯å¦å­˜åœ¨HLEN key # è·å–å“ˆå¸Œä¸­å­—æ®µæ•°é‡HKEYS key # è·å–æ‰€æœ‰å­—æ®µåHVALS key # è·å–æ‰€æœ‰å­—æ®µå€¼ 3. Listï¼ˆåˆ—è¡¨ï¼‰ æœ‰åºã€å¯é‡å¤çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œåº•å±‚æ˜¯åŒå‘é“¾è¡¨ã€‚ å¸¸ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—ã€æœ€æ–° N æ¡è®°å½•ç­‰åœºæ™¯ã€‚ å¸¸ç”¨æ“ä½œï¼š 1234LPUSH key value [value...] # ä»å·¦è¾¹æ’å…¥RPUSH key value [value...] # ä»å³è¾¹æ’å…¥LPOP key # å¼¹å‡ºå·¦è¾¹ç¬¬ä¸€ä¸ªå…ƒç´ RPOP key # å¼¹å‡ºå³è¾¹ç¬¬ä¸€ä¸ªå…ƒç´  4. Setï¼ˆé›†åˆï¼‰ ç±»ä¼¼ Setï¼Œä½†æ¯ä¸ªæˆå‘˜å…³è”ä¸€ä¸ªåˆ†æ•°ï¼ˆscoreï¼‰ï¼ŒæŒ‰åˆ†æ•°æ’åºã€‚ å¸¸ç”¨äºæ’è¡Œæ¦œã€å¸¦æƒé‡çš„ä»»åŠ¡é˜Ÿåˆ—ç­‰ã€‚ 1234SADD key member [member...] # æ·»åŠ æˆå‘˜SMEMBERS key # è·å–æ‰€æœ‰æˆå‘˜SISMEMBER key member # åˆ¤æ–­æ˜¯å¦æ˜¯æˆå‘˜SCARD key # è·å–é›†åˆå¤§å° 5. Sorted Setï¼ˆæœ‰åºé›†åˆ &#x2F; ZSetï¼‰ ç±»ä¼¼ Setï¼Œä½†æ˜¯æ¯ä¸ªæˆå‘˜å…³è”ä¸€ä¸ªåˆ†æ•°ï¼ˆscoreï¼‰ï¼ŒæŒ‰åˆ†æ•°æ’åºã€‚ å¸¸ç”¨äºæ’è¡Œæ¦œã€å¸¦æƒé‡çš„ä»»åŠ¡é˜Ÿåˆ—ç­‰ã€‚ 1234ZADD key score member [score member...] # æ·»åŠ æˆå‘˜åŠåˆ†æ•°ZRANGE key start stop [WITHSCORES] # æŒ‰åˆ†æ•°å‡åºè¿”å›æˆå‘˜ZREVRANGE key start stop [WITHSCORES] # æŒ‰åˆ†æ•°é™åºZSCORE key member # è·å–æˆå‘˜çš„åˆ†æ•° äºŒã€HiRedisHiRedis æ˜¯ C++ çš„ä¸€ç§åº“ï¼ŒC++ è¿˜æœ‰å…¶ä»–åº“ï¼ˆredis-plus-plusï¼‰ç­‰ç­‰ã€‚æºç è¿™é‡Œä¸å»ä»‹ç»ï¼Œä¸è¿‡é€šå¸¸æˆ‘ä»¬ä¼šå¯¹ Redis æä¾›çš„æ“ä½œè¿›è¡Œä¸€äº›å°è£…ï¼Œæ¯”å¦‚ 1. Connect æ“ä½œ12345678bool CRedisMgr::Connect(const std::string&amp; host, int port) &#123; this-&gt;m_conn_ = redisConnect(host.c_str(), port); if (this-&gt;m_conn_ == nullptr) return false; if (this-&gt;m_conn_ != nullptr &amp;&amp; this-&gt;m_conn_-&gt;err) &#123; return false; &#125; return true;&#125; 2. Auth æ“ä½œ1234567891011bool CRedisMgr::Auth(const std::string&amp; password) &#123; this-&gt;m_reply_ = (redisReply*)redisCommand(this-&gt;m_conn_, &quot;AUTH %s&quot;, password.c_str()); if (this-&gt;m_reply_-&gt;type == REDIS_REPLY_ERROR) &#123; freeReplyObject(this-&gt;m_reply_); return false; &#125; else &#123; freeReplyObject(this-&gt;m_reply_); return false; &#125; return 3. Get æ“ä½œ123456789101112131415bool CRedisMgr::Get(const std::string&amp; key, std::string&amp; value) &#123; this-&gt;m_reply_ = (redisReply*)redisCommand(this-&gt;m_conn_, &quot;GET %s&quot;, key.c_str()); if (this-&gt;m_reply_ == nullptr) &#123; freeReplyObject(this-&gt;m_reply_); return false; &#125; if (this-&gt;m_reply_-&gt;type == REDIS_REPLY_ERROR) &#123; freeReplyObject(this-&gt;m_reply_); return false; &#125; value = this-&gt;m_reply_-&gt;str; freeReplyObject(this-&gt;m_reply_); std::cout &lt;&lt; &quot;Succeed to execute command [ GET &quot; &lt;&lt; key &lt;&lt; &quot; ]&quot; &lt;&lt; &#x27;\\n&#x27;; return false;&#125; 4. HSet æ“ä½œ1234567891011121314151617181920bool CRedisMgr::HSet(const char* key, const char* hkey, const char* hvalue, size_t hvalueLen) &#123; // é‡‡ç”¨ redisCommandArgv æ–¹æ³• const char* argv[4]; size_t argvlen[4]; argv[0] = &quot;HSET&quot;; argvlen[0] = 4; argv[1] = key; argvlen[1] = strlen(key); argv[2] = hkey; argvlen[2] = strlen(hkey); argv[3] = hvalue; argvlen[3] = hvalueLen; this-&gt;m_reply_ = (redisReply*)redisCommandArgv(this-&gt;m_conn_, 4, argv, argvlen); if (this-&gt;m_reply_ == nullptr || m_reply_-&gt;type != REDIS_REPLY_INTEGER) &#123; freeReplyObject(this-&gt;m_reply_); return false; &#125; freeReplyObject(this-&gt;m_reply_); return true;&#125; ä¸Šé¢çš„æ“ä½œåŸºæœ¬æ˜¯éµå¾ªä¸€ä¸ªæ¨¡æ¿ï¼š 123456789101112bool CRedisMgr::xxx(const std::string&amp; key, std::string&amp; value) &#123; redisContext *context; redisReply *reply = (redisReply*)redisCommand(context, &quot;xxx %s %s&quot;, key.c_str(), value.c_str()); if(reply == nullptr || reply == REDIS_REPLY_ERROR) &#123; ~~Debug(); freeReplyObject(reply); return false; &#125; ~~Debug(); freeReplyObject(reply); return true;&#125; ä¸è¿‡æ¯”è¾ƒè›‹ç–¼çš„æ˜¯ä¸åŒæ“ä½œå¦‚æœå‡ºé”™å¯¹åº”çš„ä¸åŒç§çš„å®ï¼Œæ‰€ä»¥è¿˜å¾—è‡ªå·±å»æŸ¥ï¼Œè¿™é‡Œç»™ä¸ªå¤§æ¦‚çš„åˆ†ç±» â€œæŸ¥è¯¢å€¼â€ å‹å‘½ä»¤ -&gt; è¿”å› STRING æˆ–è€… NILï¼ˆGet, HGet, ZScoreï¼‰ â€œæ“ä½œè®¡æ•°â€ å‹å‘½ä»¤-&gt; è¿”å› INTEGERï¼ˆDEL, HSET, RPUSH, EXISTS, INCR) â€œçŠ¶æ€åé¦ˆâ€ å‹å‘½ä»¤ -&gt; è¿”å› STATUSï¼ˆSET, FLUSHDB, SAVEï¼‰ â€œé›†åˆ&#x2F;åˆ—è¡¨â€ å‹å‘½ä»¤ -&gt; è¿”å› ARRAYï¼ˆHGETALL , SMEMBERSï¼‰","categories":[{"name":"ç¬¬ä¸‰æ–¹åº“","slug":"ç¬¬ä¸‰æ–¹åº“","permalink":"https://dxblacksmith.github.io/categories/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"}],"tags":[]},{"title":"nodemailer çš„ä½¿ç”¨","slug":"nodemailer","date":"2026-01-31T13:44:19.253Z","updated":"2026-01-31T13:47:32.980Z","comments":true,"path":"2026/01/31/nodemailer/","permalink":"https://dxblacksmith.github.io/2026/01/31/nodemailer/","excerpt":"","text":"NodeMaileræ¦‚å¿µä»‹ç»NodeMailer æ˜¯ä¸€ä¸ªç”¨äº Node.js çš„é‚®ä»¶å‘é€åº“ï¼Œ é€šè¿‡è¿æ¥ SMTP åè®®ï¼Œä¸æŒ‡å®šçš„é‚®ä»¶æœåŠ¡å•†ï¼ˆQQã€163ã€Gmail ç­‰ï¼‰çš„ SMTP æœåŠ¡å™¨å»ºç«‹å®‰å…¨è¿æ¥ï¼Œå¹¶ ä»£ç† å¼€å‘è€…å®Œæˆé‚®ä»¶çš„æäº¤ä¸æŠ•é€’ï¼ˆå…ˆæäº¤å†æŠ•é€’ï¼‰ 123456789let transport = nodemailer.createTransport(&#123; host: &#x27;smtp.qq.com&#x27;, // â† 1. æŒ‡å®š SMTP æœåŠ¡å™¨åœ°å€ port: 465, // â† 2. ä½¿ç”¨ SMTPSï¼ˆSMTP over SSLï¼‰ç«¯å£ secure: true, // â† 3. å¯ç”¨ TLS/SSL åŠ å¯† auto: &#123; user: &#x27;your_email@example.com&#x27;, // â† 4. èº«ä»½è®¤è¯ï¼šé‚®ç®±è´¦å· pass: &#x27;your_smtp_auth_code&#x27; // â† 5. èº«ä»½è®¤è¯ï¼šæˆæƒç ï¼ˆéç™»å½•å¯†ç ï¼ï¼‰ &#125;&#125;) å½“æ‰§è¡Œï¼š 1await transport.sendMail(mailOptiion) nodemailer ä¼šï¼š å»ºç«‹ TCP è¿æ¥ åˆ° smtp.qq.com:465 è‡ªåŠ¨åå•† SSL&#x2F;TLS åŠ å¯†é€šé“ï¼ˆå› ä¸º secure: trueï¼‰ å‘é€ SMTP å‘½ä»¤åºåˆ— EHLO â†’ æ¡æ‰‹ AUTH LOGIN â†’ ä½¿ç”¨ Base64 ç¼–ç å‘é€ user å’Œ pass MAIL FROM:&lt;from@example.com â†’ å£°æ˜å‘ä»¶äºº RCPT TO:&lt;to@example.com&gt; â†’ å£°æ˜æ”¶ä»¶äºº DATA â†’ å‘é€é‚®ä»¶å¤´ + æ­£æ–‡ QUIT â†’ æ–­å¼€è¿æ¥ å°†é‚®ä»¶æäº¤ç»™ QQ é‚®ç®±çš„ SMTP æœåŠ¡å™¨ ç”± QQ é‚®ç®±ç³»ç»Ÿè´Ÿè´£æœ€ç»ˆæŠ•é€’åˆ°ç›®æ ‡é‚®ç®±ï¼ˆå¦‚ 163ã€Gmailã€Outlook ç­‰ï¼‰ nodemailer ä¸ç›´æ¥æŠ•é€’åˆ°æ”¶ä»¶äººé‚®ç®±ï¼Œè€Œæ˜¯æŠŠé‚®ä»¶â€œäº¤ç»™â€ä½ é…ç½®çš„ SMTP æœåŠ¡å•†ï¼ˆè¿™é‡Œæ˜¯ QQï¼‰ï¼Œç”±å®ƒå®Œæˆåç»­è·¯ç”±å’ŒæŠ•é€’ã€‚ ä¸€å¥è¯æ€»ç»“å°±æ˜¯ï¼š âœ… **nodemailer æ˜¯ä¸€ä¸ª SMTP å®¢æˆ·ç«¯åº“ï¼Œå®ƒå°è£…äº† SMTP åè®®çš„åº•å±‚é€šä¿¡ç»†èŠ‚ï¼Œè®©ä½ èƒ½ç”¨ç®€å•çš„ JavaScript å¯¹è±¡é…ç½®ï¼Œå³å¯é€šè¿‡ä»»æ„æ”¯æŒ SMTP çš„é‚®ä»¶æœåŠ¡å•†ï¼ˆå¦‚ QQã€163ã€SendGridã€Amazon SES ç­‰ï¼‰å‘é€é‚®ä»¶ã€‚ Nodemailer ä½¿ç”¨æµç¨‹ï¼ˆ5 æ­¥ï¼‰ç¬¬ 1 æ­¥ï¼šå®‰è£…ä¾èµ–1npm install nodemailer âš ï¸ æ³¨æ„ï¼šä»…ç”¨äºæœåŠ¡ç«¯ï¼ˆNode.jsï¼‰ï¼Œä¸èƒ½åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼ˆæ¶‰åŠ SMTP å¯†é’¥ï¼Œä¸”æµè§ˆå™¨æ—  TCP æƒé™ï¼‰ã€‚ ç¬¬ 2 æ­¥ï¼šåˆ›å»ºä¼ è¾“å™¨ï¼ˆTransporterï¼‰é…ç½® SMTP æœåŠ¡å™¨è¿æ¥ä¿¡æ¯ï¼š 123456789let transport = nodemailer.createTransport(&#123; host: &#x27;smtp.qq.com&#x27;, // â† 1. æŒ‡å®š SMTP æœåŠ¡å™¨åœ°å€ port: 465, // â† 2. ä½¿ç”¨ SMTPSï¼ˆSMTP over SSLï¼‰ç«¯å£ secure: true, // â† 3. å¯ç”¨ TLS/SSL åŠ å¯† auto: &#123; user: &#x27;your_email@example.com&#x27;, // â† 4. èº«ä»½è®¤è¯ï¼šé‚®ç®±è´¦å· pass: &#x27;your_smtp_auth_code&#x27; // â† 5. èº«ä»½è®¤è¯ï¼šæˆæƒç ï¼ˆéç™»å½•å¯†ç ï¼ï¼‰ &#125;&#125;) ğŸ” æˆæƒç è·å–æ–¹å¼ï¼ˆä»¥ QQ é‚®ç®±ä¸ºä¾‹ï¼‰ï¼š ç™»å½• QQ é‚®ç®± â†’ è®¾ç½® â†’ è´¦æˆ· å¼€å¯ â€œPOP3&#x2F;SMTP æœåŠ¡â€ â†’ æŒ‰æç¤ºç”Ÿæˆ 16 ä½æˆæƒç  ç¬¬ 3 æ­¥ï¼šå®šä¹‰é‚®ä»¶å†…å®¹ï¼ˆMail Optionsï¼‰1234567const mailOptions = &#123; from: &#x27;&quot;Your App&quot; &lt;your_email@qq.com&gt;&#x27;, // å‘ä»¶äººï¼ˆå¿…é¡»ä¸ auth.user ä¸€è‡´æˆ–åˆ«åï¼‰ to: &#x27;recipient@example.com&#x27;, // æ”¶ä»¶äººï¼ˆå¯å¤šä¸ªï¼š&#x27;a@x.com, b@y.com&#x27;ï¼‰ subject: &#x27;éªŒè¯ç &#x27;, // é‚®ä»¶æ ‡é¢˜ text: &#x27;æ‚¨çš„éªŒè¯ç æ˜¯ï¼š123456&#x27;, // çº¯æ–‡æœ¬æ­£æ–‡ // html: &#x27;&lt;b&gt;æ‚¨çš„éªŒè¯ç æ˜¯ï¼š123456&lt;/b&gt;&#x27; // HTML æ­£æ–‡ï¼ˆå¯é€‰ï¼Œä¼˜å…ˆçº§é«˜äº textï¼‰&#125;; ğŸ“Œ å…³é”®è§„åˆ™ï¼š from ä¸­çš„é‚®ç®±åœ°å€ å¿…é¡»ä¸ auth.user ä¸€è‡´ï¼Œå¦åˆ™ä¼šè¢« SMTP æœåŠ¡å™¨æ‹’ç»ã€‚ å¯åŒæ—¶æä¾› text å’Œ htmlï¼Œå®¢æˆ·ç«¯ä¼šä¼˜å…ˆæ˜¾ç¤º htmlã€‚ ç¬¬ 4 æ­¥ï¼šå‘é€é‚®ä»¶ï¼ˆå¼‚æ­¥ï¼‰123456789101112async function sendEmail() &#123; try &#123; const info = await transporter.sendMail(mailOptions); console.log(&#x27;Message sent: %s&#x27;, info.messageId); // ç¤ºä¾‹è¾“å‡º: Message sent: &lt;b658f8ca-4d9e-11ea-8f00-0a0b12345678@qq.com&gt; &#125; catch (error) &#123; console.error(&#x27;Send email failed:&#x27;, error); // å¸¸è§é”™è¯¯ï¼šè®¤è¯å¤±è´¥ã€ç½‘ç»œè¶…æ—¶ã€é…é¢è¶…é™ &#125;&#125;sendEmail(); ğŸ’¡ è¿”å›çš„ info åŒ…å«é‚®ä»¶ IDã€å“åº”çŠ¶æ€ç­‰ï¼Œå¯ç”¨äºæ—¥å¿—æˆ–è¿½è¸ªã€‚ ç¬¬ 5 æ­¥ï¼ˆå¯é€‰ï¼‰ï¼šéªŒè¯ SMTP é…ç½®æ˜¯å¦æœ‰æ•ˆ12345678// æµ‹è¯•è¿æ¥ï¼ˆä¸å‘é‚®ä»¶ï¼‰transporter.verify((error, success) =&gt; &#123; if (error) &#123; console.log(&#x27;SMTP config error:&#x27;, error); &#125; else &#123; console.log(&#x27;SMTP server is ready to take messages&#x27;); &#125;&#125;);","categories":[{"name":"ç¬¬ä¸‰æ–¹åº“","slug":"ç¬¬ä¸‰æ–¹åº“","permalink":"https://dxblacksmith.github.io/categories/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"}],"tags":[]},{"title":"rpc çš„ä½¿ç”¨","slug":"rpc çš„ä½¿ç”¨","date":"2026-01-30T11:43:34.449Z","updated":"2026-01-31T09:53:40.534Z","comments":true,"path":"2026/01/30/rpc çš„ä½¿ç”¨/","permalink":"https://dxblacksmith.github.io/2026/01/30/rpc%20%E7%9A%84%E4%BD%BF%E7%94%A8/","excerpt":"","text":"RPC ä»‹ç»æ ¸å¿ƒæ€æƒ³ï¼š è®©è°ƒç”¨è¿œç¨‹æœåŠ¡åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·ç®€å• 1234// æœ¬åœ°å‡½æ•°è°ƒç”¨int result = local_add(1, 2);// RPC è°ƒç”¨ - çœ‹èµ·æ¥ä¸€æ ·ï¼Œä½†å®é™…åœ¨è¿œç¨‹æ‰§è¡Œint result = remote_add(1, 2); // è¿™ä¸ªå‡½æ•°åœ¨å¦ä¸€å°æœºå™¨ä¸Šæ‰§è¡Œ è§£å†³äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æœåŠ¡é—´é€šä¿¡ï¼ŒåŒæ—¶éšè—äº†ç½‘ç»œé€šä¿¡çš„å¤æ‚æ€§ï¼Œæä¾›äº†ç±»å‹å®‰å…¨çš„è¿œç¨‹è°ƒç”¨ RPC åŸºæœ¬ç»„ä»¶ä¸€ä¸ªå®Œæ•´çš„ RPC ç³»ç»Ÿé€šå¸¸åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªå±‚æ¬¡ï¼š æ¥å£å®šä¹‰è¯­è¨€ï¼ˆIDL, Interface Definition Languageï¼‰â€”â€” æè¿°æœåŠ¡æ–¹æ³•å’Œæ•°æ®ç»“æ„ã€‚ æ•°æ®åºåˆ—åŒ–æ ¼å¼â€”â€” å°†ç»“æ„åŒ–æ•°æ®è½¬æ¢ä¸ºå¯ä¼ è¾“çš„å­—èŠ‚æµã€‚ ç½‘ç»œé€šä¿¡åè®®â€”â€” è´Ÿè´£è¯·æ±‚&#x2F;å“åº”çš„ä¼ è¾“ã€è¿æ¥ç®¡ç†ã€é”™è¯¯å¤„ç†ç­‰ã€‚ protobuf èƒ½è§£å†³å‰ä¸¤ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ 123456// å®šä¹‰æ¥å£service UserService &#123; // æœåŠ¡æ¥å£å®šä¹‰ rpc GetUser(GetUserReq) returns (UserRsp); // è¿œç¨‹æ–¹æ³•å®šä¹‰ rpc CreateUser(CreateUserReq) returns (UserRsp);&#125;message GetUserReq &#123; int32 user_id = 1; &#125; 12345678// Protobuf æä¾›åºåˆ—åŒ–æ–¹æ³•GetUserReq request;request.set_user_id(123);std::string serialized_data = request.SerializeAsString();// ååºåˆ—åŒ–GetUserReq new_request;new_request.ParseFromString(serialized_data); è€Œ rpc æ¡†æ¶é€šå¸¸èƒ½è‡ªå·±è§£å†³ç¬¬ä¸‰å±‚ç½‘ç»œåè®® RPC ç³»ç»Ÿåˆ†å±‚ ç¬¬ä¸€å±‚ï¼šæ¥å£æè¿°æ–‡ä»¶å±‚ï¼ˆIDL Layerï¼‰ï¼Œé€šå¸¸ç”¨ .proto æ¥å®šä¹‰ 1234567891011121314151617// user_service.proto - æ¥å£æè¿°å±‚syntax = &quot;proto3&quot;;service UserService &#123; rpc GetUser(GetUserRequest) returns (UserResponse); rpc CreateUser(CreateUserRequest) returns (UserResponse);&#125;message GetUserRequest &#123; int32 user_id = 1;&#125;message UserResponse &#123; int32 user_id = 1; string name = 2; string email = 3;&#125; ç¬¬äºŒå±‚ï¼šRPC åè®®å±‚ï¼ˆProtocol Layerï¼‰ï¼Œé€šå¸¸ç”± protoc.exeé…åˆ RPC çš„æ’ä»¶ä½¿ç”¨ï¼Œç”Ÿæˆçš„æ˜¯æ¯”å¦‚ .grpc.pb.cc å’Œ .grpc.pb.hæ–‡ä»¶ 123456789101112131415// ç”± protoc ç”Ÿæˆçš„ä»£ç  - RPC åè®®å±‚class UserService_Stub : public ::google::protobuf::Service &#123;public: // å®¢æˆ·ç«¯å­˜æ ¹ - å°è£…è°ƒç”¨ç»†èŠ‚ void GetUser(::google::protobuf::RpcController* controller, const GetUserRequest* request, UserResponse* response, ::google::protobuf::Closure* done); // æœåŠ¡ç«¯éª¨æ¶ - æä¾›å®ç°åŸºç±» virtual void GetUser(::google::protobuf::RpcController* controller, const GetUserRequest* request, UserResponse* response, ::google::protobuf::Closure* done) = 0;&#125;; ç¬¬ä¸‰å±‚ï¼šç½‘ç»œé€šä¿¡å±‚ï¼ˆTransport Layerï¼‰ï¼Œè¿™ä¸€å±‚é€šå¸¸è‡ªå·±å®ç° 12345678910111213// gRPC ç½‘ç»œé€šä¿¡å±‚class GrpcTransport &#123;public: // å»ºç«‹è¿æ¥ bool Connect(const std::string&amp; endpoint); // å‘é€è¯·æ±‚ bool SendRequest(const std::string&amp; method_name, const std::string&amp; serialized_data); // æ¥æ”¶å“åº” std::string ReceiveResponse(); // å¤„ç†ç½‘ç»œé”™è¯¯ã€è¶…æ—¶ã€é‡è¯•ç­‰ void HandleErrors();&#125;; ä½¿ç”¨ grpc + protobuf çš„å®Œæ•´æµç¨‹Protocol Buffers æ˜¯ä¸€ç§æ¥å£å®šä¹‰è¯­è¨€ï¼ˆIDLï¼‰å’Œé«˜æ•ˆçš„åºåˆ—åŒ–æ¡†æ¶ï¼Œå®ƒæä¾›äº†è·¨è¯­è¨€çš„æ•°æ®ç»“æ„å’ŒæœåŠ¡æ¥å£å®šä¹‰èƒ½åŠ›ã€‚ 123Protocol Buffers = â”œâ”€â”€ æ¥å£å®šä¹‰è¯­è¨€ (IDL) // å®šä¹‰æ•°æ®ç»“æ„å’ŒæœåŠ¡å¥‘çº¦â””â”€â”€ åºåˆ—åŒ–æ¡†æ¶ // æä¾›é«˜æ•ˆçš„äºŒè¿›åˆ¶åºåˆ—åŒ– gRPC æ˜¯åŸºäº Protobuf æ„å»ºçš„ä¸€ä¸ªé«˜æ€§èƒ½ RPC æ¡†æ¶ï¼ŒåŸºäº HTTP&#x2F;2 åè®®æ„å»ºï¼Œä½†ä¸ä»…ä»… â€œåè®®â€ æœ¬èº«ï¼Œè€Œæ˜¯ä¸€ä¸ª â€œé¢å‘æœåŠ¡çš„é€šä¿¡æ¡†æ¶â€ã€‚ä¸“ä¸ºå¾®æœåŠ¡è®¾è®¡ã€‚ å±‚çº§ æŠ€æœ¯ ä¼ è¾“å±‚ TCP åº”ç”¨å±‚åè®® HTTP&#x2F;2 åºåˆ—åŒ–æ ¼å¼ Protocol Buffers RPC æ¡†æ¶ gRPCï¼ˆå°è£…äº†ä¸Šè¿°ä¸‰å±‚ï¼‰ è€Œ Protobuf æœ¬èº«è¿˜å¯ä»¥ä½œä¸ºè®¸å¤šå…¶ä»–ç³»ç»Ÿï¼ˆå¦‚æ¶ˆæ¯é˜Ÿåˆ—ã€API ç½‘å…³ã€é…ç½®ç®¡ç†ç­‰ï¼‰çš„åŸºç¡€æ•°æ®å®šä¹‰æ ¼å¼ï¼ŒåŸºç¡€ç”¨æ³•å¦‚ä¸‹ï¼š 1231. ç”¨ .proto å®šä¹‰æ¥å£ä»¥åï¼Œ2. ä½¿ç”¨ .protoc é…åˆå¯¹åº”æ¡†æ¶çš„æ’ä»¶ç›´æ¥ç”Ÿæˆä»£ç 3. å°†ä»£ç ä»£ç æ·»åŠ è¿›é¡¹ç›®ä¸­ï¼Œåœ¨é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨ç”Ÿæˆçš„ç±»ã€‚ æ­¥éª¤ 1ï¼šç¼–å†™ .proto æ–‡ä»¶ï¼ˆå®šä¹‰æœåŠ¡å¥‘çº¦ï¼‰ é¦–å…ˆåºåˆ—åŒ–ç”Ÿæˆæ•°æ®ç»“æ„ï¼ˆ.protoæ–‡ä»¶ä¸ä¾èµ–ä»»ä½•ç‰¹å®šç¼–ç¨‹è¯­è¨€ï¼‰ï¼Œé€šå¸¸å†™ä½œï¼š 123456789syntax = &quot;proto3&quot;;package example;service Calculator &#123; rpc Add(AddRequest) returns (AddResponse);&#125;message AddRequest &#123; int32 a = 1; int32 b = 2; &#125;message AddResponse &#123; int32 result = 1; &#125; æ­¥éª¤ 2ï¼šç”¨ protoc ç”Ÿæˆä»£ç  1protoc --cpp_out=. calculator.proto -&gt; calculator.pb.h, calculator.pb.cc å†åˆ©ç”¨æ’ä»¶ç”Ÿæˆ grpc æœåŠ¡æ¡†æ¶ï¼ˆæ’ä»¶ä¿è¯äº† protobuf å¯ä»¥ä¸ºä¸åŒç”¨é€”ç”Ÿæˆä¸åŒä»£ç ï¼‰ 12protoc --grpc_out=. --plugin=protoc-gen-grpc=grpc_cpp_plugin.exe calculator.proto -&gt; calculator.grpc.pb.h, calculator.grpc.pb.cc è¾“å‡ºæ–‡ä»¶ï¼š calculator.pb.h/cc â†’ æ•°æ®ç»“æ„ calculator.grpc.pb.h/cc â†’æœåŠ¡æ¥å£ï¼ˆStub + Serviceï¼‰ æ­¥éª¤ 3 ï¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ç”Ÿæˆä»£ç ï¼š å®¢æˆ·ç«¯ï¼šé€šè¿‡ Stub å‘èµ·è¿œç¨‹è°ƒç”¨ï¼› æœåŠ¡ç«¯ï¼šç»§æ‰¿ Service ç±»å¹¶å®ç°å…·ä½“æ–¹æ³•ï¼›","categories":[{"name":"ç¬¬ä¸‰æ–¹åº“","slug":"ç¬¬ä¸‰æ–¹åº“","permalink":"https://dxblacksmith.github.io/categories/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"}],"tags":[]},{"title":"shared_from_this","slug":"shared_from_this","date":"2026-01-30T08:58:58.082Z","updated":"2026-01-30T08:58:58.367Z","comments":true,"path":"2026/01/30/shared_from_this/","permalink":"https://dxblacksmith.github.io/2026/01/30/shared_from_this/","excerpt":"","text":"Shared_from_this1. å¼‚æ­¥æ¨¡å‹1.1 ç”¨æ³•ä¸»è¦ç”¨äºé˜²æ­¢å¯¹è±¡è¿‡æ—©ææ„ åœ¨ Asio çš„å¼‚æ­¥æ¨¡å‹ä¸­ï¼Œè°ƒç”¨ async_read æˆ–è€… async_write è¿™ç§å¼‚æ­¥æ“ä½œæ—¶ï¼Œå‡½æ•°ä¼šç«‹å³è¿”å›ã€‚å½“ IO å®Œæˆæ—¶ï¼ŒAsio å†è°ƒç”¨ç»‘å®šçš„å›è°ƒã€‚åŒæ—¶å›è°ƒå¯èƒ½éœ€è¦è®¿é—® this çš„ä¸€äº›æˆå‘˜ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä»»ä½•ä¸œè¥¿æŒæœ‰ CHttpConnection çš„å¼•ç”¨ï¼Œå®ƒå¯èƒ½åœ¨ I&#x2F;O å®Œæˆå‰å°±è¢«ææ„äº†ï¼ æ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨å›è°ƒä¸­æ•è· shared_from_this 12345678void CHttpConnection::ReadRequest() &#123; auto self = shared_from_this(); http::async_read(m_socket_, m_buffer_, m_request_, [self](beast::error_code ec, std::size_t bytes_transferred) &#123; // å³ä½¿å¤–éƒ¨ä¸å†æŒæœ‰ selfï¼Œè¿™ä¸ª lambda ä¹Ÿä¼š keep-alive æ•´ä¸ªè¿æ¥å¯¹è±¡ self-&gt;HandleRequest(); // å®‰å…¨è°ƒç”¨æˆå‘˜å‡½æ•° &#125;);&#125; 1.2 åŸç†shared_from_this() æ˜¯ std::enable_shared_from_this&lt;T&gt; æä¾›çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ã€‚è°ƒç”¨ shared_from_this() è¿”å›çš„ shared_ptr ä¸åŸå§‹ shared_ptr å…±äº«åŒä¸€å—æ§åˆ¶å—ï¼ˆcontrol blockï¼‰ï¼Œå› æ­¤ï¼š å¼•ç”¨è®¡æ•° +1ï¼› åªè¦è¿˜æœ‰ä»»ä½•ä¸€ä¸ª shared_ptrï¼ˆåŒ…æ‹¬ lambda æ•è·çš„é‚£ä¸ª selfï¼‰æœªè¢«é”€æ¯ï¼Œå¯¹è±¡å°±ä¸ä¼šææ„ï¼› ä¸ºä»€ä¹ˆä¸ç›´æ¥å†™ auto self = std::shared_ptr(this);ã€‚å› ä¸ºä¼šé€ æˆåŒé‡ææ„çš„é£é™©ï¼š 1auto bad_self = std::shared_ptr&lt;CHttpConnection&gt;(this); // å±é™©ï¼ è¿™ä¼šåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ã€ç‹¬ç«‹çš„ shared_ptrï¼Œå®ƒæ‹¥æœ‰è‡ªå·±çš„å¼•ç”¨è®¡æ•°å™¨ã€‚ä½† this å·²ç»è¢«å¦ä¸€ä¸ª shared_ptrï¼ˆæ¯”å¦‚ make_shared åˆ›å»ºçš„é‚£ä¸ªï¼‰ç®¡ç†äº†ã€‚ â†’ å½“è¿™ä¸¤ä¸ª shared_ptr å„è‡ªææ„æ—¶ï¼Œéƒ½ä¼šå°è¯• delete thisï¼Œå¯¼è‡´ é‡å¤é‡Šæ”¾åŒä¸€å—å†…å­˜ï¼Œå¼•å‘ å´©æºƒæˆ–æœªå®šä¹‰è¡Œä¸ºã€‚","categories":[{"name":"C++ æ–°ç‰¹æ€§","slug":"C-æ–°ç‰¹æ€§","permalink":"https://dxblacksmith.github.io/categories/C-%E6%96%B0%E7%89%B9%E6%80%A7/"}],"tags":[]},{"title":"Boost.Asio çš„ä½¿ç”¨","slug":"Boost.Asio","date":"2026-01-29T12:43:37.528Z","updated":"2026-01-29T12:43:37.842Z","comments":true,"path":"2026/01/29/Boost.Asio/","permalink":"https://dxblacksmith.github.io/2026/01/29/Boost.Asio/","excerpt":"","text":"Boost.Asio åº“io_context1. æ¦‚å¿µio_context æ˜¯ Asio åº“çš„æ ¸å¿ƒäº‹ä»¶å¾ªç¯å’Œ IO è°ƒåº¦å™¨ï¼Œä¹Ÿæ˜¯æ‰€æœ‰å¼‚æ­¥ I&#x2F;O äº‹ä»¶å¤„ç†çš„åŸºç¡€ã€‚å·¥ä½œé€»è¾‘ä¸º å°†éœ€è¦ç›‘å¬çš„ IO äº‹ä»¶ï¼ˆå¦‚ socket çš„è¯»&#x2F;å†™å°±ç»ªã€è¿æ¥è¯·æ±‚å°±ç»ªï¼‰å’Œå¯¹åº”çš„å¤„ç†å›è°ƒæ³¨å†Œåˆ° io_context çš„äº‹ä»¶ç®¡ç†ä½“ç³»ä¸­ å¯ç”¨ io_context çš„äº‹ä»¶å¾ªç¯ä»¥åï¼Œä¼šæŒç»­é€šè¿‡åº•å±‚å¤šè·¯å¤ç”¨çš„æœºåˆ¶æ£€æµ‹å·²æ³¨å†Œçš„äº‹ä»¶çŠ¶æ€â€¦â€¦ å½“æ£€æµ‹åˆ°æŸä¸ª IO äº‹ä»¶å°±ç»ªä»¥åï¼Œä¼šè‡ªåŠ¨è°ƒç”¨æ‰§è¡Œè¯¥äº‹ä»¶å¯¹åº”çš„ä¸Šå±‚å›è°ƒå‡½æ•°ï¼Œå®Œæˆ IO äº‹ä»¶çš„å¤„ç† 2. å’Œ epoll&#x2F;iocp çš„å…³ç³»io_context æ˜¯è·¨å¹³å°æŠ½è±¡å±‚ï¼Œepoll åªæ˜¯å…¶åœ¨ Linux ä¸‹çš„ä¸€ç§åº•å±‚å®ç°ï¼Œç±»ä¼¼ 1ã€ä¸Šå±‚ï¼šå¼€å‘è€…ä»£ç ã€‘â†’ ã€ä¸­é—´å±‚ï¼šio_contextï¼ˆäº‹ä»¶è°ƒåº¦ï¼‰ã€‘â†’ ã€åº•å±‚ï¼šæ“ä½œç³»ç»ŸIOå¤šè·¯å¤ç”¨ï¼ˆepoll/IOCPï¼‰ã€‘ ç”¨ä»£ç å®ç°çš„è¯ æ³¨å†Œï¼šå°†ä»£ç ä¸­ tcp::acceptorï¼ˆç›‘å¬å¥—æ¥å­—ï¼‰ã€tcp::socketï¼ˆé€šä¿¡å¥—æ¥å­—ï¼‰å’Œå„ç§äº‹ä»¶ï¼ˆç«¯å£ç›‘å¬ï¼Œsocket è¯»&#x2F;å†™ï¼‰ç­‰äº‹ä»¶æ³¨å†Œåˆ° io_contextï¼ŒåŒæ—¶ç»‘å®šè‡ªå®šä¹‰å›è°ƒï¼› ä¼ é€’ï¼šio_context æ¥æ”¶åˆ°æ³¨å†Œè¯·æ±‚åï¼Œä¼šå°†å¯¹åº”çš„ socket å¥æŸ„ã€äº‹ä»¶ç±»å‹ï¼ˆè¯» &#x2F; å†™ &#x2F; è¿æ¥ï¼‰ä¼ é€’ç»™åº•å±‚çš„ epollï¼Œå®Œæˆ epoll çš„äº‹ä»¶æ³¨å†Œï¼› å¯åŠ¨ï¼šè°ƒç”¨ io_context.run() å¯åŠ¨äº‹ä»¶å¾ªç¯ï¼Œio_context ä¼šè°ƒç”¨ epoll çš„ epoll_wait æ–¹æ³•ï¼Œé˜»å¡ç­‰å¾…å†…æ ¸çš„äº‹ä»¶å°±ç»ªé€šçŸ¥ å“åº”å¤„ç†ï¼šæœ‰äº‹ä»¶å°±ç»ªï¼Œå†…æ ¸é€šè¿‡ epoll å‘ io_context å‘é€å°±ç»ªé€šçŸ¥ï¼Œç„¶åè°ƒåº¦æ‰§è¡Œå¼€å‘è€…æ³¨å†Œçš„ä¸Šå±‚å›è°ƒå‡½æ•° 3. æ ¸å¿ƒç‰¹ç‚¹è·¨å¹³å°æ€§ï¼šè‹¥ä½ çš„æœåŠ¡ç«¯ç§»æ¤åˆ° Windowsï¼Œio_context ä¼šè‡ªåŠ¨åˆ‡æ¢ä¸ºåŸºäº IOCP å®ç°ï¼Œä½ çš„ä¸Šå±‚ä»£ç æ— éœ€ä»»ä½•ä¿®æ”¹ï¼Œè¿™æ˜¯ io_context æœ€æ ¸å¿ƒçš„ä»·å€¼ï¼ˆå±è”½äº†ä¸åŒç³»ç»Ÿçš„åº•å±‚ IO å·®å¼‚ï¼‰ï¼› ä¸æ­¢å°è£… epollï¼šio_context é™¤äº†å°è£… IO å¤šè·¯å¤ç”¨ï¼Œè¿˜å®ç°äº†äº‹ä»¶è°ƒåº¦ã€å›è°ƒç®¡ç†ã€çº¿ç¨‹æ± é€‚é…ç­‰åŠŸèƒ½ï¼Œè€Œ epoll ä»…è´Ÿè´£å†…æ ¸æ€çš„ IO äº‹ä»¶æ£€æµ‹ï¼Œæ— ä¸Šå±‚è°ƒåº¦èƒ½åŠ›ï¼›","categories":[{"name":"ç¬¬ä¸‰æ–¹åº“","slug":"ç¬¬ä¸‰æ–¹åº“","permalink":"https://dxblacksmith.github.io/categories/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"}],"tags":[]},{"title":"Json åºåˆ—åŒ–","slug":"Json åºåˆ—åŒ–","date":"2026-01-28T14:07:01.444Z","updated":"2026-01-30T09:17:21.042Z","comments":true,"path":"2026/01/28/Json åºåˆ—åŒ–/","permalink":"https://dxblacksmith.github.io/2026/01/28/Json%20%E5%BA%8F%E5%88%97%E5%8C%96/","excerpt":"","text":"Qtåºåˆ—åŒ–ï¼šå†…å­˜ä¸­çš„ç»“æ„åŒ–æ•°æ® -&gt; å¯å­˜å‚¨&#x2F;ç½‘ç»œä¼ è¾“çš„å­—ç¬¦ä¸²&#x2F;å­—èŠ‚æµï¼ˆJson æ ¼å¼æˆ–è€…å…¶å®ƒæ ¼å¼ï¼‰ ååºåˆ—åŒ–ï¼šæ–‡ä»¶&#x2F;ç½‘ç»œä¸­è¯»å–çš„ Json å­—ç¬¦ä¸²&#x2F;å­—èŠ‚æµ -&gt; è¿˜åŸæˆå†…å­˜ä¸­çš„ç»“æ„åŒ–æ•°æ® Qt å†…ç½®äº† Json çš„å¤„ç†ï¼Œæ ¸å¿ƒæµç¨‹å¯ä»¥æ¦‚æ‹¬ä¸ºï¼š 1å†…å­˜å¯¹è±¡ï¼ˆQJsonObjectï¼‰â‡Œ Json æ–‡æ¡£ï¼ˆQJsonDocumentï¼‰â‡Œ å­—èŠ‚æ•°ç»„ï¼ˆQByteArrayï¼‰â‡Œ æ–‡ä»¶/ç½‘ç»œ Json åºåˆ—åŒ–ï¼š123456781. QJsonObject: é€šè¿‡ insert ä¿®æ”¹ QJsonObject é‡Œé¢çš„é”®å€¼å¯¹ m_config.insert(&quot;user&quot;, &quot;test&quot;); m_config.insert(&quot;auto&quot;, true);2. QJSonDocument: ç›´æ¥ä½œä¸ºå‚æ•°æ„é€  QJsonDocument doc(m_config)3. QByteArray: é€šè¿‡ toJson å°†æ–‡æ¡£è½¬æ¢ä¸º JSON æ ¼å¼çš„å­—ç¬¦ä¸² QByteArray jsonData = doc.toJson();4. æ–‡ä»¶æˆ–è€…ç½‘ç»œå¤„ç† Json ååºåˆ—åŒ–ï¼š123456781. æ–‡ä»¶æˆ–è€…ç½‘ç»œå¤„ç†: æ–‡ä»¶çš„è¯é€šè¿‡ readAll æ¥æå–å­—ç¬¦ä¸² QByteArray data = file.readAll();2. QJsonDocument: é€šè¿‡ fromJson æå–æ–‡æ¡£å†…å®¹ QJsonParseError error; QJsonDocument doc = QJsonDocument::fromJson(data, &amp;error);3. QJsonObject: é€šè¿‡ object() ç›´æ¥æå– QJsonObject m_config = doc.object();4. æå–å®Œæ¯• JsoncppJsoncpp æ˜¯ç¬¬ä¸‰æ–¹åº“ï¼Œç»™ä»–ç¼–è¯‘é…ç½®é¡¹ç›®ä¸­å³å¯ï¼Œä¸»è¦ä»‹ç»ä¸€ä¸‹ä½¿ç”¨çš„æ–¹æ³• é¦–å…ˆ Jsoncpp é‡Œé¢æ¯”è¾ƒé‡è¦çš„æ˜¯ Json::Value å’Œ Json::Reader Json åºåˆ—åŒ–ä¸»è¦åˆ©ç”¨ Json::value.toStyleString æ¥å£ 123jsonSend[&quot;email&quot;] = email;jsonSend[&quot;error&quot;] = ErrorCodes::SUCCESS;std::string jsonstr = jsonSend.toStyledString(); Json ååºåˆ—åŒ–ä¸»è¦æ˜¯åˆ©ç”¨ Json::Reader.parse æ¥å£ 12345std::string body_str = beast::buffers_to_string(m_request.body().data());Json::Value jsonRecv;Json::Reader reader;// ååºåˆ—åŒ–bool success = reader.parse(body_str, jsonRecv);","categories":[{"name":"ç¬¬ä¸‰æ–¹åº“","slug":"ç¬¬ä¸‰æ–¹åº“","permalink":"https://dxblacksmith.github.io/categories/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"}],"tags":[]},{"title":"ç½‘ç»œé€šä¿¡åè®®","slug":"ç½‘ç»œé€šä¿¡åè®®","date":"2026-01-28T11:10:44.171Z","updated":"2026-01-28T13:56:31.603Z","comments":true,"path":"2026/01/28/ç½‘ç»œé€šä¿¡åè®®/","permalink":"https://dxblacksmith.github.io/2026/01/28/%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/","excerpt":"","text":"ç½‘ç»œé€šä¿¡åè®®Tcp åè®®TCP æ˜¯ä¼ è¾“å±‚çš„å¯é å­—èŠ‚æµé€šä¿¡åè®®ï¼Œä¸º HTTP&#x2F;HTTPS&#x2F;WebSocket ç­‰åº”ç”¨å±‚åè®®æä¾›åº•å±‚ä¼ è¾“æ”¯æ’‘ï¼Œæ ¸å¿ƒè§£å†³ã€Œæ•°æ®å¦‚ä½•æœ‰åºã€æ— ä¸¢å¤±ã€æ— é‡å¤åœ°åœ¨ä¸¤å°è®¾å¤‡é—´ä¼ è¾“ã€çš„é—®é¢˜ã€‚ å…¶è¿æ¥çš„æŒç»­æ—¶é—´å®Œå…¨ç”±ä¸Šå±‚åº”ç”¨ï¼ˆå¼€å‘è€…ï¼‰å†³å®š æ ¸å¿ƒç‰¹ç‚¹ é¢å‘è¿æ¥ï¼šé€šä¿¡å‰éœ€é€šè¿‡ã€Œä¸‰æ¬¡æ¡æ‰‹ã€å»ºç«‹è¿æ¥ï¼Œé€šä¿¡ç»“æŸåé€šè¿‡ã€Œå››æ¬¡æŒ¥æ‰‹ã€å…³é—­è¿æ¥ï¼› å¯é ä¼ è¾“ï¼šé€šè¿‡åºåˆ—å·ã€ç¡®è®¤åº”ç­”ï¼ˆACKï¼‰ã€é‡ä¼ æœºåˆ¶ä¿è¯æ•°æ®ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€æœ‰åºåˆ°è¾¾ï¼› å­—èŠ‚æµä¼ è¾“ï¼šæ— å›ºå®šåº”ç”¨å±‚æ ¼å¼ï¼Œä»…ä¼ è¾“è¿ç»­å­—èŠ‚æµï¼Œéœ€ä¸Šå±‚åè®®è‡ªå®šä¹‰æ•°æ®è¾¹ç•Œï¼› æ‹¥å¡æ§åˆ¶ï¼šé‡‡ç”¨æ…¢å¯åŠ¨ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ ã€å¿«æ¢å¤æ¥é˜²æ­¢ç½‘ç»œæ‹¥å¡ æ•°æ®ä¼ è¾“æ ¼å¼ TCP æœ¬èº«æ— å›ºå®šæŠ¥æ–‡æ ¼å¼ï¼Œéœ€å¼€å‘è€…è‡ªå®šä¹‰ã€Œæ¶ˆæ¯å¤´ + æ¶ˆæ¯ä½“ã€åŒºåˆ†æ•°æ®è¾¹ç•Œï¼ˆè§£å†³å­—èŠ‚æµç²˜åŒ… &#x2F; æ‹†åŒ…é—®é¢˜ï¼‰ï¼š 123// è‡ªå®šä¹‰TCPæŠ¥æ–‡ç»“æ„ï¼ˆé€šç”¨è®¾è®¡ï¼‰1. æ¶ˆæ¯å¤´ï¼ˆå›ºå®šé•¿åº¦ï¼‰ï¼š4å­—èŠ‚ï¼ˆæ¶ˆæ¯æ€»é•¿åº¦ï¼‰ + 2å­—èŠ‚ï¼ˆæ¶ˆæ¯ç±»å‹ï¼‰ + 1å­—èŠ‚ï¼ˆç‰ˆæœ¬å·ï¼‰2. æ¶ˆæ¯ä½“ï¼ˆå¯å˜é•¿åº¦ï¼‰ï¼šå®é™…ä¼ è¾“çš„ä¸šåŠ¡æ•°æ®ï¼ˆé•¿åº¦ç”±æ¶ˆæ¯å¤´æŒ‡å®šï¼‰ ä½¿ç”¨åœºæ™¯ éœ€è‡ªå®šä¹‰åè®®çš„é«˜æ€§èƒ½åœºæ™¯ï¼ˆå¦‚æ¸¸æˆæœåŠ¡å™¨ã€ç‰©è”ç½‘è®¾å¤‡ï¼‰ ä½œä¸º HTTP&#x2F;HTTPS&#x2F;WebSocket çš„åº•å±‚ä¼ è¾“åŸºç¡€ï¼› Http åè®®Http æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šä¿¡çš„åè®®ã€‚ä¸€ä¸ªå®Œæ•´çš„ Http è¯·æ±‚åŒ…å«ï¼š 1231. è¯·æ±‚è¡Œï¼šæ–¹æ³• + URL + åè®®ç‰ˆæœ¬2. è¯·æ±‚å¤´ï¼šå…ƒæ•°æ®3. è¯·æ±‚ä½“ï¼šå®é™…ä¼ è¾“çš„æ•°æ®ï¼ˆGET è¯·æ±‚é€šå¸¸æ²¡æœ‰ï¼‰ åº”ç”¨å±‚åè®®ï¼ŒHttp 1.0 é»˜è®¤æ˜¯çŸ­è¿æ¥ï¼Œ1.1 å°±å˜æˆäº†é»˜è®¤çš„é•¿è¿æ¥ï¼ˆæ ¸å¿ƒæ”¹è¿›ï¼‰ Http è¯·æ±‚å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸€èˆ¬æ¥è¯´å¯ä»¥ç”¨ url æ¥æ„é€  http è¯·æ±‚ï¼ˆContent-Type&#x2F;Content-Length è¿™ç§æ²¡åœ¨ url é‡Œé¢çš„å°±æ‰‹åŠ¨è®¾ç½®ï¼‰ï¼š 123456789101112131415161718&lt;!-- è¯·æ±‚è¡Œ --&gt;POST /api/orders HTTP/1.1 &lt;!-- è¯·æ±‚å¤´ --&gt; Host: api.shop.comContent-Type: application/jsonAuthorization: Bearer token123User-Agent: MyApp/1.0Content-Length: 87&lt;!-- è¯·æ±‚ä½“ Json æ ¼å¼ --&gt; &#123; &quot;productId&quot;: &quot;12345&quot;, &quot;quantity&quot;: 2, &quot;customer&quot;: &#123; &quot;name&quot;: &quot;å¼ ä¸‰&quot;, &quot;address&quot;: &quot;åŒ—äº¬å¸‚&quot; &#125;&#125; Http å“åº”ï¼š 123456789101112&lt;!-- å“åº”è¡Œ --&gt;HTTP/1.1 201 Created&lt;!-- å“åº”å¤´ --&gt;Content-Type: application/jsonDate: Mon, 23 Oct 2023 10:00:00 GMT&lt;!-- å“åº”å¤´ --&gt;&#123; &quot;id&quot;: &quot;order_67890&quot;, &quot;status&quot;: &quot;created&quot;, &quot;createdAt&quot;: &quot;2023-10-23T10:00:00Z&quot;&#125; è¯·æ±‚ç±»å‹ Get- è·å–æ•°æ® 12GET /api/users/123 HTTP/1.1Host: example.com ç”¨äºè·å–æœåŠ¡å™¨çš„èµ„æº Post - åˆ›å»ºæ•°æ® 12345POST /api/users HTTP/1.1Host: example.comContent-Type: application/json&#123;&quot;name&quot;: &quot;å¼ ä¸‰&quot;, &quot;email&quot;: &quot;zhang@example.com&quot;&#125; ç”¨äºåœ¨æœåŠ¡å™¨å½“ä¸­åˆ›å»ºæ–°èµ„æº PUTï¼šæ›´æ–°å®Œæ•´èµ„æº Delete: åˆ é™¤èµ„æº Https åè®®HTTPS æ˜¯ã€ŒHTTP + TLS&#x2F;SSL åŠ å¯†ã€çš„ç»„åˆåè®®ï¼Œæœ¬è´¨æ˜¯åŠ å¯†ç‰ˆçš„ HTTPï¼ŒåŸºäº TCP ä¼ è¾“ï¼Œæ ¸å¿ƒè§£å†³ HTTP æ˜æ–‡ä¼ è¾“çš„å®‰å…¨é—®é¢˜ï¼ˆé˜²çªƒå¬ã€é˜²ç¯¡æ”¹ã€é˜²å†’å……ï¼‰ã€‚ åº”ç”¨å±‚åè®®ï¼ŒHttp 1.0 é»˜è®¤æ˜¯çŸ­è¿æ¥ï¼Œ1.1 å°±å˜æˆäº†é»˜è®¤çš„é•¿è¿æ¥ï¼ˆæ ¸å¿ƒæ”¹è¿›ï¼‰ æ ¸å¿ƒç‰¹æ€§ åŠ å¯†ä¼ è¾“ï¼šé€šè¿‡ TLS&#x2F;SSL å¯¹ HTTP æ•°æ®åŠ å¯†ï¼Œä¼ è¾“è¿‡ç¨‹ä¸­æ— æ³•è¢«ç ´è§£ï¼› èº«ä»½éªŒè¯ï¼šé€šè¿‡æ•°å­—è¯ä¹¦éªŒè¯æœåŠ¡å™¨åˆæ³•æ€§ï¼Œé˜²æ­¢è®¿é—®é’“é±¼ç½‘ç«™ï¼› å…¼å®¹ HTTPï¼šè¯·æ±‚ &#x2F; å“åº”æ ¼å¼ä¸ HTTP ä¸€è‡´ï¼Œä»…å¢åŠ  TLS åŠ å¯†å±‚ï¼› åŸºäº TCPï¼šå…ˆå®Œæˆ TCP ä¸‰æ¬¡æ¡æ‰‹ï¼Œå†å®Œæˆ TLS æ¡æ‰‹ï¼Œæœ€åä¼ è¾“åŠ å¯†æ•°æ®ï¼› é»˜è®¤ç«¯å£ï¼š443ï¼ˆHTTP é»˜è®¤ 80ï¼‰ã€‚ TLS æ¡æ‰‹æ ¸å¿ƒæµç¨‹ å®¢æˆ·ç«¯å‘é€ï¼šTLS ç‰ˆæœ¬ã€åŠ å¯†å¥—ä»¶åˆ—è¡¨ã€éšæœºæ•°ï¼› æœåŠ¡å™¨è¿”å›ï¼šæ•°å­—è¯ä¹¦ã€é€‰å®šçš„åŠ å¯†å¥—ä»¶ã€éšæœºæ•°ï¼› å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦ï¼Œç”Ÿæˆã€Œé¢„ä¸»å¯†é’¥ã€å¹¶åŠ å¯†å‘é€ç»™æœåŠ¡å™¨ï¼› åŒæ–¹åŸºäºéšæœºæ•° + é¢„ä¸»å¯†é’¥ç”Ÿæˆã€Œä¼šè¯å¯†é’¥ã€ï¼› ç¡®è®¤åŠ å¯†é€šé“å»ºç«‹ï¼Œåç»­ HTTP æ•°æ®å‡ç”¨ä¼šè¯å¯†é’¥åŠ å¯†ã€‚ Https è¯·æ±‚&#x2F;å“åº”ç¤ºä¾‹ HTTPS æŠ¥æ–‡ç»“æ„ä¸ HTTP ä¸€è‡´ï¼Œä»…ä¼ è¾“è¿‡ç¨‹ä¸ºå¯†æ–‡ï¼Œä»¥ä¸‹æ˜¯ã€Œæ˜æ–‡è§†è§’ã€çš„ç¤ºä¾‹ï¼š è¯·æ±‚ï¼š 12345678910111213&lt;!-- è¯·æ±‚è¡Œ --&gt;POST /api/pay HTTP/1.1&lt;!-- è¯·æ±‚å¤´ï¼ˆæ˜æ–‡ä¼ è¾“ï¼Œç”¨äºTLSæ¡æ‰‹å’ŒåŸºç¡€æ ‡è¯†ï¼‰ --&gt;Host: pay.example.comContent-Type: application/jsonContent-Length: 78User-Agent: MyApp/1.0&lt;!-- è¯·æ±‚ä½“ï¼ˆä¼ è¾“æ—¶ä¸ºå¯†æ–‡ï¼Œæ˜æ–‡å¦‚ä¸‹ï¼‰ --&gt;&#123; &quot;orderId&quot;: &quot;order_67890&quot;, &quot;amount&quot;: 99.00, &quot;payType&quot;: &quot;wechat&quot;&#125; å“åº”ï¼š 12345678910HTTP/1.1 200 OKContent-Type: application/jsonDate: Mon, 23 Oct 2023 10:05:00 GMTContent-Length: 65&lt;!-- å“åº”ä½“ï¼ˆä¼ è¾“æ—¶ä¸ºå¯†æ–‡ï¼Œæ˜æ–‡å¦‚ä¸‹ï¼‰ --&gt;&#123; &quot;payId&quot;: &quot;pay_123456&quot;, &quot;status&quot;: &quot;success&quot;, &quot;payTime&quot;: &quot;2023-10-23T10:05:00Z&quot;&#125; æ•°æ®åŠ å¯†é¿å…è¯·æ±‚ &#x2F; å“åº”è¢«ä¸­é—´äººçªƒå¬ WebSocketWebSocket æ˜¯åº”ç”¨å±‚çš„åŒå‘å®æ—¶é€šä¿¡åè®®ï¼ŒåŸºäº TCP æ„å»ºï¼Œé€šè¿‡ HTTP æ¡æ‰‹å‡çº§ä¸ºæŒä¹…åŒ–é•¿è¿æ¥ï¼Œæ ¸å¿ƒè§£å†³ HTTPã€Œå®¢æˆ·ç«¯ä¸»åŠ¨è¯·æ±‚ã€æœåŠ¡ç«¯è¢«åŠ¨å“åº”ã€çš„å•å‘é€šä¿¡é™åˆ¶ã€‚ åº”ç”¨å±‚åè®®ï¼Œé»˜è®¤ä¸”å”¯ä¸€çš„ä½¿ç”¨æ–¹å¼æ˜¯é•¿è¿æ¥ æ ¸å¿ƒç‰¹æ€§ åŒå‘é€šä¿¡ï¼šè¿æ¥å»ºç«‹åï¼Œå®¢æˆ·ç«¯ &#x2F; æœåŠ¡å™¨å¯ä¸»åŠ¨ã€å®æ—¶å‘é€æ•°æ®ï¼ˆå…¨åŒå·¥ï¼‰ï¼› æŒä¹…åŒ–é•¿è¿æ¥ï¼šä¸€æ¬¡æ¡æ‰‹åè¿æ¥ä¿æŒï¼Œç›´åˆ°ä¸»åŠ¨å…³é—­ï¼ˆæ— éœ€é‡å¤å»ºç«‹ TCP è¿æ¥ï¼‰ï¼› è½»é‡çº§ï¼šæ•°æ®å¸§æ ¼å¼ç®€æ´ï¼Œæ—  HTTP å†—ä½™å¤´ä¿¡æ¯ï¼Œä¼ è¾“å¼€é”€è¿œä½äº HTTPï¼› åŸºäº HTTP æ¡æ‰‹ï¼šé¦–æ¬¡è¿æ¥å…¼å®¹ç°æœ‰ HTTP æœåŠ¡å™¨ï¼Œä¾¿äºç©¿é€é˜²ç«å¢™ï¼› é»˜è®¤ç«¯å£ï¼š80ï¼ˆWebSocketï¼‰&#x2F;443ï¼ˆWSSï¼ŒåŠ å¯†ç‰ˆ WebSocketï¼‰ã€‚ é€šä¿¡æµç¨‹ å®¢æˆ·ç«¯å‘é€ HTTP å‡çº§è¯·æ±‚ï¼ˆæ¡æ‰‹ï¼‰ï¼› æœåŠ¡å™¨å“åº”å‡çº§ç¡®è®¤ï¼Œè¿æ¥è½¬ä¸º WebSocketï¼› åŒæ–¹é€šè¿‡ WebSocket å¸§åŒå‘ä¼ è¾“æ•°æ®ï¼› ä»»æ„ä¸€æ–¹å‘é€å…³é—­å¸§ï¼Œç»“æŸè¿æ¥ã€‚ æŠ¥æ–‡æ ¼å¼ç¤ºä¾‹ WebSocket æ¡æ‰‹è¯·æ±‚ï¼ˆå®¢æˆ·ç«¯ -&gt; æœåŠ¡å™¨ï¼‰ï¼š 1234567GET /ws/chat HTTP/1.1Host: chat.example.comUpgrade: websocket &lt;!-- æ ¸å¿ƒï¼šè¯·æ±‚å‡çº§ä¸ºWebSocket --&gt;Connection: Upgrade &lt;!-- ç¡®è®¤è¿æ¥å‡çº§ --&gt;Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ== &lt;!-- éšæœºå¯†é’¥ï¼Œç”¨äºéªŒè¯ --&gt;Sec-WebSocket-Version: 13 &lt;!-- å›ºå®šç‰ˆæœ¬ --&gt;User-Agent: MyChatApp/1.0 WebSocket æ¡æ‰‹å“åº” 1234HTTP/1.1 101 Switching Protocols &lt;!-- 101çŠ¶æ€ç è¡¨ç¤ºåè®®åˆ‡æ¢ --&gt;Upgrade: websocketConnection: UpgradeSec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo= &lt;!-- å¯†é’¥éªŒè¯ç»“æœ --&gt; WebSocket æ•°æ®å¸§ 12345// å®¢æˆ·ç«¯å‘é€æ–‡æœ¬å¸§&#123;&quot;type&quot;:&quot;chat&quot;,&quot;content&quot;:&quot;ä½ å¥½ï¼ŒæœåŠ¡å™¨ï¼&quot;,&quot;userId&quot;:123&#125;// æœåŠ¡å™¨æ¨é€æ–‡æœ¬å¸§&#123;&quot;type&quot;:&quot;broadcast&quot;,&quot;content&quot;:&quot;ç”¨æˆ·123å‘é€äº†æ–°æ¶ˆæ¯&quot;,&quot;time&quot;:&quot;2023-10-23 10:10:00&quot;&#125; ä½¿ç”¨åœºæ™¯ å®æ—¶èŠå¤©ï¼ˆç½‘é¡µç‰ˆå¾®ä¿¡ã€ç›´æ’­å¼¹å¹•ï¼‰ å®æ—¶æ•°æ®ç›‘æ§ï¼ˆè‚¡ç¥¨è¡Œæƒ…ã€ç‰©è”ç½‘è®¾å¤‡æ•°æ®æ¨é€ï¼‰","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://dxblacksmith.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[]},{"title":"é“¶è¡Œç§‘æŠ€å²—ä¸€è§ˆ","slug":"é“¶è¡Œç§‘æŠ€å²—ä¸€è§ˆ","date":"2026-01-21T13:56:44.643Z","updated":"2026-01-21T13:56:44.879Z","comments":true,"path":"2026/01/21/é“¶è¡Œç§‘æŠ€å²—ä¸€è§ˆ/","permalink":"https://dxblacksmith.github.io/2026/01/21/%E9%93%B6%E8%A1%8C%E7%A7%91%E6%8A%80%E5%B2%97%E4%B8%80%E8%A7%88/","excerpt":"","text":"é“¶è¡Œç§‘æŠ€å²—å·¥ä½œç±»å‹ é‡‘èç§‘æŠ€ å·¥ä½œå†…å®¹ä¸æ¶‰åŠæŠ€æœ¯ç›¸å…³å·¥ä½œï¼Œä¸»è¦å†™ææ–™ï¼Œé¡¹ç›®ç®¡ç†ï¼ˆç®—æ˜¯å¤§ç”²æ–¹ï¼‰ å²—ä½é›†ä¸­åœ¨æ€»è¡Œï¼Œçœè¡Œæœ‰å°‘æ•°å²—ä½ è½¯ä»¶å¼€å‘ å…¸å‹çš„å¼€å‘ï¼ˆå‰åç«¯ï¼Œæµ‹è¯•ç­‰äº§å“å¼€å‘å·¥ä½œï¼‰ å²—ä½äºçœè¡Œï¼ˆæ¯”è¾ƒå°‘ï¼‰ï¼Œè½¯ä»¶ä¸­å¿ƒ&#x2F;ç ”å‘ä¸­å¿ƒï¼Œé‡‘ç§‘ï¼ˆå¤–åŒ…ï¼‰ ï¼Œéƒ½æœ‰å¼€æ”¾ æ•°æ®ä¸­å¿ƒè¿ç»´ å·¥ä½œå†…å®¹å’Œåå­—ç›¸åŒï¼Œå°±æ˜¯åšç³»ç»Ÿç»´æŠ¤çš„å·¥ä½œ å²—ä½äºçœè¡Œï¼Œæ•°æ®ä¸­å¿ƒï¼Œå¸‚åˆ†ç§‘æŠ€å²—éƒ½æœ‰å¼€æ”¾ Ps. é‡‘èç§‘æŠ€ &gt; è¿ç»´ &gt; æµ‹è¯• &gt; å¼€å‘ å·¥ä½œéƒ¨é—¨ T0 çº§ å…­å¤§å›½æœ‰è¡Œå’Œä¸‰å¤§æ”¿ç­–è¡Œæ€»è¡Œï¼Œå…­å¤§å›½æœ‰è¡Œå°±æ˜¯ä¸­å›½é“¶è¡Œã€ä¸­å›½å·¥å•†é“¶è¡Œã€ä¸­å›½å»ºè®¾é“¶è¡Œã€äº¤é€šé“¶è¡Œã€ä¸­å›½é‚®æ”¿å‚¨è“„é“¶è¡Œã€ä¸­å›½å†œä¸šé“¶è¡Œã€‚ ä¸‰å¤§æ”¿ç­–è¡Œå°±æ˜¯å›½å®¶å¼€æ”¾é“¶è¡Œã€ä¸­å›½è¿›å‡ºå£é“¶è¡Œã€ä¸­å›½å†œä¸šå‘å±•é“¶è¡Œã€‚æ€»è¡Œéƒ½åœ¨åŒ—äº¬ï¼Œæ¯‹åº¸ç½®ç–‘å¥½ï¼Œ T0 çº§åˆ« T0.5 çº§ äºŒçº¿åŸå¸‚åœ°ä½é«˜ï¼Œå¾…é‡å¥½ï¼Œäººæ°‘é“¶è¡Œå’Œå…¬åŠ¡å‘˜éƒ½å·®ä¸å¤šäº†ã€‚T0.5 çº§åˆ« å¤´éƒ¨åŸå•†è¡Œï¼ˆæˆéƒ½é“¶è¡Œï¼‰ã€è‚¡ä»½åˆ¶é“¶è¡Œï¼ˆæ‹›å•†é“¶è¡Œï¼‰çš„æ€»è¡Œï¼ˆåœ¨åœ°æ–¹æ¥è¯´ä¹Ÿç®—æ˜¯å¾…é‡éå¸¸å¥½çš„äº†ï¼‰ T1 çº§ å†œé‚®ï¼Œæ”¿ç­–è¡Œçš„ç›´å±ä¸­å¿ƒï¼ˆæ•°æ®ä¸­å¿ƒã€è½¯å¼€ä¸­å¿ƒã€ç ”å‘ä¸­å¿ƒï¼‰ å·¥å†œå»ºçš„çœè¡Œç§‘æŠ€å²—ã€ç®¡åŸ¹å²—ï¼Œæ²¡æœ‰ç›´å±ä¸­å¿ƒå¾…é‡é‚£ä¹ˆå¥½ï¼Œä½†æ˜¯ä¹Ÿæ²¡é‚£ä¹ˆå· T2 çº§ ä¸­äº¤ç›´å±ä¸­å¿ƒ ä¸­äº¤é‚®çœè¡Œç§‘æŠ€å²—ï¼ˆçœŸç§‘æŠ€ï¼‰ æ‹›å•†åˆ†è¡Œï¼Œåœ°æ–¹åŸå•†è¡Œæ€»è¡Œï¼Œå†œå•†è¡Œåˆ†è¡Œ T3 çº§ é‡‘ç§‘å…¬å¸ï¼Œæ‹›é“¶ç½‘ç»œã€æ°‘ç”Ÿç§‘æŠ€ç­‰é“¶è¡Œå­å…¬å¸ åœ°æ–¹åŸå•†åˆ†è¡Œï¼Œå†œå•†è¡Œåˆ†è¡Œç­‰ç­‰ å¸‚åˆ†è¡Œåå°ï¼Œè¥é”€ç­‰ï¼ˆæŸœå‘˜ç­‰ç­‰ï¼‰ å¤‡è€ƒå»ºè®®graph LR ç½‘ç”³ --&gt; ç¬”è¯• --&gt; æœºè¯• --&gt; æ— é¢†å¯¼è®¨è®º --&gt; åŠç»“æ„é¢è¯• ç½‘ç”³ï¼šæ³¨æ„æå‰æ‰¹ï¼Œæ ¹æ®å­¦å†ä¾‹è¡ŒæŠ•é€’ ç¬”è¯•ï¼šæå‰åœ¨ App ä¸Šåˆ·é¢˜ï¼Œ2 h èƒ½åšå®Œå°±è¡Œ æœºè¯•ï¼šç›´å±ä¸­å¿ƒä¸€èˆ¬éƒ½è¦æœºè¯•ï¼Œhot100 éš¾åº¦ï¼ˆå¯èƒ½æ²¡æœ‰ï¼‰ æ— é¢†å¯¼è®¨è®ºï¼šå‡†å¤‡ä¸€ä¸‹ï¼Œæ”¿ç­–è¡Œã€ç®¡åŸ¹ã€çœè¡Œéƒ½æœ‰è¿™ä¸ªç¯èŠ‚ï¼ˆå¯èƒ½æ²¡æœ‰ï¼‰ åŠç»“æ„é¢è¯•ï¼šæ ¹æ®ä¸ªäººå±¥å†è¿›è¡Œæé—®","categories":[{"name":"è®¡ç®—æœºæ±‚èŒ","slug":"è®¡ç®—æœºæ±‚èŒ","permalink":"https://dxblacksmith.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%B1%82%E8%81%8C/"}],"tags":[]},{"title":"çƒ¤é¢ç­‹ Day 04","slug":"çƒ¤é¢ç­‹_Day04","date":"2026-01-16T08:08:00.930Z","updated":"2026-01-16T08:33:32.151Z","comments":true,"path":"2026/01/16/çƒ¤é¢ç­‹_Day04/","permalink":"https://dxblacksmith.github.io/2026/01/16/%E7%83%A4%E9%9D%A2%E7%AD%8B_Day04/","excerpt":"","text":"çƒ¤é¢ç­‹ Day 04å•ä¾‹æ¨¡å¼1. å•ä¾‹æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›å•ä¾‹æ¨¡å¼ï¼Ÿç­”ï¼šå•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæ—¨åœ¨ç¡®ä¿ä¸€ä¸ªç±»åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå½“ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œæä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹æ¥è·å–è¯¥å®ä¾‹ã€‚ æœ‰ä¸€èˆ¬çš„å•ä¾‹æ¨¡å¼ï¼ˆç”¨ static ä¿®é¥°æˆå‘˜å‡½æ•°å’Œ static çš„å±€éƒ¨å˜é‡ï¼‰ï¼Œé¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ï¼Œæ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼Œè¿˜æœ‰å°±æ˜¯ä¸ªäººæ¯”è¾ƒå¸¸ç”¨çš„ CRTP ï¼ˆå£°æ˜å•ä¾‹çš„é€šç”¨æ¨¡æ¿ç±»ï¼‰ 2. åˆ†åˆ«ä»‹ç»ä¸€ä¸‹è¿™å‡ ç§å•ä¾‹æ¨¡å¼ï¼Ÿ ä¸€èˆ¬å•ä¾‹æ¨¡å¼ï¼šé™æ€æˆå‘˜å‡½æ•° + é™æ€å±€éƒ¨å˜é‡ 1234567891011121314class Singleton &#123;public: static Singleton&amp; GetInstance() &#123; // é™æ€å±€éƒ¨å˜é‡åªä¼šè¢«åˆå§‹åŒ–ä¸€æ¬¡ static Singleton instance; return instance; &#125; ~Singleton() = default;private: Singleton() = default; Singleton(const Singleton&amp;) = delete; Singleton&amp; operator=(const Singleton&amp;) = delete;&#125;; é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ï¼šé™æ€æˆå‘˜æŒ‡é’ˆå˜é‡ + cpp æ–‡ä»¶å®šä¹‰ 1234567891011121314class Singleton &#123;public: ~Singleton() = default; static Singleton* GetInstance() &#123; if(instance == nullptr) instance = new Singleton(); return instance; &#125;private: static Singleton* instance; Singleton() = default; Singleton(const Singleton&amp;) = delete; Singleton&amp; operator=(const Singleton&amp;) = delete;&#125;; åŒæ—¶åœ¨ cpp æ–‡ä»¶ä¸­å®šä¹‰ instance å®ä¾‹ 1Singleton* Singleton::instance = Singleton::GetInstance(); æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ï¼š æ™ºèƒ½æŒ‡é’ˆ + once_flag 12345678910111213141516171819202122#include &lt;mutex&gt;#include &lt;memory&gt;class Singleton &#123;public: ~Singleton() = default; static std::shared_ptr&lt;Singleton&gt; GetInstance() &#123; static std::once_flag flag; // flag åº•å±‚é‡‡ç”¨äº†åŸå­æ€§çš„åŸç†ï¼Œç´§æ¥çš„çº¿ç¨‹å¦‚æœå‘ç°äº† flag å·²ç»è¢«åˆå§‹åŒ–ï¼Œ // å°±ä¸ä¼šæ‰§è¡Œ call_once åé¢çš„å¯è°ƒç”¨å¯¹è±¡ std::call_once(flag, []()&#123; // è¿™é‡Œä¸èƒ½ä½¿ç”¨ std::make_shared å› ä¸ºæ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„ï¼Œå¤–éƒ¨ä½œç”¨åŸŸæ— æ³•è®¿é—® instance = std::shared_ptr&lt;Singleton&gt;(new Singleton()); &#125;); return instance; &#125;private: static std::shared_ptr&lt;Singleton&gt; instance; Singleton() = default; Singleton(const Singleton&amp;) = delete; Singleton&amp; operator=(const Singleton&amp;) = delete;&#125;; 3. CRTP æ˜¯ä»€ä¹ˆï¼Ÿèƒ½ä¸èƒ½å®ç°ä¸€ä¸‹ï¼Ÿç­”ï¼šæ˜¯ä¸€ç§å°†æ´¾ç”Ÿç±»ä½œä¸ºæ¨¡æ¿å‚æ•°ä¼ é€’ç»™åŸºç±»çš„æŠ€æœ¯ï¼Œå³ä¸€ä¸ªç±»ç»§æ‰¿ä»¥è‡ªèº«ä¸ºæ¨¡æ¿å‚æ•°çš„åŸºç±»ã€‚ åŸºç±»ä»£ç ï¼š 123456789101112131415161718192021222324#include &lt;memory&gt;#include &lt;mutex&gt;template &lt;typename T&gt;class Singleton &#123;protected: Singleton() = default; Singleton(const Singleton&lt;T&gt;&amp; other) = delete; Singleton&amp; operator=(const Singleton&lt;T&gt;&amp; other) = delete; static std::shared_ptr&lt;T&gt; _instance;public: ~Singleton() = default; static std::shared_ptr&lt;T&gt; GetInstance() &#123; static std::once_flag flag; std::call_once(flag, [&amp;]()&#123; _instance = std::shared_ptr&lt;T&gt;(new T); &#125;); return _instance; &#125;&#125;;// æ³¨æ„æ¨¡æ¿ç±»çš„ static ä¸€å®šè¦åœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰template &lt;typename T&gt;std::shared_ptr&lt;T&gt; Singleton&lt;T&gt;::_instance = nullptr; æ´¾ç”Ÿç±»ä»£ç ï¼š 1234567class SingleNet : public Singleton&lt;SingleNet&gt; &#123;private: SingleNet() = default; friend class Singleton&lt;SingleNet&gt;;public: ~SingleNet() = default;&#125;; è§‚å¯Ÿè€…æ¨¡å¼1. ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿç­”ï¼šè§‚å¯Ÿè€…æ¨¡å¼ æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ã€‚å®ƒå®šä¹‰äº†å¯¹è±¡é—´çš„ä¸€ç§ ä¸€å¯¹å¤š çš„ä¾èµ–å…³ç³»ï¼Œä½¿å¾—æ¯å½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚ 2. ä½ è§‰å¾—é‡Œé¢çš„é‡ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ è§£è€¦ï¼šè¢«è§‚å¯Ÿè€…ï¼ˆSubjectï¼‰ä¸éœ€è¦çŸ¥é“è§‚å¯Ÿè€…ï¼ˆObserverï¼‰çš„å…·ä½“ç±»ï¼Œåªéœ€è¦çŸ¥é“å®ƒä»¬å®ç°äº†æŸä¸ªæ¥å£ã€‚ è§¦å‘è”åŠ¨ï¼šçŠ¶æ€æ”¹å˜è‡ªåŠ¨è§¦å‘è¡Œä¸ºï¼Œä¸éœ€è¦è½®è¯¢æ£€æŸ¥ã€‚ æŠ½è±¡ä¾èµ–ï¼šSubject ä¾èµ–äº Observer çš„æŠ½è±¡åŸºç±»ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ï¼ˆå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼‰ã€‚ 3. å®ç°ä¸€ä¸‹è§‚å¯Ÿè€…æ¨¡å¼å§123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566#include &lt;iostream&gt;#include &lt;vector&gt;#include &lt;memory&gt;#include &lt;mutex&gt;#include &lt;algorithm&gt;#include &lt;string&gt;// 1. æŠ½è±¡è§‚å¯Ÿè€…class Observer : public std::enable_shared_from_this&lt;Observer&gt; &#123;public: virtual ~Observer() = default; virtual void update(const std::string&amp; state) = 0;&#125;;// 2. è¢«è§‚å¯Ÿè€…ï¼ˆSubjectï¼‰class Subject &#123;public: // çº¿ç¨‹å®‰å…¨çš„è®¢é˜…ï¼šä½¿ç”¨ weak_ptr è®°å½•è§‚å¯Ÿè€… void attach(std::weak_ptr&lt;Observer&gt; observer) &#123; std::lock_guard&lt;std::mutex&gt; lock(_mtx); _observers.push_back(observer); &#125; // çŠ¶æ€æ›´æ–°å¹¶é€šçŸ¥ void setState(std::string state) &#123; std::vector&lt;std::shared_ptr&lt;Observer&gt;&gt; active_observers; &#123; std::lock_guard&lt;std::mutex&gt; lock(_mtx); _state = state; // éå†å¹¶æ£€æŸ¥ç”Ÿå‘½å‘¨æœŸ auto it = _observers.begin(); while (it != _observers.end()) &#123; // å°è¯•æå‡ä¸º shared_ptr if (auto obj = it-&gt;lock()) &#123; active_observers.push_back(obj); ++it; &#125; else &#123; // è§‚å¯Ÿè€…å·²é”€æ¯ï¼Œè‡ªåŠ¨æ¸…ç†ä»åˆ—è¡¨ä¸­å‰”é™¤ it = _observers.erase(it); &#125; &#125; &#125; // åœ¨é”å¤–è¿›è¡Œé€šçŸ¥ï¼Œé¿å…æ­»é”é£é™©åŠé•¿æ—¶é—´å ç”¨é” for (const auto&amp; obs : active_observers) &#123; obs-&gt;update(_state); &#125; &#125;private: std::string _state; std::vector&lt;std::weak_ptr&lt;Observer&gt;&gt; _observers; // æ ¸å¿ƒï¼šå¼±å¼•ç”¨ std::mutex _mtx; // æ ¸å¿ƒï¼šäº’æ–¥é”ä¿è¯çº¿ç¨‹å®‰å…¨&#125;;// 3. å…·ä½“è§‚å¯Ÿè€…ç¤ºä¾‹class Worker : public Observer &#123;public: Worker(std::string name) : _name(name) &#123;&#125; void update(const std::string&amp; state) override &#123; std::cout &lt;&lt; &quot;Worker &quot; &lt;&lt; _name &lt;&lt; &quot; received: &quot; &lt;&lt; state &lt;&lt; std::endl; &#125;private: std::string _name;&#125;; Inline å†…è”å‡½æ•°1. å†…è”å‡½æ•°çš„å®ç°æœºåˆ¶ï¼Ÿç­”ï¼šå†…è”å‡½æ•°æ˜¯å‘ç¼–è¯‘å™¨å‘å‡ºçš„ä¸€ä¸ªå»ºè®®ï¼Œè¯·æ±‚å°†å‡½æ•°è°ƒç”¨æ›¿æ¢ä¸ºå‡½æ•°ä½“æœ¬èº«ã€‚ ç›®çš„æ˜¯æ¶ˆé™¤å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼ˆå¦‚å‹æ ˆã€è·³è½¬ã€è¿”å›ç­‰ï¼‰ï¼Œå¯¹äºé¢‘ç¹è°ƒç”¨çš„å°å‡½æ•°æ€§èƒ½æå‡æ˜æ˜¾ã€‚ 2. ç¼–è¯‘å™¨ä¸€å®šä¼šå†…è”å—ï¼Ÿç­”ï¼šä¸ä¸€å®šä¼šå†…è”ã€‚ç¼–è¯‘å™¨ä¼šæ ¹æ®å¤æ‚çš„å¯å‘å¼ç®—æ³•è‡ªè¡Œå†³å®šã€‚ å¦‚æœå‡½æ•°è¿‡å¤§æˆ–è€…è¿‡äºå¤æ‚æˆ–è€…å‡½æ•°æ˜¯è™šå‡½æ•°ï¼ˆå†…è”æ˜¯ç¼–è¯‘æ—¶ç¡®å®šï¼Œè™šå‡½æ•°æ˜¯è¿è¡Œæ—¶ç¡®å®šçš„ï¼‰çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¼šæ‹’ç»å†…è”ã€‚åŒæ—¶ç°ä»£çš„ç¼–è¯‘å™¨éå¸¸èªæ˜ï¼Œå³ä½¿æ²¡æœ‰å†™ inline å…³é”®å­—ï¼Œåªè¦å®ƒè®¤ä¸ºæœ‰ç›Šä¸”ç¬¦åˆæ¡ä»¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨è¿›è¡Œä¼˜åŒ–å†…è”","categories":[{"name":"C++ é¢ç»","slug":"C-é¢ç»","permalink":"https://dxblacksmith.github.io/categories/C-%E9%9D%A2%E7%BB%8F/"}],"tags":[]},{"title":"çƒ¤é¢ç­‹ Day 03","slug":"çƒ¤é¢ç­‹_Day03","date":"2026-01-15T16:08:37.654Z","updated":"2026-01-18T09:20:10.912Z","comments":true,"path":"2026/01/16/çƒ¤é¢ç­‹_Day03/","permalink":"https://dxblacksmith.github.io/2026/01/16/%E7%83%A4%E9%9D%A2%E7%AD%8B_Day03/","excerpt":"","text":"çƒ¤é¢ç­‹ Day 03å¤šæ€ä¸è™šå‡½æ•°è¡¨ï¼š1. å¤šæ€çš„å®šä¹‰æ˜¯ä»€ä¹ˆï¼Ÿåˆ†ç±»æœ‰å“ªäº›ï¼Ÿç­”ï¼šå¤šæ€æ˜¯å…è®¸åŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨åœ¨è¿è¡Œæ—¶æ ¹æ®å®é™…æŒ‡å‘çš„å­ç±»å¯¹è±¡ç±»å‹ï¼Œè°ƒç”¨ç›¸åº”å­ç±»é‡å†™æ–¹æ³•çš„èƒ½åŠ›ã€‚ä¸»è¦åˆ†ä¸ºä¸¤ç±»ã€‚ é™æ€å¤šæ€ï¼ˆç¼–è¯‘æ—¶å¤šæ€ï¼‰ï¼šé€šè¿‡å‡½æ•°é‡è½½å’Œæ¨¡æ¿å®ç°ã€‚ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´å°±ç¡®å®šäº†è°ƒç”¨çš„å‡½æ•°ç‰ˆæœ¬ã€‚ åŠ¨æ€å¤šæ€ï¼ˆè¿è¡Œæ—¶å¤šæ€ï¼‰ï¼šé€šè¿‡è™šå‡½æ•°ï¼ˆVirtual Functionï¼‰å’Œç»§æ‰¿æ¥æ—¶å®ç°ã€‚ç¨‹åºåœ¨è¿è¡ŒæœŸé—´æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹æ¥å†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ã€‚ 2. è™šå‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿè™šå‡½æ•°è¡¨å’Œè™šå‡½æ•°æŒ‡é’ˆæœ‰ä»€ä¹ˆç”¨ï¼Ÿç­”ï¼šè™šå‡½æ•°æ˜¯å…è®¸åœ¨æ´¾ç”Ÿç±»ä¸­è¢«é‡å†™ã€å¹¶é€šè¿‡åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨å®ç°è¿è¡Œæ—¶å¤šæ€çš„å‡½æ•°ã€‚æ˜¯å®ç°åŠ¨æ€å¤šæ€çš„åŸºçŸ³ è™šå‡½æ•°è¡¨ï¼š æ¯ä¸ªæ‹¥æœ‰è™šå‡½æ•°çš„ç±»éƒ½æœ‰ä¸€ä¸ªè™šè¡¨ã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå­˜æ”¾è™šå‡½æ•°åœ°å€çš„æ•°ç»„ã€‚ è™šå‡½æ•°æŒ‡é’ˆï¼š æ¯ä¸ªå…·ä½“çš„å¯¹è±¡å®ä¾‹ä¸­éƒ½æœ‰ä¸€ä¸ªéšè—æŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥ç±»å¯¹åº”çš„è™šå‡½æ•°è¡¨ã€‚ å½“é€šè¿‡åŸºç±»æŒ‡é’ˆè°ƒç”¨è™šå‡½æ•°æ—¶ï¼Œç¨‹åºå…ˆé€šè¿‡å¯¹è±¡çš„è™šæŒ‡é’ˆæ‰¾åˆ°è™šå‡½æ•°è¡¨ï¼Œå†æ ¹æ®åç§»é‡æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°åœ°å€å¹¶æ‰§è¡Œï¼Œä»è€Œå®ç°åŠ¨æ€ç»‘å®šã€‚å³é€šè¿‡è™šæŒ‡é’ˆåœ¨è¿è¡Œæ—¶æŸ¥æ‰¾æ­£ç¡®çš„å‡½æ•°å®ç°ã€‚ 3. ç»§æ‰¿å…³ç³»ä¸­çš„è™šå‡½æ•°è¡¨æ˜¯ â€œæ‹·è´â€ è¿˜æ˜¯ â€œå…±äº«â€ï¼Ÿç­”ï¼šæ´¾ç”Ÿç±»ä¼šç»§æ‰¿åŸºç±»çš„è™šå‡½æ•°è¡¨ç»“æ„ï¼Œä½†ä¼šç”Ÿæˆä¸€ä»½å±äºè‡ªå·±çš„æ–°è¡¨ã€‚ ç»§æ‰¿ä¸æ‹·è´ï¼š æ´¾ç”Ÿç±»åˆ›å»ºæ—¶ï¼Œä¼šé¦–å…ˆæ‹·è´åŸºç±»çš„è™šè¡¨å†…å®¹åˆ°è‡ªå·±çš„æ–°è™šè¡¨ä¸­ã€‚ é‡å†™ï¼ˆOverrideï¼‰ï¼š å¦‚æœæ´¾ç”Ÿç±»é‡å†™äº†æŸä¸ªè™šå‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šç”¨æ´¾ç”Ÿç±»è‡ªå·±çš„å‡½æ•°åœ°å€ï¼Œ**è¦†ç›–ï¼ˆOverwriteï¼‰**æ‰æ–°è™šè¡¨ä¸­åŸæ¥åŸºç±»çš„å‡½æ•°åœ°å€ã€‚ æ–°å¢ï¼š å¦‚æœæ´¾ç”Ÿç±»å®šä¹‰äº†æ–°çš„è™šå‡½æ•°ï¼Œè¿™äº›åœ°å€ä¼šæŒ‰é¡ºåºæ·»åŠ åˆ°æ–°è™šè¡¨çš„æœ«å°¾ã€‚ ç»“è®ºï¼š åŸºç±»å’Œæ´¾ç”Ÿç±»æ‹¥æœ‰å„è‡ªç‹¬ç«‹çš„è™šå‡½æ•°è¡¨ï¼Œäº’ä¸å¹²æ‰°ã€‚ 4. ä¸‹é¢çš„ B å¯¹è±¡å å¤šå¤§çš„å†…å­˜ç©ºé—´ï¼Ÿ1234567891011121314151617181920class A &#123; char a; virtual void add1();&#125;class C &#123; char aa; virtual void add2();&#125;class B : public A, public C &#123; short a2; int a; short b; int c; char d; int sum(); virtual void add(); void add1(); void add2();&#125; ç­”ï¼šé¦–å…ˆä¸¤ä¸ªåŸºç¡€ï¼Œåˆ›å»ºä¸€ä¸ª B å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„å†…å­˜åˆ†å¸ƒæ˜¯æ€ä¹ˆæ ·çš„ã€‚æ„é€ ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡ï¼Œå®ƒçš„å†…å­˜å¸ƒå±€é‡Œé¢è‚¯å®šå­˜åœ¨åŸºç±»çš„å­å¯¹è±¡ï¼ˆä»¥åŠå…¶è™šæŒ‡é’ˆï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ![image-20251029202359749](E:\\Document\\Garbage\\Typora Files\\image-20251029202359749-1768492539172-1.png) å›¾ä¸­çš„ vptråˆ†åˆ«æŒ‡å‘è‡ªå·±ç±»çš„è™šå‡½æ•°è¡¨ï¼Œé€šå¸¸ä¸€ä¸ªç±»çš„è™šæŒ‡é’ˆæ”¾åœ¨å†…å­˜å¸ƒå±€çš„æœ€å‰é¢ï¼Œæ‰€ä»¥è¿™é‡Œ B çš„è™šæŒ‡é’ˆä¸€èˆ¬ä¼šæŠŠ A çš„è™šæŒ‡é’ˆç»™è¦†ç›–æ‰ã€‚ 12æ„é€ ä¸€ä¸ªå­ç±»å¯¹è±¡ï¼šé¦–å…ˆä¼šå…ˆå»æ„å»ºåŸºç±»çš„å¯¹è±¡å†…å®¹ï¼Œæ¯”å¦‚è¿™é‡Œçš„ A å’Œ Cï¼Œç„¶åå†æ„é€ è‡ªå·±çš„å†…å®¹ã€‚ææ„ä¸€ä¸ªå­ç±»å¯¹è±¡ï¼šå’Œæ„é€ ç›¸åï¼Œå…ˆæ‰§è¡Œè‡ªå·±çš„ææ„å‡½æ•°ï¼Œç„¶åå»æ‰§è¡ŒåŸºç±»çš„ææ„å‡½æ•°ã€‚ Question: é‚£è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœ A çš„ææ„å‡½æ•°æ˜¯è™šå‡½æ•°çš„è¯ï¼Œä¹‹å‰è¦†ç›–äº† A çš„è™šæŒ‡é’ˆï¼Œè¿™é‡Œå°±æ‰¾ä¸åˆ° A çš„è™šå‡½æ•°è¡¨ï¼Œé‚£ä¹ˆå¦‚ä½•ææ„ A çš„å†…å®¹å‘¢ï¼Ÿ ç­”æ¡ˆå°±æ˜¯ç¼–è¯‘å™¨ä¼šåœ¨è°ƒç”¨ B çš„è™šææ„å‡½æ•°çš„æ—¶å€™ï¼Œå°±æŠŠå¤´éƒ¨çš„è™šæŒ‡é’ˆé‡ç½®ä¸º A çš„äº†ï¼Œæ‰€ä»¥èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œã€‚ æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±æ˜ç™½äº†è§£å†³ä¸Šé¢é—®é¢˜æœ€é‡è¦çš„ä¸€ä¸ªç‚¹ï¼Œé‚£å°±æ˜¯ B çš„å†…å­˜ç©ºé—´ä¸€å®šä¼šç»§æ‰¿åŸºç±»çš„è™šæŒ‡é’ˆä»¥åŠåŸºç±»çš„ä¸€äº›æˆå‘˜å˜é‡ã€‚ é‚£ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜è¿˜éœ€è¦æ˜ç™½ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œé‚£å°±æ˜¯å†…å­˜å¯¹é½ã€‚å†…å­˜å¯¹é½çš„è§„åˆ™æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ ç±»çš„æ¯ä¸ªåŸºå‡†å†…å­˜å—å¤§å° &#x3D; ç±»å½“ä¸­å ç”¨å†…å­˜å¤§å°æœ€å¤§çš„æˆå‘˜å˜é‡çš„å†…å­˜ç©ºé—´ï¼Œæ¯”å¦‚è¿™é‡Œçš„ Aï¼Œè™½ç„¶æœ€å¤§çš„æˆå‘˜å˜é‡æ˜¯ 1 å­—èŠ‚ï¼Œä½†æ˜¯å®ƒå­˜åœ¨è™šå‡½æ•°ï¼Œæ‰€ä»¥å†…éƒ¨æœ‰è™šæŒ‡é’ˆã€‚åˆç”±äºè™šæŒ‡é’ˆæ˜¯ 8 å­—èŠ‚ï¼Œæ‰€ä»¥åŸºå‡†å†…å­˜å—å¤§å°å°±æ˜¯ 8 å­—èŠ‚ï¼Œæ‰€ä»¥è¿™é‡Œ A æ‰€å ç”¨æ˜¯ 8 + 8 &#x3D; 16 å­—èŠ‚ æ¯ä¸ªç±»å‹çš„èµ·å§‹åœ°å€éƒ½æ˜¯è¯¥ç±»å‹å¤§å°çš„æ•´æ•°å€ï¼Œæ¯”å¦‚ int çš„æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆå®ƒçš„èµ·å§‹åœ°å€åªæœ‰å¯èƒ½æ˜¯ 0, 4, 8, â€¦. æ˜ç™½äº†ä¸Šé¢çš„ä¸¤ä¸ªç‚¹ä»¥åï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹è¿™ä¸ªé—®é¢˜ï¼š é¦–å…ˆç”±äº A å’Œ C ä¸­å­˜åœ¨è™šå‡½æ•°ï¼ˆè™šæŒ‡é’ˆï¼‰çš„ç¼˜æ•…ï¼Œä»–ä»¬çš„å¤§å°éƒ½æ˜¯ 16 å­—èŠ‚ã€‚ç„¶åæˆ‘ä»¬çœ‹åˆ° B ä¸­è‡ªå·±çš„æˆå‘˜å˜é‡ï¼Œé¦–å…ˆ short ä¸€å®šæ˜¯åœ¨ 4 å­—èŠ‚çš„ï¼Œå› ä¸º short æœ¬èº«æ˜¯å  2 å­—èŠ‚çš„ï¼Œä½†æ˜¯ç”±äºå¯¹é½è§„åˆ™ 2 ï¼Œåç»­è·Ÿè¿›çš„ int çš„èµ·å§‹åœ°å€åªèƒ½æ˜¯ 4 çš„å€æ•°ï¼Œæ‰€ä»¥ 2 - 4 çš„ç©ºé—´ä¹Ÿæ˜¯åªèƒ½ç»™ short ï¼Œè¿™æ ·çš„è¯å°±æ˜¯ 16 + 16 + 16ï¼Œæœ€åè¿˜æœ‰ä¸€ä¸ª char ç±»å‹ï¼Œä¸è¿‡å› ä¸ºå¯¹é½è§„åˆ™ 1ï¼Œè¿™é‡Œåªèƒ½æ˜¯ä¹Ÿå ç”¨ 8 ä¸ªå­—èŠ‚ï¼Œæ‰€æœ‰æ€»å…±å ç”¨çš„å­—èŠ‚æ•°æ˜¯ 16 + 16 + 16 + 8 &#x3D; 56 ä¸ªå­—èŠ‚ã€‚ Http åè®®1. Http è¯·æ±‚çš„æ ¸å¿ƒéƒ¨åˆ†æœ‰å“ªäº›ï¼Ÿä¸€ä¸ªæ ‡å‡†çš„ HTTP è¯·æ±‚æŠ¥æ–‡ç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼š **è¯·æ±‚è¡Œï¼š**åŒ…å« Methodã€URLã€åè®®ç‰ˆæœ¬ **è¯·æ±‚å¤´ï¼š**é”®å€¼å¯¹ï¼Œæè¿°å®¢æˆ·ç«¯ç¯å¢ƒã€å‹ç¼©æ ¼å¼ï¼ŒæŒä¹…è¿æ¥ç­‰ï¼ˆHost, User-Agent, Connectionï¼‰ ç©ºè¡Œï¼š \\r\\nï¼Œç”¨äºåˆ†éš” Header å’Œ Bodyï¼Œè¿™æ˜¯åè®®æ ¼å¼çš„å¼ºåˆ¶è¦æ±‚ **è¯·æ±‚ä½“ï¼š**å¯é€‰ï¼Œé€šå¸¸ç”¨äº POST&#x2F;PUT æäº¤çš„æ•°æ® 2. Http1.1 å¸¸ç”¨ Method åŠ GET&#x2F;POST åŒºåˆ«ï¼Ÿå¸¸ç”¨ Methodï¼šGET, POSTï¼ŒPUTï¼ŒDELETEï¼ŒHEAD GET å’Œ POST çš„åŒºåˆ«ï¼š **è¯­ä¹‰ï¼š**GET å€¾å‘äºè·å–èµ„æºï¼Œæ˜¯å¹‚ç­‰çš„ï¼›POST å€¾å‘äºå¤„ç†èµ„æºï¼ˆåˆ›å»º&#x2F;ä¿®æ”¹ï¼‰ï¼Œæ˜¯éå¹‚ç­‰çš„ã€‚ **å‚æ•°ä½ç½®ï¼š**GET å‚æ•°æ”¾åœ¨ URL åé¢ï¼ŒPOST å‚æ•°é€šå¸¸æ”¾åœ¨ Request Body ä¸­ã€‚ **æ•°æ®å¤§å°ï¼š**GET å—é™äº URL é•¿åº¦ï¼ˆæµè§ˆå™¨&#x2F;æœåŠ¡å™¨é™åˆ¶ï¼‰ï¼›POST ç†è®ºä¸Šæ— é™åˆ¶ã€‚ 3. ä¸ºä»€ä¹ˆ GET è¯·æ±‚ä¸€èˆ¬æ²¡æœ‰è¯·æ±‚ä½“ï¼Ÿæœ‰ä¸‹é¢ä¸‰ç‚¹åŸå› ï¼š **è¯­ä¹‰å†²çªï¼š**GET çš„å®šä¹‰æ˜¯æ ¹æ® URL åŠå…¶å‚æ•°è·å–èµ„æºï¼Œå¼•å…¥ Body ä¼šç ´åè¿™ç§ç®€æ´çš„æ˜ å°„ã€‚ **ç¼“å­˜å…¼å®¹æ€§ï¼š**CDNã€ä»£ç†æœåŠ¡å™¨å’Œæµè§ˆå™¨é€šå¸¸åªæ ¹æ® URL ç¼“å­˜ GET è¯·æ±‚ã€‚å¦‚æœ Body å½±å“ç»“æœï¼Œè¿™äº›ç¼“å­˜æœºåˆ¶å°†å¤±æ•ˆã€‚ **æœåŠ¡å™¨å®ç°ï¼š**è®¸å¤š Web æœåŠ¡å™¨å’Œè§£æå™¨ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ï¼Œä¼šç›´æ¥å¿½ç•¥ GET è¯·æ±‚ä¸­çš„ Bodyã€‚ 4. HTTP&#x2F;1.1ã€HTTP&#x2F;2ã€HTTP&#x2F;3 çš„ä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ ç‰¹æ€§ HTTP&#x2F;1.1 HTTP&#x2F;2 HTTP&#x2F;3 ä¼ è¾“æ ¼å¼ æ–‡æœ¬ï¼ˆæ˜æ–‡ï¼‰ äºŒè¿›åˆ¶åˆ†å¸§ äºŒè¿›åˆ¶åˆ†å¸§ å¤šè·¯å¤ç”¨ æ— ï¼ˆæœ‰çº¿å¤´é˜»å¡ï¼‰ æ”¯æŒï¼ˆå•ä¸€è¿æ¥å¹¶å‘ï¼‰ æ”¯æŒ åº•å±‚åè®® TCP TCP UDP (QUIC) å¤´éƒ¨å‹ç¼© æ—  HPACK QPACK è¿æ¥å»ºç«‹ TCP æ¡æ‰‹ + TLS æ¡æ‰‹ åŒ 1.1 QUIC æ¡æ‰‹ï¼ˆ1-RTT&#x2F;0-RTTï¼‰ 5. HTTP æœ‰å“ªäº›å¸¸è§çš„çŠ¶æ€ç ï¼Ÿé¦–å…ˆæ˜¯åˆ†ç±»ï¼šHttp çŠ¶æ€å…± 5 å¤§ç±»ï¼Œé¦–ä½æ•°å­—ç•Œå®šç±»åˆ«ï¼š1xxï¼ˆä¿¡æ¯ï¼‰ã€2xxï¼ˆæˆåŠŸï¼‰ã€3xxï¼ˆé‡å®šå‘ï¼‰ã€4xxï¼ˆå®¢æˆ·ç«¯é”™è¯¯ï¼‰ã€5xxï¼ˆæœåŠ¡ç«¯é”™è¯¯ï¼‰ å…¶æ¬¡åˆ—ä¸¾ä¸€äº›é«˜é¢‘çš„çŠ¶æ€ç ï¼š 200ï¼ˆæˆåŠŸï¼‰ã€404ï¼ˆèµ„æºä¸å­˜åœ¨ï¼‰ã€500ï¼ˆæœåŠ¡å™¨é”™è¯¯ï¼‰ã€304ï¼ˆç¼“å­˜ï¼‰ã€401&#x2F;403ï¼ˆæƒé™ï¼‰ã€429ï¼ˆé™æµï¼‰","categories":[{"name":"C++ é¢ç»","slug":"C-é¢ç»","permalink":"https://dxblacksmith.github.io/categories/C-%E9%9D%A2%E7%BB%8F/"}],"tags":[]},{"title":"çƒ¤é¢ç­‹ Day 02","slug":"çƒ¤é¢ç­‹_Day02","date":"2026-01-14T07:13:34.486Z","updated":"2026-02-02T06:10:29.246Z","comments":true,"path":"2026/01/14/çƒ¤é¢ç­‹_Day02/","permalink":"https://dxblacksmith.github.io/2026/01/14/%E7%83%A4%E9%9D%A2%E7%AD%8B_Day02/","excerpt":"","text":"çƒ¤é¢ç­‹ Day 02 ç±»å‹è½¬æ¢1. å‘ä¸Šè½¬å‹ vs å‘ä¸‹è½¬å‹?è¿™æ˜¯å¤šæ€ä¸­ä¸¤ä¸ªæ–¹å‘å®Œå…¨ç›¸åçš„æ“ä½œï¼š å‘ä¸Šè½¬å‹ï¼š å®šä¹‰ï¼šå°†å­ç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢æˆçˆ¶ç±» å®‰å…¨æ€§ï¼šç»å¯¹å®‰å…¨ã€‚å› ä¸ºå­ç±»ä¹Ÿæ˜¯ä¸€ç§çˆ¶ç±» ç”¨æ³•ï¼šè¿™ç§è½¬æ¢æ˜¯éšå¼ï¼Œä¸éœ€è¦æ˜¾å¼è°ƒç”¨ static_cast ï¼Œæ˜¯å®ç°å¤šæ€çš„åŸºç¡€ å‘ä¸‹è½¬å‹ï¼š å®šä¹‰ï¼šå°†çˆ¶ç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢ä¸ºå­ç±»ã€‚ å®‰å…¨æ€§ï¼š ä¸å®‰å…¨ã€‚çˆ¶ç±»å¯¹è±¡ä¸ä¸€å®šæ˜¯å­ç±»ã€‚ ç”¨æ³•ï¼šå¿…é¡»ä½¿ç”¨æ˜¾å¼è½¬æ¢ï¼Œå‡ºäºå®‰å…¨ä¿è¯ä½¿ç”¨ dynamic_cast 2. static_cast ä¸ dynamic_cast çš„åŒºåˆ«ï¼Ÿæœ¬è´¨åŒºåˆ«åœ¨äº â€œè½¬æ¢å‘ç”Ÿçš„æ—¶æœºâ€ å’Œ â€œå®‰å…¨æ£€æŸ¥çš„æœºåˆ¶â€ static_castï¼š åœ¨ç¼–è¯‘é˜¶æ®µå®Œæˆï¼Œä¸è¿›è¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ ä¸»è¦ç”¨äºåŸºæœ¬ç±»å‹è½¬æ¢ï¼ˆå¦‚ int è½¬ floatï¼‰ï¼Œéå¤šæ€å±‚çº§ç»“æ„å†…çš„æŒ‡é’ˆ&#x2F;å¼•ç”¨è½¬æ¢ã€‚ dynamic_castï¼š åœ¨è¿è¡Œé˜¶æ®µåˆ©ç”¨ RTTIï¼ˆè¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ï¼‰ æ£€æŸ¥è½¬æ¢æ˜¯å¦åˆæ³• ä¸“é—¨ç”¨äºå¤„ç†**å¤šæ€ï¼ˆPolymorphismï¼‰**å±‚çº§ç»“æ„ä¸­çš„è½¬æ¢ 3. static_cast åœ¨ä»€ä¹ˆåœºæ™¯æœ‰é£é™©ï¼Ÿstatic_cast çš„é£é™©ä¸»è¦å‘ç”Ÿåœ¨ å‘ä¸‹è½¬å‹ï¼ˆDowncastingï¼‰ï¼Œå³æŠŠåŸºç±»æŒ‡é’ˆè½¬æ¢ä¸ºæ´¾ç”Ÿç±»æŒ‡é’ˆæ—¶ï¼š é£é™©ç‚¹ï¼š å¦‚æœè¯¥åŸºç±»æŒ‡é’ˆå®é™…ä¸Šå¹¶æ²¡æœ‰æŒ‡å‘é‚£ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡ï¼Œstatic_cast ä¾ç„¶ä¼šå¼ºè¡Œè½¬æ¢æˆåŠŸï¼Œè¿”å›ä¸€ä¸ªåœ°å€ã€‚ åæœï¼š å½“ä½ é€šè¿‡è¿™ä¸ªè½¬æ¢åçš„æŒ‡é’ˆè®¿é—®æ´¾ç”Ÿç±»ç‰¹æœ‰çš„æˆå‘˜å˜é‡æˆ–è™šå‡½æ•°æ—¶ï¼Œä¼šå‘ç”Ÿæœªå®šä¹‰è¡Œä¸ºï¼ˆUndefined Behaviorï¼‰ï¼Œé€šå¸¸è¡¨ç°ä¸ºå†…å­˜è¶Šç•Œè®¿é—®æˆ–ç¨‹åºå´©æºƒï¼Œä¸”è¿™ç§é”™è¯¯åœ¨ç¼–è¯‘æœŸæ— æ³•å¯Ÿè§‰ã€‚ 4. dynamic_cast çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿå®ƒçš„æ ¸å¿ƒä¼˜åŠ¿æ˜¯ â€œå®‰å…¨æ€§â€ï¼š ç±»å‹å®‰å…¨æ£€æŸ¥ï¼š å®ƒä¼šæ£€æŸ¥ç›®æ ‡ç±»å‹æ˜¯å¦ä¸å¯¹è±¡çš„å®é™…ç±»å‹åŒ¹é…ã€‚å¦‚æœè½¬æ¢éæ³•ï¼Œå¯¹äºæŒ‡é’ˆä¼šè¿”å› nullptrï¼Œå¯¹äºå¼•ç”¨ä¼šæŠ›å‡º std::bad_cast å¼‚å¸¸ã€‚ æ”¯æŒè™šç»§æ‰¿è½¬æ¢ï¼š åœ¨å¤æ‚çš„æ·±å±‚æˆ–è±å½¢ç»§æ‰¿ä¸­ï¼Œdynamic_cast èƒ½å¤Ÿæ­£ç¡®å¤„ç†æŒ‡é’ˆåç§»ã€‚ Reactor + çº¿ç¨‹æ± 1. Reactor æ¨¡å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼ŸReactor æ¨¡å¼æœ¬è´¨ä¸Šæ˜¯ â€œI&#x2F;O å¤ç”¨ + æ´¾å‘â€ï¼Œå…¶æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼š Event Demultiplexerï¼šåº•å±‚é€šå¸¸æ˜¯ epollæˆ–è€… poll ï¼Œç›‘å¬æ³¨å†Œäº†çš„ä¸€å †æ–‡ä»¶æè¿°ç¬¦æœ‰å“ªäº›åŠ¨é™ Reactorï¼šæ ¸å¿ƒå¾ªç¯ã€‚é€šè¿‡å¤šè·¯åˆ†ç¦»å™¨ç­‰å¾…äº‹ä»¶å‘ç”Ÿï¼Œä¸€æ—¦æœ‰äº‹ä»¶ï¼ˆå¦‚å¯è¯»ã€å¯å†™ï¼‰ï¼Œå°±å°†å…¶åˆ†å‘ï¼ˆDispatchï¼‰ç»™å¯¹åº”çš„ Handlerã€‚ Handlersï¼šç»‘å®šåœ¨äº‹ä»¶ä¸Šçš„å›è°ƒå‡½æ•°ï¼Œè´Ÿè´£éé˜»å¡çš„è¯»å†™æ“ä½œã€‚ 2. ä¸ºä»€ä¹ˆé‡‡ç”¨ä¸»ä» Reactor + çº¿ç¨‹æ± ï¼Ÿä¸»è¦æ˜¯ä¸ºäº†è§£å†³å•çº¿ç¨‹ Reactor çš„æ€§èƒ½ç“¶é¢ˆï¼š åˆ†å·¥æ˜ç¡®ï¼šMain Reactor åªè´Ÿè´£ç›‘å¬è¿æ¥ï¼ˆAcceptï¼‰ï¼ŒSub Reactor è´Ÿè´£å¤„ç†å·²è¿æ¥å¥—æ¥å­—çš„ I&#x2F;O äº‹ä»¶ã€‚è¿™é¿å…äº†å› ä¸ºæŸä¸ªè¯·æ±‚çš„ I&#x2F;O è€—æ—¶è¿‡é•¿å¯¼è‡´æ–°è¿æ¥æ— æ³•è¿›å…¥ã€‚ å……åˆ†åˆ©ç”¨å¤šæ ¸ï¼š å¤šä¸ª Sub Reactor å¯ä»¥è¿è¡Œåœ¨ä¸åŒçš„ CPU æ ¸å¿ƒä¸Šï¼Œå¹¶è¡Œå¤„ç† I&#x2F;Oã€‚ è§£è€¦è®¡ç®—ï¼šçº¿ç¨‹æ±  å°†ä¸šåŠ¡è®¡ç®—é€»è¾‘ä» I&#x2F;O çº¿ç¨‹ä¸­å‰¥ç¦»ã€‚å¦‚æœä¸šåŠ¡é€»è¾‘è€—æ—¶è¾ƒé•¿ï¼Œå®ƒä¸ä¼šé˜»å¡ I&#x2F;O äº‹ä»¶çš„åˆ†å‘ï¼Œä»è€Œæå¤§æé«˜äº†ç³»ç»Ÿçš„ååé‡ã€‚ accept() ä»…éœ€å†…æ ¸æ‹·è´ socket æè¿°ç¬¦ï¼ˆè½»é‡é«˜é¢‘æ“ä½œï¼‰ï¼Œå•çº¿ç¨‹ BossGroup è¶³ä»¥åº”å¯¹ä¸‡çº§è¿æ¥è¯·æ±‚ã€‚å¦‚æœæ˜¯å¤šçº¿ç¨‹ç«äº‰é”ï¼Œåè€Œä¼šé™ä½æ•ˆç‡ã€‚IO äº‹ä»¶æ˜¯é‡é‡çº§æ“ä½œï¼Œæ¶‰åŠæ•°æ®è¯»å†™ï¼Œä¸šåŠ¡é€»è¾‘ï¼Œå¯èƒ½é˜»å¡ï¼ˆæ•°æ®åº“æŸ¥è¯¢ï¼‰ã€‚WorkGroup å¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸ CPUã€‚ Ps. è¿™é‡Œçš„ I&#x2F;O çº¿ç¨‹å¤„ç†çš„æ˜¯ I&#x2F;O è¯»å†™ï¼ŒæŒ‡çš„æ˜¯ä»ç½‘å¡é©±åŠ¨ç¼“å­˜æ‹·è´åˆ°ç”¨æˆ·ç¼“å­˜åŒºï¼Œæˆ–è€…å°†ç”¨æˆ·æ€æ•°æ®æ‹·è´åˆ°å†…æ ¸å‘é€ç¼“å­˜åŒºã€‚ä¸šåŠ¡è®¡ç®—é€»è¾‘åˆ™æ˜¯åŠ å·¥æ•°æ®ï¼ˆæ•°æ®è¯»ä¸Šæ¥ä»¥åï¼Œç¨‹åºéœ€è¦å¤„ç†å®ƒï¼‰ï¼Œä¾‹å¦‚åè®®è§£æï¼ˆäºŒè¿›åˆ¶æµè§£åŒ…æˆ Protobuf æˆ– JSONï¼‰ï¼Œæ•°æ®åº“æŸ¥è¯¢ï¼ˆæ ¹æ®è¯·æ±‚å·® SQLï¼‰ç­‰ç­‰ 3. ä» Reactor è¯»åˆ°çš„æ•°æ®å¦‚ä½•ä¼ é€’ç»™çº¿ç¨‹æ± ï¼Ÿèƒ½ä¸èƒ½å®ç°ä¸€ä¸‹ï¼Ÿæ˜¯é€šè¿‡ä»»åŠ¡é˜Ÿåˆ—æ¥å®ç°çš„ã€‚Sub Reactor å°† ï¼ˆæ•°æ®ï¼Œå¤„ç†å‡½æ•°ï¼‰å°è£…æˆä»»åŠ¡ä¸¢è¿›é˜Ÿåˆ—ï¼Œçº¿ç¨‹æ± é‡Œçš„ worker çº¿ç¨‹é€šè¿‡ç«äº‰æ¥è·å–ä»»åŠ¡ã€‚ çº¿ç¨‹å®‰å…¨çš„ä»»åŠ¡é˜Ÿåˆ—é€šå¸¸æœ‰ä½¿ç”¨æ¡ä»¶å˜é‡çš„é˜»å¡é˜Ÿåˆ—å’Œæ— é”é˜Ÿåˆ—ã€‚ é˜»å¡é˜Ÿåˆ—ï¼š 1234567891011121314151617181920212223242526272829303132333435363738#include &lt;mutex&gt;#include &lt;condition_variable&gt;#include &lt;queue&gt;template &lt;typename T&gt;class BlockQueue &#123;public: bool push(const T&amp; val) &#123; std::lock_guard lock(mtx_); if (stop_) return false; // é˜Ÿåˆ—å·²åœæ­¢ï¼Œè¿”å›false que_.push(val); cv_.notify_one(); return true; &#125; bool pop(T&amp; val) &#123; std::unique_lock lock(mtx_); cv_.wait(lock, [this]()&#123; return stop_ || !que_.empty(); &#125;); if(stop_ &amp;&amp; que_.empty()) return false; val = que_.front(); que_.pop(); return true; &#125; void stop() &#123; &#123; std::lock_guard lock(mtx_); stop_ = true; &#125; cv_.notify_all(); &#125;private: std::condition_variable cv_; std::queue&lt;T&gt; que_; std::mutex mtx_; bool stop_ = false;&#125;; æ— é”é˜Ÿåˆ—ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970#include &lt;atomic&gt;#include &lt;cstdio&gt;/** push: å…ˆæ£€æŸ¥å°¾éƒ¨çš„ä¸€è‡´æ€§, tail-&gt;next = new_node, tail = new_nodeï¼ˆç”¨ CAS ç‰ˆæœ¬å®ç°ï¼‰* popï¼šå…ˆæ£€æŸ¥å¤´éƒ¨çš„ä¸€è‡´æ€§ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©º tail = tail-&gt;next, ä¸ä¸ºç©º head = head-&gt;next*/template &lt;typename T&gt;class LockFreeQueue &#123;public: LockFreeQueue(); ~LockFreeQueue(); void push(const T&amp; value) &#123; Node* newNode = new Node(value); while(true) &#123; Node* current_tail = tail.load(); Node* next = current_tail-&gt;next.load(); // ä¸€è‡´æ€§æ£€æŸ¥ if(tail.load() == current_tail) &#123; // tail æ˜¯çœŸæ­£çš„å°¾éƒ¨ if(next == nullptr) &#123; // ä¸€è‡´æ€§æ£€æŸ¥ if(current_tail-&gt;next.compare_exchange_weak(next, newNode)) &#123; // è¿›è¡Œæ›´æ–° tail.compare_exchange_weak(current_tail, newNode); return; &#125; &#125; else &#123; tail.compare_exchange_weak(current_tail, next); &#125; &#125; &#125; &#125; bool pop(T&amp; result) &#123; while(true) &#123; Node* current_head = head.load(); Node* current_tail = tail.load(); Node* next = current_head-&gt;next.load(); if(current_head == head.load()) &#123; // é˜Ÿåˆ—æœ‰å¯èƒ½ä¸ºç©º if(current_head == current_tail) &#123; if(next == nullptr) return false; // è¿›è¡Œæ›´æ–° tail = tail-&gt;next tail.compare_exchange_weak(current_tail, next); &#125; else &#123; result = next-&gt;data; if(head.compare_exchange_weak(current_head, next)) &#123; delete current_head; return true; &#125; &#125; &#125; &#125; &#125;private: struct Node &#123; T data; std::atomic&lt;Node*&gt; next; Node(const T&amp; val) : data(val), next(nullptr) &#123;&#125; &#125;; std::atomic&lt;Node*&gt; head; std::atomic&lt;Node*&gt; tail;&#125;; 4. CPU å¯†é›†å‹å’Œ I&#x2F;O å¯†é›†å‹æ€ä¹ˆåˆ¤æ–­ï¼Ÿä¸»è¦æ˜¯çœ‹ç“¶é¢ˆåœ¨å“ªé‡Œï¼š$N_{cpu}$ æ˜¯ CPU æ ¸å¿ƒæ•°çš„æ„æ€ CPU å¯†é›†å‹ï¼š ç‰¹ç‚¹ï¼šå¤§éƒ¨åˆ†æ—¶é—´åœ¨åšå¤æ‚çš„è¿ç®—ï¼ˆå›¾åƒå¤„ç†ã€ç§‘å­¦è®¡ç®—ï¼‰ åˆ¤æ–­ï¼š ç¨‹åºè¿è¡Œæ—¶ï¼ŒCPU å ç”¨ç‡æé«˜ï¼Œä½†å‡ ä¹æ²¡æœ‰ç£ç›˜æˆ–ç½‘ç»œ I&#x2F;Oã€‚ çº¿ç¨‹æ± ç­–ç•¥ï¼š çº¿ç¨‹æ•°é€šå¸¸è®¾ç½®ä¸º $N_{CPU} + 1$ã€‚ I&#x2F;O å¯†é›†å‹ï¼š ç‰¹ç‚¹ï¼š å¤§éƒ¨åˆ†æ—¶é—´åœ¨ç­‰å¾…ç£ç›˜è¯»å†™ã€æ•°æ®åº“æŸ¥è¯¢ã€ç½‘ç»œå“åº”ã€‚ åˆ¤æ–­ï¼š CPU å ç”¨ç‡è¾ƒä½ï¼Œç³»ç»Ÿå¤§é‡æ—¶é—´å¤„äºç­‰å¾…çŠ¶æ€ï¼ˆWaitï¼‰ã€‚ çº¿ç¨‹æ± ç­–ç•¥ï¼š çº¿ç¨‹æ•°å¯ä»¥è®¾ç½®å¾—å¤§ä¸€äº›ï¼Œå¦‚ $2N_{CPU}$ ç”šè‡³æ›´å¤šã€‚ 5. çº¿ç¨‹æ± çº¿ç¨‹æ•°å¦‚ä½•ç¡®å®šï¼Ÿé¦–å…ˆé’ˆå¯¹äº I&#x2F;O å¯†é›†å‹ä»»åŠ¡æ¥è¯´ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºå†…æ ¸æ•° * 2ã€‚ å½“ä¸€ä¸ªçº¿ç¨‹å› ä¸º I&#x2F;O é˜»å¡æˆ–ç­‰å¾…æ—¶ï¼ŒCPU å¯ä»¥åˆ‡æ¢åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ã€‚é¿å…è¿‡å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆContext Switchï¼‰å¸¦æ¥çš„æŸè€—ã€‚ ä¸è¿‡åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä¼šä¼˜å…ˆé€šè¿‡ å‹åŠ›æµ‹è¯• å’Œ æ€§èƒ½ç›‘æ§ï¼ˆå¦‚æŸ¥çœ‹ top ä¸­çš„ iowait æŒ‡æ ‡ï¼‰æ¥åŠ¨æ€è°ƒæ•´çº¿ç¨‹æ•°ï¼Œè€Œä¸ä¼šæ­»å®ˆ å…¬å¼ã€‚ 6. æ‰‹æ’•ä¸€ä¸‹çº¿ç¨‹æ± ï¼Ÿ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475#include &lt;vector&gt;#include &lt;queue&gt;#include &lt;thread&gt;#include &lt;mutex&gt;#include &lt;condition_variable&gt;#include &lt;future&gt;#include &lt;functional&gt;#include &lt;atomic&gt;class ThreadPool &#123;private: std::vector&lt;std::thread&gt; workers; std::queue&lt;std::function&lt;void()&gt;&gt; tasks; std::mutex queue_mutex; std::condition_variable condition; std::atomic&lt;bool&gt; stop; public: ThreadPool(size_t num_threads = std::thread::hardware_concurrency()) : stop(false) &#123; for(size_t i = 0; i &lt; num_threads; ++i) &#123; workers.emplace_back([this] &#123; while(true) &#123; std::function&lt;void()&gt; task; &#123; std::unique_lock&lt;std::mutex&gt; lock(this-&gt;queue_mutex); this-&gt;condition.wait(lock, [this] &#123; return this-&gt;stop || !this-&gt;tasks.empty(); &#125;); if(this-&gt;stop &amp;&amp; this-&gt;tasks.empty()) return; task = std::move(this-&gt;tasks.front()); this-&gt;tasks.pop(); &#125; task(); &#125; &#125;); &#125; &#125; ~ThreadPool() &#123; stop = true; condition.notify_all(); for(std::thread &amp;worker : workers) &#123; if(worker.joinable()) worker.join(); &#125; &#125; template&lt;class F, class... Args&gt; auto enqueue(F&amp;&amp; f, Args&amp;&amp;... args) -&gt; std::future&lt;typename std::result_of&lt;F(Args...)&gt;::type&gt; &#123; using return_type = typename std::result_of&lt;F(Args...)&gt;::type; auto task = std::make_shared&lt;std::packaged_task&lt;return_type()&gt;&gt;( std::bind(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)...) ); std::future&lt;return_type&gt; res = task-&gt;get_future(); &#123; std::unique_lock&lt;std::mutex&gt; lock(queue_mutex); if(stop) throw std::runtime_error(&quot;enqueue on stopped ThreadPool&quot;); tasks.emplace([task]()&#123; (*task)(); &#125;); &#125; condition.notify_one(); return res; &#125;&#125;;","categories":[{"name":"C++ é¢ç»","slug":"C-é¢ç»","permalink":"https://dxblacksmith.github.io/categories/C-%E9%9D%A2%E7%BB%8F/"}],"tags":[]},{"title":"çƒ¤é¢ç­‹ Day 01","slug":"çƒ¤é¢ç­‹_Day01","date":"2026-01-13T10:14:19.695Z","updated":"2026-01-14T07:11:17.577Z","comments":true,"path":"2026/01/13/çƒ¤é¢ç­‹_Day01/","permalink":"https://dxblacksmith.github.io/2026/01/13/%E7%83%A4%E9%9D%A2%E7%AD%8B_Day01/","excerpt":"","text":"çƒ¤é¢ç­‹ Day 01 åŸå­æ“ä½œä¸å†…å­˜æ¨¡å‹: 1. åŸå­æ“ä½œæ˜¯ä»€ä¹ˆï¼ŸAtomic è·ŸåŸå­æ“ä½œçš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿç­”ï¼šåŸå­æ“ä½œå°±æ˜¯è¦ä¹ˆä¸æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œä¸”ä¸­é€”ä¸èƒ½è¢«ä¸­æ–­çš„æ“ä½œã€‚Atomic å°±æ˜¯ C++ 11 æä¾›çš„æ ‡å‡†åº“æ¨¡æ¿ç±»ï¼Œæ˜¯åŸå­æ“ä½œåœ¨è¯­è¨€å±‚é¢çš„å°è£…å’Œå·¥å…·ã€‚ 2. Atomic åº•å±‚æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿç­”ï¼šåº•å±‚ä¸»è¦ä¾èµ–ç¡¬ä»¶å±‚é¢å¤„ç†å™¨æä¾›çš„åŸå­æŒ‡ä»¤ï¼Œåœ¨ x86 æ¶æ„ä¸‹ï¼Œé€šå¸¸ä¼šä½¿ç”¨å¸¦æœ‰ LOCK å‰ç¼€çš„æŒ‡ä»¤ï¼Œå…¶èƒ½é”å®šç¼“å­˜è¡Œï¼Œç¡®ä¿æ‰§è¡Œæ‰§è¡ŒæœŸé—´ä¸ä¼šè¢«ä¸­æ–­ã€‚ ç¼–è¯‘å™¨å±‚é¢ä¹Ÿä¼šæ ¹æ®ä¸åŒçš„ CPU æ¶æ„ï¼Œå°† atomic æ“ä½œæ˜ å°„ä¸ºç›¸åº”çš„æœºå™¨æŒ‡ä»¤ï¼Œæ ¹æ®æŒ‡å®šçš„å†…å­˜åºï¼Œæ’å…¥å¿…è¦çš„ Memory Barrier ï¼Œé˜²æ­¢æŒ‡ä»¤é‡æ’ã€‚ 3. èƒ½ç®€å•è®²è®² C++ çš„å†…å­˜åºï¼ˆMemory Orderï¼‰å—ï¼Ÿå†…å­˜åºçš„ä½œç”¨æ˜¯çº¦æŸç¼–è¯‘å™¨å’Œ CPU çš„æŒ‡ä»¤é‡æ’ä¼˜åŒ–ï¼ŒC++11 å®šä¹‰äº† 6 ç§å†…å­˜åºï¼Œä½†å¸¸ç”¨çš„æ˜¯ memory_order_relaxed å’Œ è·å–&#x2F;é‡Šæ”¾è¯­ä¹‰å’Œåºåˆ—ä¸€è‡´æ€§ã€‚ å®½æ¾é¡ºåºï¼šåªä¿è¯å½“å‰æ“ä½œçš„åŸå­æ€§ï¼Œä¸ä¿è¯ä»»ä½•é¡ºåºï¼ˆæ²¡æœ‰åŒæ­¥å…³ç³»ï¼‰ã€‚ é‡Šæ”¾ï¼ˆreleaseï¼‰è¯­ä¹‰ï¼šæŒæœ‰ release çš„çº¿ç¨‹æ˜¯å‘å¸ƒè€…ï¼Œï¼Œé€»è¾‘æ˜¯ â€œåšå®Œæ‰‹å¤´çš„äº‹æƒ…äº†ï¼Œç°åœ¨å‘å¸ƒè¡¨ç¤ºæ•°æ®å‡†å¤‡å¥½äº†â€ è·å–ï¼ˆacquireï¼‰è¯­ä¹‰ï¼šæŒæœ‰ acquire çš„çº¿ç¨‹æ˜¯è·å–è€…ï¼Œé€»è¾‘æ˜¯ â€œçœ‹åˆ°å‘å¸ƒçš„é€šçŸ¥äº†ï¼Œè¯´æ˜æˆ‘å¯ä»¥æ”¾å¿ƒå»ç”¨æ•°æ®äº†â€ åºåˆ—ä¸€è‡´æ€§ï¼šatomic çš„é»˜è®¤å‚æ•°ï¼Œè¦æ±‚æ‰€æœ‰çº¿ç¨‹çœ‹åˆ°çš„æ‰§è¡Œé¡ºåºéƒ½æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œå°±åƒæ‰€æœ‰æ“ä½œéƒ½æ’åœ¨ä¸€ä¸ªå…¨å±€é˜Ÿåˆ—é‡Œä¾æ¬¡æ‰§è¡Œã€‚ é‚£ä¸ºä»€ä¹ˆä¸èƒ½å…¨ç”¨é»˜è®¤çš„ seq_cst åºåˆ—ä¸€è‡´æ€§çš„å†…å­˜åºï¼Ÿ é«˜æ€§èƒ½åœºæ™¯ä¸‹ï¼ˆå¦‚æ— é”é˜Ÿåˆ—ã€åº•å±‚é©±åŠ¨ï¼‰ï¼Œé»˜è®¤çš„å¼ºé¡ºåºä¼šå¯¼è‡´å¤§é‡çš„å†…å­˜å±éšœæŒ‡ä»¤ï¼Œå¼ºåˆ¶åˆ·æ–° CPU ç¼“å­˜ï¼Œè¿™ä¼šæå¤§é™åˆ¶ç°ä»£å¤šæ ¸å¤„ç†å™¨çš„å¹¶è¡Œèƒ½åŠ›ã€‚ 4. CAS æŒ‡ä»¤æ˜¯ä»€ä¹ˆï¼Ÿç­”ï¼šCAS æ˜¯å®ç°åŸå­æ“ä½œçš„æ ¸å¿ƒæŒ‡ä»¤ï¼ŒåŒ…å«ä¸‰ä¸ªæ“ä½œæ•°ï¼š 1231. å†…å­˜åœ°å€ Vï¼šè¦è¯»å–çš„å˜é‡ä½ç½®ã€‚2. æ—§çš„é¢„æœŸå€¼ Aï¼šæˆ‘ä»¬è®¤ä¸ºè¯¥å˜é‡å½“å‰åº”è¯¥æ˜¯ä»€ä¹ˆå€¼ã€‚3. å‡†å¤‡å†™å…¥çš„æ–°å€¼ Bï¼šå¦‚æœæ£€æŸ¥é€šè¿‡ï¼Œè¦æ›´æ–°æˆçš„å€¼ã€‚ åªæœ‰å†…å­˜åœ°å€çš„å€¼è¿˜æ˜¯æˆ‘ä¹‹å‰è¯»åˆ°çš„é‚£ä¸ªé¢„æœŸå€¼ï¼Œæˆ‘æ‰æŠŠå®ƒä¿®æ”¹æˆæ–°å€¼ã€‚å¦åˆ™è¯´æ˜åˆ«äººæ”¹è¿‡å®ƒï¼Œé‚£æˆ‘å°±æ”¾å¼ƒè¿™æ¬¡ä¿®æ”¹ã€‚æ•´ä¸ªè¿‡ç¨‹æ˜¯åŸå­æ€§çš„ 5.CAS çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿç­”ï¼šä¼˜ç‚¹å°±æ˜¯æ— é”ï¼Œé¿å…äº†ä¼ ç»Ÿäº’æ–¥é”å¯¼è‡´çš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ã€æŒ‚èµ·å’Œæ¢å¤ï¼Œæ€§èƒ½å¼€é”€æ›´å°ã€‚ ç¼ºç‚¹æ˜¯æœ‰è‡ªæ—‹å¼€é”€ï¼Œå¦‚æœåœ¨é«˜ç«äº‰ç¯å¢ƒä¸‹ï¼ŒCAS ä¸€ç›´å¤±è´¥ï¼Œä¼šå¯¼è‡´ CPU ä¸€ç›´ç©ºè½¬ï¼Œæµªè´¹èµ„æºã€‚åŒæ—¶è¿˜å­˜åœ¨ ABA é—®é¢˜ã€‚ 6. ABA é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å°†æ•°å€¼ A æ”¹æˆäº† Bï¼Œéšåå¦ä¸€ä¸ªçº¿ç¨‹åˆå°† B æ”¹å›äº† Aï¼Œæ­¤æ—¶ç¬¬ä¸‰ä¸ªçº¿ç¨‹è¿›è¡Œæ£€æŸ¥ï¼Œå‘ç°å€¼ä¾ç„¶æ˜¯ Aï¼Œè®¤ä¸ºæ²¡æœ‰æ”¹å˜ï¼Œä»è€Œè¯¯æ“ä½œã€‚ ç›®å‰è§£å†³çš„ä¸»æµåŠæ³•æ˜¯ç‰ˆæœ¬å·ï¼Œå®ç°æ–¹æ³•å°±æ˜¯è®°å½•å€¼çš„åŒæ—¶ç»´æŠ¤ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œæ¯æ¬¡æ›´æ–°çš„æ—¶å€™ï¼Œä¸ä»…æ›´æ–°å€¼ï¼Œè¿˜è®©ç‰ˆæœ¬å· +1ã€‚è¿™æ ·é‡åˆ° ABA é—®é¢˜çš„æ—¶å€™ç‰ˆæœ¬å·ä¸åŒï¼Œå°±çŸ¥é“å€¼å·²ç»å‘ç”Ÿæ”¹å˜äº†ã€‚ 7. C++ atomic æ˜¯å¦è‡ªå¸¦ç‰ˆæœ¬å·æœºåˆ¶ï¼Ÿä¸è‡ªå¸¦ã€‚æ ‡å‡†çš„ std::atomic åªæ˜¯å¯¹ç±»å‹ T çš„åŸå­å°è£…ã€‚å¦‚æœ T æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œä»ç„¶ä¼šå­˜åœ¨ ABA é—®é¢˜ã€‚ å¦‚æœéœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜çš„è¯ï¼Œå¼€å‘è€…é€šå¸¸éœ€è¦é…åˆ std::atomic&lt;std::pair&lt;T, int&gt;&gt; æˆ–è€…ä¸€äº›å¸¦æœ‰ Tag çš„æŒ‡é’ˆæŠ€æœ¯ã€‚ 8. Volatile å…³é”®å­—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿèƒ½è§£å†³çº¿ç¨‹å®‰å…¨å—ï¼Ÿä¸»è¦çš„ä½œç”¨æ˜¯ç¦æ­¢ç¼–è¯‘å™¨ä¼˜åŒ–ï¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¿™ä¸ªå˜é‡çš„å€¼å¯èƒ½éšæ—¶è¢«å¤–éƒ¨ï¼ˆå¦‚ç¡¬ä»¶ä¸­æ–­ã€å¦ä¸€ä¸ªè¿›ç¨‹ï¼‰ä¿®æ”¹ï¼Œå› æ­¤æ¯æ¬¡ä½¿ç”¨å®ƒéƒ½å¿…é¡»ä»å†…å­˜ä¸­è¯»å–ï¼Œè€Œä¸èƒ½ä½¿ç”¨å¯„å­˜å™¨é‡Œçš„ç¼“å­˜ã€‚ ä¸èƒ½ï¼Œå› ä¸ºä»–ä¸ä¿è¯åŸå­æ€§ï¼ŒåŒæ—¶ä¸ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œåªé’ˆå¯¹ç¼–è¯‘å™¨çš„ï¼Œä½†ä¸æä¾›é’ˆå¯¹ CPU çš„å†…å­˜å±éšœï¼Œæ— æ³•è§£å†³å¤šæ ¸ç¯å¢ƒä¸‹çš„å¯è§æ€§å’Œæœ‰åºæ€§é—®é¢˜ã€‚ 9. æ‰‹æ’•ä¸€ä¸‹ï¼šå†™ä¸€ä¸‹ CAS å®ç°çš„æ— é”é˜Ÿåˆ—1234567891011121314151617181920212223242526272829303132333435#include &lt;atomic&gt;template &lt;typename T&gt;class LockFreeQueue &#123;public: void Enqueue(const T&amp; val) &#123; Node* new_node = Node(val); Node* old_tail = tail.load(); while(true) &#123; old_tail = tail.load(); Node* next = old_tail-&gt;next.load(); if(old_tail == tail.load()) &#123; if(next == nullptr) &#123; if(old_tail-&gt;next.compare_exchange_strong(next, new_node)) &#123; tail.compare_exchange_weak(old_tail, new_node); return; &#125; &#125; else tail.compare_exchange_strong(old_tail, next); &#125; &#125; &#125;private: struct Node &#123; T data; std::atomic&lt;Node*&gt; next; Node(T val) : data(val), next(nullptr) &#123;&#125; &#125;; std::atomic&lt;Node*&gt; head; std::atomic&lt;Node*&gt; tail;&#125;;int main(int argc, char* argv[]) &#123;&#125; å¤šçº¿ç¨‹ä¸é” 1. å¤šçº¿ç¨‹æœ€å¸¸è§çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿä¸»è¦æ˜¯ä¸‰ä¸ªé—®é¢˜ï¼š çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™åŒä¸€ä¸ªå—å†…å­˜ï¼Œå¯¼è‡´ç»“æœä¸å¯é¢„æœŸ æ´»è·ƒæ€§é—®é¢˜ï¼šåŒ…æ‹¬æ­»é”ï¼Œæ´»é”å’Œé¥¥é¥¿ï¼Œå…¶ä¸­æ­»é”æ˜¯æœ€è‡´å‘½çš„ï¼Œä¼šå¯¼è‡´ç¨‹åºå®Œå…¨å¡æ­» æ€§èƒ½å¼€é”€ï¼šè¿‡æ¸¡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œé”ç«äº‰å¯¼è‡´æ€§èƒ½ä¸‹é™ 2. æ­»é”æ€ä¹ˆé¿å…ï¼Ÿé¿å…æ­»é”çš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šé˜²æ­¢å¾ªç¯ç­‰å¾…é“¾çš„å½¢æˆã€‚å¸¸ç”¨çš„è§£å†³åŠæ³•å¦‚ä¸‹ï¼š å›ºå®šåŠ é”é¡ºåºï¼šè§„å®šæ‰€æœ‰çš„çº¿ç¨‹å¿…é¡»æŒ‰ç…§ç›¸åŒçš„é¡ºåºè·å–é”ï¼ˆå…ˆæ‹¿ A é”ï¼Œå†æ‹¿ B é”ï¼‰ å°è¯•é”ï¼ˆTry-lockï¼‰ï¼šä½¿ç”¨ std::unique_lock çš„ try_lockï¼Œå¦‚æœæ‹¿ä¸åˆ°é”å°±ç«‹å³é‡Šæ”¾å·²å ç”¨çš„æ‰€å¹¶ä¸”å›é€€ ä½¿ç”¨é«˜çº§æŠ½è±¡ï¼šä½¿ç”¨å…¶ä»–æ— é”çš„æœºåˆ¶ï¼ˆæ¯”å¦‚æ¶ˆæ¯ä¼ é€’ç­‰ç­‰ï¼‰æ¥æ›¿ä»£åº•å±‚é” 3. å“ªäº›è®¾è®¡æ–¹å¼&#x2F;æŠ€å·§èƒ½ç ´åæ­»é”çš„ 4 ä¸ªæ¡ä»¶ï¼Ÿäº’æ–¥æ€§ï¼šèµ„æºä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨ã€‚è¿™ä¸ªæ˜¯æ— æ³•ç ´åï¼ˆé”çš„æœ¬æ„ï¼‰ã€‚ å ç”¨ä¸”ç­‰å¾…ï¼šçº¿ç¨‹æŒæœ‰ä¸€ä¸ªèµ„æºçš„åŒæ—¶ï¼Œè¿˜åœ¨ç­‰å¾…å¦ä¸€ä¸ªèµ„æºã€‚é‡‡ç”¨ä¸€æ¬¡æ€§ç”³è¯·çš„æ–¹å¼è§£å†³ï¼š çº¿ç¨‹å¯åŠ¨å‰ä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰éœ€è¦çš„é”ï¼›æˆ–è€…åœ¨æ— æ³•è·å–ä¸‹ä¸€ä¸ªé”æ—¶ï¼Œé‡Šæ”¾å·²å æœ‰çš„æ‰€æœ‰é”ã€‚ ä¸å¯å‰¥å¤ºï¼šèµ„æºä¸èƒ½è¢«æŠ¢å ï¼Œåªèƒ½ç”±æŒæœ‰è€…ä¸»åŠ¨é‡Šæ”¾ã€‚é‡‡ç”¨æŠ¢å æœºåˆ¶çš„æ–¹å¼è§£å†³ï¼šå¦‚æœçº¿ç¨‹ç”³è¯·æ–°é”å¤±è´¥ï¼Œä¸»åŠ¨é‡Šæ”¾æ‰‹ä¸­èµ„æºï¼Œè¿‡æ®µæ—¶é—´å†é‡è¯• å¾ªç¯ç­‰å¾…ï¼šå­˜åœ¨ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ç¯è·¯ï¼šT1 ç­‰ T2ï¼ŒT2 ç­‰ T1ã€‚é‡‡ç”¨èµ„æºçº¿æ€§æ’åºçš„æ–¹å¼è§£å†³ï¼š ç»™æ‰€æœ‰é”åˆ†é…å”¯ä¸€åºå·ï¼Œå¼ºåˆ¶è§„å®šå¿…é¡»æŒ‰åºå·ä»å°åˆ°å¤§ï¼ˆæˆ–ä»å¤§åˆ°å°ï¼‰è·å–é”ã€‚ 4. å®é™…å¼€å‘ä¸­ï¼Œä½ ä¼šå¦‚ä½•å®ç°é¿å…æ­»é”çš„å‘ç”Ÿï¼Ÿæˆ‘ä¼šä½¿ç”¨ std::scoped_lock ä¸€æ¬¡æ€§æ·»åŠ å¤šä¸ªé”åˆ©ç”¨å…¶å†…éƒ¨çš„æœºåˆ¶æ¥é¿å… 12345678910111213141516171819202122232425262728293031323334#include &lt;iostream&gt;#include &lt;mutex&gt;#include &lt;thread&gt;class Account &#123;public: int balance = 1000; std::mutex mtx; // æ¯ä¸ªè´¦æˆ·è‡ªå¸¦ä¸€æŠŠé”&#125;;void transfer(Account&amp; from, Account&amp; to, int amount) &#123; // å…³é”®ç‚¹ï¼šstd::scoped_lock åŒæ—¶æ¥æ”¶å¤šä¸ª mutex // å®ƒå†…éƒ¨ä½¿ç”¨äº†ä¸€ç§å…æ­»é”ç®—æ³•ï¼ˆé€šå¸¸æ˜¯é€ä¸ªå°è¯•ä¸”ä¸æŒæœ‰ç­‰å¾…ï¼‰ // æ— è®ºä½ ä¼ å…¥å‚æ•°çš„é¡ºåºå¦‚ä½•ï¼Œå®ƒéƒ½èƒ½ä¿è¯ä¸ä¼šå‘ç”Ÿæ­»é” std::scoped_lock lock(from.mtx, to.mtx); if (from.balance &gt;= amount) &#123; from.balance -= amount; to.balance += amount; std::cout &lt;&lt; &quot;è½¬è´¦æˆåŠŸ: &quot; &lt;&lt; amount &lt;&lt; std::endl; &#125;&#125;int main() &#123; Account alice, bob; // çº¿ç¨‹ 1ï¼šä» Alice è½¬è´¦ç»™ Bob std::thread t1(transfer, std::ref(alice), std::ref(bob), 100); // çº¿ç¨‹ 2ï¼šä» Bob è½¬è´¦ç»™ Alice (å¦‚æœç”¨æ™®é€š lock ä¼šå› é¡ºåºç›¸åå¯¼è‡´æ­»é”) std::thread t2(transfer, std::ref(bob), std::ref(alice), 200); t1.join(); t2.join(); return 0;&#125; å…¶å†…éƒ¨çš„æœºåˆ¶ é¿å…å¾ªç¯ç­‰å¾…ï¼šå†…éƒ¨å¹¶ä¸ç®€å•åœ°æŒ‰é¡ºåºè°ƒç”¨ lock()ï¼Œè€Œæ˜¯é‡‡ç”¨äº†ä¸€ç§ â€œé‡è¯•æœºåˆ¶â€ï¼š â€‹ 1. å®ƒä¼šå°è¯•é”ä½ç¬¬ä¸€ä¸ªäº’æ–¥é‡ã€‚ â€‹ 2. æ¥ç€å°è¯• try_lock åé¢çš„äº’æ–¥é‡ã€‚ â€‹ 3. å¦‚æœä¸­é—´ä»»ä½•ä¸€ä¸ªé”å¤±è´¥äº†ï¼Œå®ƒä¼šç«‹å³é‡Šæ”¾å·²ç»æŒæœ‰çš„æ‰€æœ‰é”ï¼Œç„¶åé‡æ–°å¼€å§‹ã€‚ åŸå­æ€§åŠ é”ï¼šä¿è¯äº†æ‰€æœ‰ä¼ å…¥çš„äº’æ–¥é‡è¦ä¹ˆå…¨éƒ¨é”ä½ï¼Œè¦ä¹ˆä¸€ä¸ªéƒ½ä¸é”ã€‚","categories":[{"name":"C++ é¢ç»","slug":"C-é¢ç»","permalink":"https://dxblacksmith.github.io/categories/C-%E9%9D%A2%E7%BB%8F/"}],"tags":[]},{"title":"è¿ç½‘","slug":"è¿ç½‘","date":"2025-12-07T05:09:21.000Z","updated":"2026-02-04T09:02:50.797Z","comments":true,"path":"2025/12/07/è¿ç½‘/","permalink":"https://dxblacksmith.github.io/2025/12/07/%E8%BF%9E%E7%BD%91/","excerpt":"","text":"â€œè¿ç½‘â€å¹³æ—¶æˆ‘ä»¬è¯´çš„è¿ç½‘ï¼Œè¿ç½‘åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆå®éªŒå®¤çš„ä¸»æœºåªèƒ½æ¥ç½‘çº¿æˆ–è€…è¿æ¥ wifi æ‰èƒ½è®¿é—®äº’è”ç½‘ä¸Šçš„å„ç§èµ„æºå‘¢ï¼Ÿ ä¸ºäº†ææ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦ææ‡‚ä¸‹é¢å‡ ä¸ªæ¦‚å¿µ è¿ç½‘ï¼šä¸»æœºé€šè¿‡æœ‰çº¿æˆ–æ— çº¿æ–¹å¼æ¥å…¥ç½‘ç»œï¼Œè·å¾— IP åœ°å€ï¼Œå¹¶èƒ½å¤Ÿä¸å…¶ä»–è®¾å¤‡æˆ–äº’è”ç½‘è¿›è¡Œæ•°æ®é€šä¿¡çš„è¿‡ç¨‹ã€‚ ä¸»æœºç½‘ç»œé€šä¿¡çš„æ–¹æ³•å…¬ç½‘é€šä¿¡ä¸¤å°ä¸»æœºéƒ½æœ‰å…¬ç½‘ IP, å¯ä»¥ç›´æ¥é€šè¿‡ ssh user@å…¬ç½‘ IP è¿æ¥ è¿™ç§é€šå¸¸åªé€‚ç”¨äºå…·æœ‰å›ºå®šå…¬ç½‘ IP çš„è®¾å¤‡è¿æ¥ã€‚ å®¶åº­çš„å®½å¸¦é€šå¸¸æ˜¯åŠ¨æ€çš„å…¬ç½‘ IP (é‡å¯å…‰çŒ«ä»¥åä¼šå˜åŒ–)ï¼Œä¼ä¸šæˆ–è€…äº‘æœåŠ¡å™¨æ‰æ˜¯é™æ€å…¬ç½‘ IP ã€‚ è§£é‡Šå®¶é‡Œä¸ºä»€ä¹ˆåªæœ‰è¿æ¥ wifi ï¼ˆè¿æ¥è·¯ç”±å™¨ï¼‰æ‰èƒ½è®¿é—®äº’è”ç½‘ä¸Šçš„å„ç§èµ„æºã€‚ åªè¦æ˜¯éœ€è¦è®¿é—®äº’è”ç½‘ä¸Šçš„èµ„æºï¼Œé‚£ä¹ˆéƒ½éœ€è¦è®¾å¤‡å…·æœ‰å…¬ç½‘ IPï¼Œ ä½†æ˜¯æ‰‹æœºç­‰è®¾å¤‡å‡ºå‚æ—¶åªæœ‰ mac åœ°å€ï¼Œè¿æ¥è·¯ç”±å™¨çš„æ‰ä¼šç»™ä½ åˆ†é… IP åœ°å€ï¼ˆIP åœ°å€æ˜¯é€»è¾‘åœ°å€ï¼Œç”±ç½‘ç»œç¯å¢ƒå†³å®šçš„ï¼‰ï¼Œä½†æ˜¯å°±ç®—ç»™ä½ åˆ†é…äº†ï¼Œä¹Ÿåªæ˜¯å†…ç½‘ IPï¼Œè·¯ç”±å™¨æ‰æ˜¯å”¯ä¸€å…·æœ‰å…¬ç½‘ IP çš„è®¾å¤‡ã€‚ ä¸è¿‡è¿æ¥çš„è·¯ç”±å™¨ä¼šå°†ä½ çš„å†…ç½‘ IP ç»“åˆè‡ªå·±çš„ WAN å£ï¼ˆå…¬ç½‘ IPï¼‰è½¬æ¢æˆå…¬ç½‘ IPï¼Œæ”¶åˆ°å›å¤åŒ…çš„æ—¶å€™ï¼Œåˆå°†è¿™ä¸ªå…¬ç½‘ IP è½¬æ¢æˆå†…ç½‘ IP ä»è€Œæ‰¾åˆ°ä½ çš„è®¾å¤‡ï¼Œè¿™å…¶ä¸­ç‰µæ‰¯åˆ°çš„åè®®å«åš NAT åè®®ï¼Œè¿™é‡Œå…ˆä¸ä»”ç»†è®²äº†ï¼Œå¤§æ¦‚æ˜¯å®ç°äº†åœ°å€è½¬æ¢çš„æ„æ€ã€‚ Ps. ç”¨ 4G/5G æ˜¯ä¸ç»è¿‡å®¶ç”¨è·¯ç”±å™¨ï¼Œç›´æ¥é€šè¿‡åŸºç«™è¿æ¥åˆ°è¿è¥å•†çš„æ ¸å¿ƒç½‘ï¼Œç„¶åè¿è¥å•†ç»™ä½ åˆ†é… CGNAT IP&#x2F; å…¬ç½‘ IP ã€‚ å±€åŸŸç½‘é€šä¿¡åŒä¸€å±€åŸŸç½‘å†…é€šä¿¡åœ¨åŒä¸€å±€åŸŸç½‘ä¸‹é¢ï¼Œé€šè¿‡å±€åŸŸç½‘çš„ IP èƒ½å¤Ÿç›´æ¥è¿›è¡Œé€šä¿¡ã€‚è¿™ä¸ªç”¨çš„æ¯”è¾ƒå¤šï¼Œä¸€èˆ¬å…¬å¸&#x2F;å­¦æ ¡&#x2F;å®éªŒå®¤å†…éƒ¨æœåŠ¡å™¨éƒ½æ˜¯é€šè¿‡è¿™ç§æ–¹å¼ã€‚ é‚£ä¹ˆæœ‰äº›æ—¶å€™ä¸ºäº†å›ºå®šæ¯”å¦‚ç›‘æ§æ‘„åƒå¤´å’Œæ‰“å°æœºçš„ IP æˆ–è€…å®éªŒå®¤æ ¹æœ¬å°±æ²¡æœ‰è·¯ç”±å™¨ï¼ˆçº¯å†…ç½‘é€šä¿¡ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™ä½œä¸ºè®¡ç®—æœºä¸“ä¸šçš„æˆ‘ä»¬ï¼Œå¯èƒ½ä¼šè®©æˆ‘ä»¬é…ç½®é™æ€ IPã€‚ äºæ˜¯å°±ä¼šæ¥è§¦ä¸‹é¢çš„æ¦‚å¿µï¼š å­ç½‘æ©ç ï¼šç”¨äºåˆ’åˆ†ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ã€‚åŒä¸€å±€åŸŸç½‘çš„æ‰€æœ‰ IP &amp; ä¸Šè¿™ä¸ªæ©ç éƒ½ä¼šå¾—åˆ°åŒä¸€ä¸ªåœ°å€ï¼ˆä¸€èˆ¬å°±å¡« 255.255.255.0 ï¼‰ é»˜è®¤ç½‘å…³ï¼šå½“è®¿é—®ä¸æ˜¯å±€åŸŸç½‘çš„åœ°å€çš„æ—¶å€™ï¼Œæ•°æ®åŒ…å°±ä¼šå‘ç»™ç½‘å…³ã€‚é€šå¸¸æ˜¯è·¯ç”±å™¨çš„å†…ç½‘ IP ï¼Œå¤§å¤šæ•°é»˜è®¤ç½‘å…³çš„ IP åœ°å€çš„æœ€åä¸€ä½æ˜¯ 1 æˆ–è€… 254ï¼ˆ0 ä¸å¯ä»¥ï¼Œ255 ç”¨ä½œå¹¿æ’­ï¼‰ DNS æœåŠ¡å™¨ï¼šç”¨äºå°†è¾“å…¥çš„åŸŸåè§£ææˆ IP åœ°å€ï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚DNS æœåŠ¡å™¨é€šå¸¸å¡« 114.114.114.114 è¿™ç§å…¬å…± DNS æœåŠ¡å™¨å³å¯ åœ¨çº¯å†…ç½‘é€šä¿¡ï¼ˆå®éªŒå®¤ä¸­å¸¸ç”¨ï¼‰å½“ä¸­ï¼Œäº¤æ¢æœºç”±äºæ²¡æœ‰ DHCP æœåŠ¡å™¨ï¼Œå°±æ²¡æœ‰è‡ªåŠ¨åˆ†é… IP çš„åŠŸèƒ½ï¼ˆè·¯ç”±å™¨æœ‰ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™åªèƒ½é€šè¿‡æ‰‹åŠ¨é…ç½® IP çš„æ–¹å¼æ¥å®ç°é€šä¿¡ã€‚ è¿™ä¸ªæ—¶å€™åªéœ€è¦æ‰€æœ‰çš„æœºå™¨éƒ½åœ¨åŒä¸€ä¸ªç½‘æ®µï¼Œæ¯”å¦‚ 12345678910IP: ä¸å†²çªå°±è¡Œ æœºå™¨ A : 192.168.10.10 æœºå™¨ B : 192.168.10.11 æœºå™¨ B : 192.168.10.12 å­ç½‘æ©ç ï¼š ç»Ÿä¸€å¡« 255.255.255.0 é»˜è®¤ç½‘å…³: ä¸€èˆ¬ç•™ç©ºï¼ˆ0.0.0.0)ï¼Œå› ä¸ºä¸€èˆ¬ä¸éœ€è¦ä¸Šç½‘DNSï¼š ä¸€èˆ¬ä¹Ÿç•™ç©ºï¼Œé™¤éä½ è¦è§£æåŸŸåï¼Œä½†æ˜¯ä¸€èˆ¬å†…ç½‘ç”¨ IP åœ°å€ å¦‚ä½•é…ç½®ä¸€ä¸ªæ–°è®¾å¤‡çš„é™æ€ IP è®°å½•åŒç½‘æ®µä¸‹å¦ä¸€å°é…ç½®å¥½å¾—è®¾å¤‡çš„ç½‘æ®µ ï¼ˆIP + å­ç½‘æ©ç  192.168.31.0&#x2F;24ï¼‰å’Œé»˜è®¤ç½‘å…³ï¼ˆ 192.168.31.1ï¼‰ é€‰æ‹©ä¸€ä¸ªä¸å†²çªçš„é™æ€ IPï¼ˆping ä¸€ä¸‹çœ‹çœ‹è¿ä¸è¿é€šï¼‰ï¼Œç™»å½•è®¾å¤‡çš„ç®¡ç†ç•Œé¢ï¼Œè¿™ä¸ªä¸€èˆ¬æ ¹æ®è®¾å¤‡çš„ä¸åŒæœ‰äº›è®¸ä¸åŒï¼Œå¯ä»¥æŸ¥çœ‹ä¸‹è¡¨ï¼š è®¾å¤‡ç±»å‹ ç™»å½•æ–¹å¼ æ‰“å°æœº 1. åœ¨æ‰“å°æœºé¢æ¿ä¸ŠæŸ¥çœ‹ IP 2. ç”¨æµè§ˆå™¨è®¿é—®è¯¥ IP 3. è¾“å…¥ç®¡ç†å‘˜è´¦å·å¯†ç ï¼ˆé»˜è®¤å¸¸å°åœ¨æœºèº«ï¼‰ äº¤æ¢æœºï¼ˆç½‘ç®¡å‹ï¼‰ 1. ç”¨ Console çº¿ï¼ˆä¸²å£ï¼‰è¿æ¥ç”µè„‘ 2. ç”¨ç»ˆç«¯è½¯ä»¶ï¼ˆPuTTYã€SecureCRTï¼‰ç™»å½• æ‘„åƒå¤´ &#x2F; NAS æµè§ˆå™¨è®¿é—® IP æˆ–ä¸“ç”¨å®¢æˆ·ç«¯ Linux æœåŠ¡å™¨ SSH ç™»å½•åä¿®æ”¹ç½‘ç»œé…ç½®æ–‡ä»¶ é…ç½® IP å‚æ•°ï¼ˆä¸€èˆ¬å†…ç½‘å°±é…ç½® IP åœ°å€å’Œå­ç½‘æ©ç å°±å¯ä»¥ï¼‰åŒæ—¶ä¿å­˜éªŒè¯ï¼Œæ¯”å¦‚ç”¨æ–° IP èƒ½å¤Ÿé‡æ–°è®¿é—®è®¾å¤‡çš„ç®¡ç†ç•Œé¢å’Œç”¨å…¶ä»–è®¾å¤‡ ping ä¸€ä¸‹è¿™ä¸ªè®¾å¤‡æ¥æµ‹è¯•è¿é€šã€‚ ä¸åŒå±€åŸŸç½‘ä¹‹é—´é€šä¿¡ é€šè¿‡è·³æ¿æœºä¸­è½¬ è·³æ¿æœºï¼šä¸€ä¸ªä¸“é—¨ç”¨äºä¸­è½¬è®¿é—®å†…ç½‘èµ„æºçš„ â€œå ¡å’â€ æœåŠ¡å™¨ï¼Œä¸€èˆ¬ç”¨äºé›†ä¸­ç®¡ç†è®¿é—®æƒé™ã€‚ æ¯”å¦‚å…¬å¸çš„æ•°æ®åº“æœåŠ¡å™¨ï¼Œæˆ–è€…å†…éƒ¨çš„ API æœåŠ¡éƒ¨ç½²åœ¨ç§æœ‰ç½‘ç»œä¸­ï¼Œå¤„äºå®‰å…¨è€ƒè™‘ä¸å…è®¸ç›´æ¥æš´éœ²åˆ°äº’è”ç½‘ä¸­ã€‚æ‰€ä»¥ä»–ä»¬æ²¡æœ‰å…¬ç½‘ IPï¼ŒåŒæ—¶åˆä¸å¯èƒ½å’Œä½ åœ¨ä¸€ä¸ªå±€åŸŸç½‘å†…ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å…ˆç™»å½•ä¸€å°æœ‰å…¬ç½‘ IP çš„è·³æ¿æœºï¼Œå†ä»å®ƒè·³è½¬è¿‡å»ã€‚ è¿™æ ·ç›®æ ‡æœåŠ¡å™¨å°±å®ç°äº†å®Œå…¨éš”ç¦»ï¼Œå…¶é˜²ç«å¢™åªå…è®¸è·³æ¿æœº IP è®¿é—® SSH ç«¯å£ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•èƒ½å¤Ÿé€šè¿‡è·³æ¿æœºæ¥è¿æ¥ç›®æ ‡æœåŠ¡å™¨å‘¢ï¼Ÿ æœ€æ¨èçš„å°±æ˜¯ç›´æ¥ç¼–è¾‘æœ¬åœ°ç”µè„‘çš„ SSH é…ç½®æ–‡ä»¶ï¼ˆ~&#x2F;.ssh&#x2F;config æ–‡ä»¶ï¼‰ã€‚å‡å¦‚æˆ‘ä»¬æœ‰å¦‚ä¸‹ä¿¡æ¯ è§’è‰² ä¿¡æ¯ è·³æ¿æœº å…¬ç½‘ IP: 203.0.113.10ï¼Œç”¨æˆ·å: abcï¼ŒSSH ç«¯å£: 22 ç›®æ ‡æœåŠ¡å™¨ å†…ç½‘ IP: 10.0.1.20ï¼Œç”¨æˆ·å: cba é‚£ä¹ˆç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰å¦‚ä¸‹å³å¯ï¼š 1234567891011# è·³æ¿æœºå®šä¹‰Host jump HostName 203.0.113.10 User ops Port 22# ç›®æ ‡æœåŠ¡å™¨ï¼ˆé€šè¿‡è·³æ¿æœºè®¿é—®ï¼‰Host db-server HostName 10.0.1.20 User app ProxyJump jump vscode ä¸‹è½½ç›¸åº”çš„æ’ä»¶ä»¥åè¯»å–è¿™ä¸ªé…ç½®ï¼Œå°±èƒ½ç›´æ¥è¿æ¥å†…éƒ¨æœåŠ¡å™¨ï¼Œå®ç°ä»£ç ç¼–è¾‘å’Œæ–‡ä»¶ä¸Šä¼ ï¼ˆvscode å†…ç½®çš„ SFTP ï¼‰ã€‚ä¹Ÿæœ‰äººç”¨ xftp æˆ–è€… Filezilla æ¥å®ç°æ–‡ä»¶ä¼ è¾“ï¼Œæˆ‘æ²¡ç”¨è¿‡ï¼Œæ‰€ä»¥æš‚æ—¶ä¸è¯„è®ºã€‚ Ps. vscode å…·ä½“æ“ä½œå°±æ˜¯è°ƒå‡ºå‘½ä»¤é¢æ¿ï¼Œremote-ssh: connet to hostã€‚ å†…ç½‘ç©¿é€ è¿™ä¸ªæš‚æ—¶æ²¡æœ‰æ¥è§¦åˆ°ï¼Œå…ˆæŒ–ä¸ªå‘ã€‚ã€‚ã€‚","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://dxblacksmith.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[]},{"title":"å¼•ç”¨ç¬¬ä¸‰æ–¹åº“","slug":"å¼€å‘ç¯å¢ƒ","date":"2025-11-26T09:56:41.160Z","updated":"2026-01-29T09:19:27.507Z","comments":true,"path":"2025/11/26/å¼€å‘ç¯å¢ƒ/","permalink":"https://dxblacksmith.github.io/2025/11/26/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/","excerpt":"","text":"å¼•ç”¨ç¬¬ä¸‰æ–¹åº“Windows ç¯å¢ƒä¸€èˆ¬å¼•ç”¨ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ï¼Œä¸»è¦éœ€è¦ä¸‰ä¸ªä¸œè¥¿ï¼š å¤´æ–‡ä»¶ï¼ˆincludeï¼‰ï¼šåŒ…å«åº“çš„å‡½æ•°å£°æ˜ï¼Œç±»å®šä¹‰ç­‰ç­‰ åº“æ–‡ä»¶ï¼ˆlibï¼‰ï¼šåŒ…å«ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶ä»£ç  è¿è¡Œæ—¶åº“ï¼ˆdllï¼‰ï¼šåŠ¨æ€é“¾æ¥åº“ï¼Œé™æ€é“¾æ¥åº“åˆ™ä¸éœ€è¦ ä¸ºäº†å¾—åˆ°è¿™ä¸‰ä¸ªä¸œè¥¿ï¼Œä¸€èˆ¬çš„æµç¨‹æ˜¯ï¼š è·å–é¡¹ç›®æºç è¿™ä¸ªä¸€èˆ¬ç›´æ¥ä» github ç›´æ¥æ‹‰ä¸‹æ¥å°±è¡Œï¼Œæˆ–è€…æµè§ˆå™¨ç›´æ¥ä¸‹è½½ç­‰ç­‰ä¹Ÿè¡Œ 12# ä» GitHub å…‹éš†æˆ–ä¸‹è½½æºç git clone https://github.com/grpc/grpc CMake é…ç½®å’Œç”Ÿæˆæ³¨æ„ï¼šcmakeçš„é…ç½®å’Œç”Ÿæˆé˜¶æ®µä¸æ¶‰åŠç¼–è¯‘ã€‚ç›®çš„æ˜¯ç”Ÿæˆæ„å»ºç³»ç»Ÿæ‰€éœ€è¦çš„æ–‡ä»¶ï¼ˆå¦‚ .slnå’Œ Makefileæ–‡ä»¶ï¼‰ 121. configure: è§£æ CMakeLists.txt ä¸­çš„é…ç½®é€‰é¡¹ï¼Œè®¾ç½®é¡¹ç›®å˜é‡å’Œç¼“å­˜ï¼Œæ£€æŸ¥ä¾èµ–å…³ç³»2. generate: ç”Ÿæˆæ„å»ºç³»ç»Ÿæ‰€éœ€è¦çš„æ–‡ä»¶ï¼ˆå¦‚ .sln å’Œ .vcxproj é¡¹ç›®æ–‡ä»¶ï¼‰ æ‰€ä»¥ CMakeä¸æ˜¯ç¼–è¯‘å™¨ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„æ„å»ºå·¥å…· ç¼–è¯‘ç¬¬ä¸‰æ–¹åº“è¿™ä¸€æ­¥åœ¨ windowsé€šå¸¸ç”¨ msvcæ¥å®Œæˆï¼Œå°†æºä»£ç ç¼–è¯‘æˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¦‚æœæ˜¯å¯æ‰§è¡Œé¡¹ç›®ï¼Œå¯ä»¥ç›´æ¥ç”Ÿæˆ .exeï¼Œç¬¬ä¸‰æ–¹åº“å°±æ˜¯ .lib å’Œ .dll æ–‡ä»¶ ã€‚æ¢å¥è¯è¯´ .lib æ–‡ä»¶ &#x2F; .dll æ–‡ä»¶ &#x2F; .exe æ–‡ä»¶éƒ½æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ é€‰æ‹©é…ç½®ï¼ˆDebug&#x2F;Releaseï¼‰ ç¼–è¯‘æºä»£ç ï¼Œç”Ÿæˆ .obj æ–‡ä»¶ é“¾æ¥ .obj æ–‡ä»¶ -&gt; ç”Ÿæˆæœ€ç»ˆçš„ .lib æˆ–è€… .dll æ–‡ä»¶ï¼ˆå¯æ‰§è¡Œé¡¹ç›®å°±æ˜¯ .exe æ–‡ä»¶ï¼‰ Ps. ç‚¹å‡»ç”Ÿæˆä¹‹å‰éœ€è¦è¿›è¡Œä¸€ä¸ªé…ç½®ï¼Œå¾ˆé‡è¦ï¼Œå¾ˆå¤šé¡¹ç›®ä¸å…¼å®¹å°±æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ã€‚é¡¹ç›®ä¸­çš„æ‰€æœ‰åº“å¿…é¡»ä½¿ç”¨ç›¸åŒçš„è¿è¡Œæ—¶åº“ç±»å‹(runtime-link)ï¼ è¿™ä¸€æ­¥å°±æ˜¯åœ¨é…ç½®è¿è¡Œæ—¶åº“çš„ä¸€ä¸ªç±»å‹ï¼ˆå±æ€§ -&gt; C&#x2F;C++ -&gt; ä»£ç ç”Ÿæˆ -&gt; è¿è¡Œåº“ï¼‰ 12341. MT(Release): é™æ€é“¾æ¥å¤šçº¿ç¨‹è¿è¡Œæ—¶åº“2. MD(Release): åŠ¨æ€é“¾æ¥å¤šçº¿ç¨‹è¿è¡Œæ—¶åº“3. MTd(Debug): é™æ€é“¾æ¥å¤šçº¿ç¨‹è°ƒè¯•è¿è¡Œæ—¶åº“4. MDd(Debug): åŠ¨æ€é“¾æ¥å¤šçº¿ç¨‹è°ƒè¯•è¿è¡Œæ—¶åº“ ä¸Šé¢è¿™ä¹ˆå¤šç±»å‹å…¶å®ä¸ç”¨è®°ï¼Œåªéœ€è¦è®°ä½å¦‚æœæœ‰ä¸€ä¸ªé¡¹ç›®é€‰æ‹©çš„æ˜¯ sharedæ–¹å¼ï¼Œå…¶ä½™æ‰€æœ‰çš„é¡¹ç›®éƒ½éœ€è¦é€‰æ‹© MDã€‚ é…ç½®ç¬¬ä¸‰æ–¹åº“åœ¨ä¸Šä¸€æ­¥åº“çš„ç¼–è¯‘ä»¥åï¼Œä¼šå¾—åˆ°ç¬¬ä¸‰æ–¹åº“çš„ç›®å½• include: å¤´æ–‡ä»¶ç›®å½• libï¼šåº“æ–‡ä»¶ç›®å½•ï¼ˆgrpc.dll, grpc.libï¼‰ æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ç›®å½• binï¼Œç„¶åæ¥ä¸‹æ¥å°±æ˜¯æ¯”è¾ƒé‡è¦çš„é…ç½®ç¬¬ä¸‰æ–¹åº“ï¼š åŒ…å«ç›®å½•ï¼ˆå±æ€§ -&gt; VC++ ç›®å½• -&gt; åŒ…å«ç›®å½•ï¼‰è¾“å…¥ç¬¬ä¸‰æ–¹åº“ include æ–‡ä»¶å¤¹çš„è·¯å¾„ åº“ç›®å½•ï¼ˆå±æ€§-&gt;VC++ç›®å½•-&gt;åº“ç›®å½•ï¼‰è¾“å…¥ç¬¬ä¸‰æ–¹åº“ lib æ–‡ä»¶å¤¹çš„è·¯å¾„ è¿è¡Œæ—¶åº“ï¼ˆå±æ€§-&gt;é“¾æ¥å™¨-&gt;è¾“å…¥-&gt;é™„åŠ ä¾èµ–é¡¹ï¼‰è¾“å…¥ lib æ–‡ä»¶å¤¹ä¸‹å…·ä½“ lib&#x2F;dll æ–‡ä»¶çš„å…¨ç§°ï¼ˆæœ‰äº›åº“æ¯”å¦‚booståº“ä¸éœ€è¦ï¼‰ Linux ç¯å¢ƒ1. vscode + clangd + conané…ç½®å¼€æºé¡¹ç›® é…ç½®å¼€æºé¡¹ç›® a. é¡¹ç›®ä¸­ä¸€èˆ¬æœ‰ conanfile.txtï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥å°±ç›´æ¥å®‰è£… 1conan install . --build=missing -s build_type=Release b. ä¸ºäº†è®© clangd æ­£å¸¸å·¥ä½œï¼Œè¿™é‡Œè¦é¦–å…ˆ CMake ç”Ÿæˆ compile_commands.jsonï¼ˆä½œè€…ä¸€èˆ¬å†™å¥½äº†ï¼Œç›´æ¥æ„å»ºå°±è¡Œï¼‰ 123456cmake \\ -DCMAKE_TOOLCHAIN_FILE=build/Release/generators/conan_toolchain.cmake \\ -DCMAKE_BUILD_TYPE=Release \\ -S . \\ -B build \\ -G Ninja c. åˆ›å»ºè½¯é“¾æ¥ï¼Œè®© clangdè‡ªåŠ¨å‘ç° 1ln -sf build/compile_commands.json ./ é‡æ–°é…ç½®é¡¹ç›®ç¯å¢ƒ a. å†™ conanfile.txtï¼Œå› ä¸ºè¿™é‡Œä¸€èˆ¬æ˜¯å¤ç°ï¼Œå¯ä»¥ç›´æ¥æŠŠä½œè€…çš„è¯¥æ–‡ä»¶æŠ„è¿‡æ¥ 12345678910111213[requires]fmt/11.1.3spdlog/1.15.1cpp-httplib/0.20.1nlohmann_json/3.12.0gflags/2.2.2[generators]CMakeDepsCMakeToolchain[layout]cmake_layout b. é‡æ–°æ£€æµ‹ç¼“å­˜ç¯å¢ƒï¼Œäºé¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆç¬¬ä¸‰æ–¹åº“çš„é…ç½®ç¯å¢ƒ 1conan install . --build=missing -s build_type=Release c.å†™ CMakeListsæ¥æ„å»º compile_commands.jsonæ–‡ä»¶ï¼Œæ³¨æ„ä¸€å®šè¦å¯¼å‡ºç¼–è¯‘æ•°æ®åº“ï¼ŒæŸ¥æ‰¾ä¾èµ–å’Œé“¾æ¥åº“ 1234567891011121314151617181920212223242526272829# CMakeLists.txt - æœ€å°å¯å·¥ä½œç‰ˆæœ¬cmake_minimum_required(VERSION 3.20)project(Demo LANGUAGES CXX)# âœ… å…³é”®ï¼šå¯¼å‡ºç¼–è¯‘æ•°æ®åº“ï¼ˆè®© clangd å¯ç”¨ï¼‰set(CMAKE_EXPORT_COMPILE_COMMANDS ON)# è®¾ç½® C++ æ ‡å‡†set(CMAKE_CXX_STANDARD 17)set(CMAKE_CXX_STANDARD_REQUIRED ON)# æŸ¥æ‰¾ Conan å®‰è£…çš„ä¾èµ–find_package(fmt CONFIG REQUIRED)find_package(spdlog CONFIG REQUIRED)find_package(httplib CONFIG REQUIRED)find_package(nlohmann_json CONFIG REQUIRED)find_package(gflags CONFIG REQUIRED)# æ·»åŠ ä¸€ä¸ªç©ºçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆåªæ˜¯ä¸ºäº†è§¦å‘ç¼–è¯‘å’Œç”Ÿæˆ compile_commands.jsonï¼‰add_executable(demo main.cpp)# é“¾æ¥ä½ å…³å¿ƒçš„åº“ï¼ˆå‘Šè¯‰ CMakeï¼šâ€œæˆ‘è¦ç”¨è¿™äº›å¤´æ–‡ä»¶å’Œåº“â€ï¼‰target_link_libraries(demo PRIVATE fmt::fmt spdlog::spdlog httplib::httplib nlohmann_json::nlohmann_json gflags::gflags) d. æ‰§è¡Œ CMake å¹¶å°†ç”Ÿæˆçš„ compile_commands.jsonè½¯é“¾æ¥åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼š 123456cmake \\ -DCMAKE_TOOLCHAIN_FILE=build/Release/generators/conan_toolchain.cmake \\ -DCMAKE_BUILD_TYPE=Release \\ -S . \\ -B build \\ -G Ninja 1ln -sf build/compile_commands.json ./ 2. vs2022 + ssh é…ç½®å¼€æºé¡¹ç›®ï¼ˆå‰ææ˜¯é¡¹ç›®æ˜¯å­˜åœ¨æœ¬åœ°çš„ï¼‰a. é€šè¿‡ ssh è¿æ¥åˆ°è¿œç¨‹ç³»ç»Ÿ 12341. ä¸»æœºåä¸€èˆ¬å¡« 127.0.0.1 (wsl)ï¼Œå…¶å®ƒçœ‹æƒ…å†µ2. ç«¯å£åä¸€èˆ¬å°±æ˜¯ 223. ç”¨æˆ·åæœ€å¥½å¡« rootï¼Œå…å¾—å‡ºç°æƒé™é—®é¢˜4. å¯†ç å°±æ˜¯ sudo passwd root çš„å¯†ç  b. æŒ‡å®šè¿è¡Œçš„è®¡ç®—æœº 121. é¡¹ç›®å±æ€§ -&gt; å¸¸è§„ -&gt; è¿œç¨‹ç”Ÿæˆè®¡ç®—æœº2. åŒæ—¶ä¸‹é¢å¯ä»¥æŒ‡å®šè¿œç¨‹ç”Ÿæˆä»£ç çš„æ ¹ç›®å½• c. æŒ‡å®šè°ƒè¯•çš„ç»å¯¹è·¯å¾„ 1231. é¡¹ç›®å±æ€§ -&gt; è°ƒè¯• -&gt; ç¨‹åºï¼ˆå†™å…¥ç»å¯¹è·¯å¾„ï¼‰ps. è¿™é‡Œçš„ç»å¯¹è·¯å¾„æ˜¯æŒ‡çš„è¿œç«¯ç¨‹åºçš„ç»å¯¹è·¯å¾„ï¼Œå°±æ˜¯åˆšåˆšæŒ‡å®šç”Ÿæˆè¿œç¨‹ä»£ç æ ¹ç›®å½•ä¸‹é¢ï¼Œæ¯”å¦‚ï¼š/root/projects/LinuxConsole/bin/x64/Debug/LinuxConsole.out","categories":[{"name":"é¡¹ç›®ç»éªŒ","slug":"é¡¹ç›®ç»éªŒ","permalink":"https://dxblacksmith.github.io/categories/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"}],"tags":[]},{"title":"Hot 100 åˆ·é¢˜è®°å½•","slug":"Hot100 è®°å½•","date":"2025-01-13T10:05:08.000Z","updated":"2026-01-15T16:09:31.143Z","comments":true,"path":"2025/01/13/Hot100 è®°å½•/","permalink":"https://dxblacksmith.github.io/2025/01/13/Hot100%20%E8%AE%B0%E5%BD%95/","excerpt":"","text":"Hot 100 åˆ·é¢˜è®°å½•ï¼ˆ1ï¼‰æ»‘åŠ¨çª—å£å¥—è·¯ å®šé•¿æ»‘åŠ¨çª—å£ æ€»ç»“æˆä¸‰æ­¥ï¼šå…¥-æ›´æ–°-å‡ºã€‚ å…¥ï¼šä¸‹æ ‡ä¸º i çš„å…ƒç´ è¿›å…¥çª—å£ï¼Œæ›´æ–°ç›¸å…³ç»Ÿè®¡é‡ã€‚å¦‚æœçª—å£å·¦ç«¯ç‚¹ iâˆ’k+1&lt;0ï¼Œå³ i&lt;kâˆ’1ï¼Œåˆ™å°šæœªå½¢æˆç¬¬ä¸€ä¸ªçª—å£ï¼Œé‡å¤ç¬¬ä¸€æ­¥ã€‚ æ›´æ–°ï¼šæ›´æ–°ç­”æ¡ˆã€‚ä¸€èˆ¬æ˜¯æ›´æ–°æœ€å¤§å€¼&#x2F;æœ€å°å€¼ã€‚ å‡ºï¼šä¸‹æ ‡ä¸º iâˆ’k+1 çš„å…ƒç´ ç¦»å¼€çª—å£ï¼Œæ›´æ–°ç›¸å…³ç»Ÿè®¡é‡ï¼Œä¸ºä¸‹ä¸€ä¸ªå¾ªç¯åšå‡†å¤‡ã€‚ æ¯”å¦‚ 123456for(int i = 0; i &lt; s.size(); ++i) &#123; if(uset.count(s[i])) cnt ++; // å…¥ res = std::max(res, cnt); // æ›´æ–°ç­”æ¡ˆ if(i &lt; k - 1) continue; if(uset.count(s[i - k + 1])) cnt --; // å‡º&#125; ä¸å®šé•¿æ»‘åŠ¨çª—å£ è¶Šé•¿è¶Šåˆæ³•ï¼š é‡‡å–åœ¨ while å¾ªç¯å¤–æ›´æ–°ç­”æ¡ˆ 123456789for(...) &#123; umap[c] ++; // å…¥ while(umap[c] &gt; 1) &#123; // åˆæ³•æ€§åˆ¤æ–­ umap[s[left]] --; // å‡º left ++; &#125; // æ›´æ–° ans = std::max(ans, right - left + 1);&#125; è¶ŠçŸ­è¶Šåˆæ³•ï¼š é‡‡å–åœ¨ while å¾ªç¯å†…æ›´æ–°ç­”æ¡ˆ 12345678for(...) &#123; sum += nums[right]; // å…¥ while(sum &gt;= target) &#123; // åˆæ³•æ€§åˆ¤æ–­ res = min(res, right - left + 1); // æ›´æ–° sum -= nums[left]; // å‡º left ++; &#125;&#125; æ±‚å­æ•°ç»„ä¸ªæ•°ï¼š 1æš‚æ—¶è¿˜æ²¡åˆ·åˆ°","categories":[{"name":"ç®—æ³•é¢˜","slug":"ç®—æ³•é¢˜","permalink":"https://dxblacksmith.github.io/categories/%E7%AE%97%E6%B3%95%E9%A2%98/"}],"tags":[]}],"categories":[{"name":"Java","slug":"Java","permalink":"https://dxblacksmith.github.io/categories/Java/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://dxblacksmith.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://dxblacksmith.github.io/categories/JavaScript/"},{"name":"é¡¹ç›®ç»éªŒ","slug":"é¡¹ç›®ç»éªŒ","permalink":"https://dxblacksmith.github.io/categories/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"},{"name":"ç¬¬ä¸‰æ–¹åº“","slug":"ç¬¬ä¸‰æ–¹åº“","permalink":"https://dxblacksmith.github.io/categories/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/"},{"name":"C++ æ–°ç‰¹æ€§","slug":"C-æ–°ç‰¹æ€§","permalink":"https://dxblacksmith.github.io/categories/C-%E6%96%B0%E7%89%B9%E6%80%A7/"},{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://dxblacksmith.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"},{"name":"è®¡ç®—æœºæ±‚èŒ","slug":"è®¡ç®—æœºæ±‚èŒ","permalink":"https://dxblacksmith.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%B1%82%E8%81%8C/"},{"name":"C++ é¢ç»","slug":"C-é¢ç»","permalink":"https://dxblacksmith.github.io/categories/C-%E9%9D%A2%E7%BB%8F/"},{"name":"ç®—æ³•é¢˜","slug":"ç®—æ³•é¢˜","permalink":"https://dxblacksmith.github.io/categories/%E7%AE%97%E6%B3%95%E9%A2%98/"}],"tags":[]}